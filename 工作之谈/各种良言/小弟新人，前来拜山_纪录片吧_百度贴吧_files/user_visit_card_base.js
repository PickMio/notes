_.Module.define({path:"ihome/component/UserVisitCard/UserVisitCardBase",requires:["common/component/Icons"],sub:{countLen:0,initial:function(){},getVisitCardTpl:function(c,g,f){var a=PageData.product||"";var d=this.use("common/component/Icons");var h={head_img:"/tb/static-ihome/img/panel_"+g.bg_id+".jpg",concernClass:g.can_followed=="0"?"btn_concern_done":"btn_concern",un:encodeURIComponent(g.name),btn_group:f?this.getBtnGroup(g):"",portrait:g.portrait,fr:a,name:g.name_show,icon:d.getIconsHtml(g),sex:g.sex,tb_age:g.tb_age=="-"?g.tb_age:g.tb_age+"\u5e74",post_num:g.post_num,good_num:g.good_num,honor:this.getHonor(g.honor),honor_margin:this.getHonorMargin()};var e="";if(!c){e='<div class="interaction_wrap interaction_wrap_theme2"><a class="#{concernClass}" target="_blank" href="#" onclick="return false"></a><a class="btn_sendmsg" target="_blank" href="http://msg.baidu.com/ms?ct=21&cm=1&tn=bmSendMessage&un=#{un}"></a></div>'}var b=['<div class="card_headinfo_wrap" id="card_headinfo_wrap">','<img src="#{head_img}"/>','<a class="card_userinfo_close" href="#"></a>',e,"</div>",'<div class="card_userinfo_wrap">','<div class="card_userinfo_left">','<div class="userinfo_head"></div>','<a href="/home/main?un=#{un}&fr=#{fr}" class="j_avatar" target="_blank"><img src="http://tb.himg.baidu.com/sys/portrait/item/#{portrait}"/></a>',"</div>",'<div class="card_userinfo_middle">','<div class="card_userinfo_title clearfix">','<a href="/home/main?un=#{un}&fr=#{fr}" target="_blank" class="userinfo_username">#{name}</a>#{icon}',"</div>",'<div class="card_userinfo_num clearfix">','<span class="userinfo_sex userinfo_sex_#{sex}"></span>',"<span>\u5427\u9f84:#{tb_age}</span>",'<span class="userinfo_split"></span>',"<span>\u53d1\u8d34:#{post_num}</span>","</div>",'<div class="card_userinfo_honor honor_margin_#{honor_margin} clearfix">',"#{honor}","</div>","</div>","</div>"].join("");return $.tb.format(b,h)},getBtnGroup:function(d){var b="";if(d.id!==PageData.user.id){var c=d.can_begcard;var a="";if(c==0){a='<a class="btn_begcard j_begcard" href="#"></a>'}else{if(c==1){a='<a class="btn_begcard btn_forbidden">\u5df2\u7533\u8bf7</a>'}else{if(c==2){a='<a class="btn_begcard btn_forbidden">\u5df2\u4ea4\u6362</a>'}}}var e={private_msg:"http://msg.baidu.com/ms?ct=21&cm=1&tn=bmSendMessage&un="+encodeURIComponent(d.name),btn_begcard:a};b=['<div class="card_btn_grounps">','<a class="btn_privatemsg" target="_blank" href="#{private_msg}"></a>',"#{btn_begcard}","</div>"].join("");b=$.tb.format(b,e)}return b},getIcon:function(b){var a="";if(b.identity){a+='<span title="\u8d34\u5427\u5b9e\u540d\u8ba4\u8bc1" class="card_userinfo_icon card_icon_verify"></span>'}if(b.meizhi_level>0){a+='<a href="/p/'+b.meizhi_thread_id+'" target="_blank" title="\u8d34\u5427\u59b9\u7eb8\u8ba4\u8bc1" class="card_userinfo_icon meizhi_vip card_icon_meizhi_vip'+b.meizhi_level+'"></a>'}return a},getHonor:function(g){if(g.novice){return'<div class="grade_level grade_level_novice" title="\u8d34\u5427\u83dc\u9e1f">\u8d34\u5427\u83dc\u9e1f</div>'}var b={manager:{title:"\u5427\u4e3b",level:19},assist:{title:"\u5c0f\u5427\u4e3b",level:20},picadmin:{title:"\u56fe\u7247\u5c0f\u7f16",level:21},videoadmin:{title:"\u89c6\u9891\u5c0f\u7f16",level:22},novice:{title:"\u83dc\u9e1f",level:23}};var f=g.manager;var e=null,h="",k="";for(var m in f){e=f[m];var n=e.forum_list.join("\u3001");var o=b[m];if(e.count>2){n=n+"\u7b49\u5427"+o.title}else{n=n+"\u5427"+o.title}h+=this.getHonorItem(o.level,e.count,n);this.countLen+=String(e.count).length}var d=g.grade;var c=[];for(var a in d){c.push(a)}c.sort(function(p,i){return i-p});for(var j=0,l=c.length;j<l;j++){e=d[c[j]];var n=e.forum_list.join("\u3001");if(e.count>2){n=n+"\u5427\u7b49"}k+=this.getHonorItem(c[j],e.count,n);this.countLen+=String(e.count).length}return h+k},getHonorMargin:function(){var b={"2":"8px","3":"6px","4":"4px"};var a=this.countLen-4;return b[a]||""},getHonorItem:function(e,b,c){var d={level:e,title:c,count:b};var a=['<div class="grade_level grade_level_#{level}" title="#{title}">',"<span>#{count}</span>","</div>"].join("");return $.tb.format(a,d)}}});