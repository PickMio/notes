_.Module.define({path:"common/component/search_dialog",requires:["common/component/search_handler"],sub:{_DLG_ID:"tb_header_search_dlg",_options:{defaultType:"post",style:null,forumName:null,page:null},_searchHandler:null,_jq_wrap:null,_jq_input:null,_jq_form:null,initial:function(a){$.extend(this._options,a);this._initOptPage();this._searchHandler=this.use("common/component/search_handler");this._initDlg()},_initOptPage:function(){if(this._options.page==null){if(/^\w+:\/\/[^\/]+\/(index\.html?)|(i\/\d+)/.test(window.location.href)){this._options.page="index"}else{if(/^\w+:\/\/[^\/]+\/tb\/picture\/(index\.html?)/.test(window.location.href)){this._options.page="picture_index"}else{if(PageData.product=="itieba3"){this._options.page="itieba"}}}}},_initDlg:function(){var a=this._createDlgHtml();new $.dialog({html:a,title:"\u8bf7\u8f93\u5165\u60a8\u8981\u627e\u7684\u5185\u5bb9",width:482});this._jq_wrap=$("#"+this._DLG_ID);this._jq_input=this._jq_wrap.find(".j_kw");this._jq_form=this._jq_wrap.find(".j_form");this._bindEvents()},_bindEvents:function(){var a=this;a._jq_form.bind("submit",function(){a.submit();return false});a._jq_input.focus()},_formSubmitHandler:function(){var a=this._getSearchType(),b=this._jq_input.val();return this.handleSubmit(a,b)},submit:function(){var a=this.getSearchWord();switch(this._options.defaultType){case"post":this._searchHandler.searchPost(a);break;case"benba":this._searchHandler.searchPostInBa(a,this._options.forumName);break}return false},getSearchWord:function(){var a=this._jq_input.val();a=a.replace(/(^[\s\t\xa0\u3000]+)|([\u3000\xa0\s\t]+$)/g,"");return a},_getSearchType:function(){var b=CommonSearch.SearchConfig.searchTypes.tieba;var a=this._jq_wrap.find("input:checked").attr("class");var d=CommonSearch.SearchConfig.radioClasses;for(var c in d){if(d[c]==a){b=CommonSearch.SearchConfig.searchTypes[c];break}}return b},_createDlgHtml:function(){var a='<div id="'+this._DLG_ID+'" class="search_dialog_bright"><form name="f1" class="j_form"  action="/f"><input autocomplete="off" size="42" tabindex="1" name="kw" class="j_kw s_ipt tb_header_search_input" maxlength="100" /><span class="s_btn_wr">';if(this._options.defaultType==="post"){a+='<input type="submit" value="\u8d34\u5427\u641c\u7d22" class="j_submit s_btn" onmousedown="this.className=\'s_btn s_btn_h\'" onmouseout="this.className=\'s_btn\'" /></span></form>'}else{a+='<input type="submit" value="\u5427\u5185\u641c\u7d22" class="j_submit s_btn" onmousedown="this.className=\'s_btn s_btn_h\'" onmouseout="this.className=\'s_btn\'" /></span></form>'}a+="</div>";return a}}});