(function(a){with(a){
a.Vr=function(b,c){this.ga=b;this.offset=c},a.Wr=function(b){return b.length||b.childNodes.length},a.Xr=function(b,c,d){for(;1==b.nodeType;){var e=b.childNodes[c];if(!e&&!b.lastChild)break;e?(b=e.previousSibling,d&&b?c=Wr(b):(b=e,c=0)):(b=b.lastChild,c=Wr(b))}return new Vr(b,c)},a.Yr=function(b,c){b!=k&&this.append.apply(this,arguments)};t=Yr.prototype;t.Oh="";t.set=function(b){this.Oh=""+b};t.append=function(b,c,d){this.Oh+=b;if(c!=k)for(var e=1;e<arguments.length;e++)this.Oh+=arguments[e];return this};
t.clear=function(){this.Oh=""};t.Sr=u(48);t.toString=q("Oh");a.Zr=function(b){this.type="anon_change";this.mb=b};y(Zr,id);a.Z=function(b,c){return da[b]=c};Of.prototype.expand=Z(64,function(b,c,d,e){ra(b)?(this.top-=b.top,this.right+=b.right,this.bottom+=b.bottom,this.left-=b.left):(this.top-=b,this.right+=c,this.bottom+=d,this.left-=e);return this});Ko.prototype.expand=Z(63,function(){this.La(j)});rh.prototype.Cp=Z(62,function(b){sh(this);this.gl=b});
yi.prototype.Cp=Z(61,function(b){this.gl=b;this.Ba&&zi(this)});ro.prototype.Nm=Z(57,function(b){this.Oa(b)});Yd.prototype.Ci=Z(56,ca("GG"));rh.prototype.qy=Z(55,function(){return this.Sj||150>za()-this.yy});up.prototype.Eb=Z(54,function(){var b=this.xc();return 1==b.nodeType?b:b.parentNode});Yg.prototype.cg=Z(52,ca("Oi"));Dj.prototype.cg=Z(51,ca("Oi"));ar.prototype.Xe=Z(50,function(b){this.ca.Rt(b)});uj.prototype.getDay=Z(49,function(){return this.aa.getDay()});Yr.prototype.Sr=Z(48,function(){return this.Oh.length});
fl.prototype.fireEvent=Z(37,function(b){this.dispatchEvent(b)});uj.prototype.setTime=Z(36,function(b){this.aa.setTime(b)});ln.prototype.Mc=Z(31,function(){return Hc(this.h())});Gp.prototype.Mc=Z(30,function(){return this.P.toString()});Lp.prototype.Mc=Z(29,function(){return this.P.text});Vp.prototype.Mc=Z(28,function(){return Zp(this).Mc()});aq.prototype.Mc=Z(27,s(""));gq.prototype.Mc=Z(26,function(){return z.map(wp(this),function(b){return b.Mc()}).join("")});
Sb.prototype.Rv=Z(21,function(b,c,d){for(var e=this.Ga,g=!!d,d=["<tr>"],h=0;h<c;h++)d.push(g?"<td>&nbsp;</td>":"<td></td>");d.push("</tr>");d=d.join("");c=["<table>"];for(h=0;h<b;h++)c.push(d);c.push("</table>");b=e.createElement("DIV");b.innerHTML=c.join("");return b.removeChild(b.firstChild)});no.prototype.Hf=Z(20,function(b,c){var d=b.Id(),e=this.O()+"-collapse-left",g=this.O()+"-collapse-right";b.qj(d?g:e,!!(c&1));b.qj(d?e:g,!!(c&2))});yo.prototype.Hf=Z(19,function(b){this.N.Hf(this,b)});
wh.prototype.Ip=Z(18,ca("hk"));ro.prototype.Ip=Z(17,ca("hk"));
gf.prototype.Dq=Z(14,function(b,c,d){var e=za(),g=d?d:e,h=this.El.Xg.length?this.El.Xg.pop():this.El.ol();h.Hr=2;h.Gr=g;h.type=c;h.cD=b;b=(b=this.TZ)&&b.isTracing()?b.totalVarAlloc:-1;h.aJ=b;this.Lv++;if(d){d=this.fg.length;for(b=0;b<d;b++)if(this.fg[b].Gr>g){z.Co(this.fg,h,b);break}b==d&&this.fg.push(h)}else this.fg.push(h);if(g=h.type)h=this.Bk.get(g),h||(h=this.Tp.Xg.length?this.Tp.Xg.pop():this.Tp.ol(),h.type=g,this.Bk.set(g,h)),h.count++;this.nu+=za()-e});So.prototype.Yw=Z(12,function(){return Vo});
kr.prototype.Qr=Z(0,q("Na"));
a.$r=function(b){b.oy=j;b.sD=ug(b.h()).height;Qq+=b.sD;z.forEach(Oq,function(b){b&&(!b.oy&&b.Jl)&&b.up()})},a.as=function(b,c){var d=b.parentNode,e=z.indexOf(d.childNodes,b)+(c?0:1),d=Xr(d,e,c);A&&(Gb("9")&&1==d.ga.nodeType&&"HR"==d.ga.tagName)&&(e=d.ga,d.ga=e.parentNode,d.offset=z.indexOf(d.ga.childNodes,e)+(c?0:1));nq(d.ga,d.offset).select()},a.bs=function(b,c){b.Oy=c==k||c instanceof Of?c:new Of(c,i,i,i);b.S()&&b.oa()},a.cs=function(b,c){if(em(b))b.selectionStart=c,b.selectionEnd=c;else if(A){var c=
hm(b,c),d=b.createTextRange();d.collapse(j);d.move("character",c);d.select()}},a.ds=function(b){var c={};z.forEach(b.data.Gb(),function(b){c[b]=this.data.get(b)},b);return c},a.es=function(b){b.Hb()&&b.fire()},a.fs=function(b,c){return b.Ld.get(c)},a.gs=function(b,c,d){var e=Ki,g={title:"确认使用匿名身份？",content:'<p>使用匿名身份后，你将</p><ul style="margin: 5px 0 0 5px;list-style-position: inside;"><li>不能在该问题下评论（你之前的评论将被隐藏）</li><li>不能邀请别人回答该问题</li></ul>'},h={title:"确认放弃匿名身份？",content:"你对该问题的回答、赞同和关注行为将以实名显示。"};
Ci(b?g:h,function(g){if(g){var h=new V(j),p="/question/"+(b?"set_anonymous":"set_public"),r="qid="+(d||Eg.Y);h.on("success",function(){var c=Ie(h);c&&!c.r&&e.dispatchEvent(new Zr(b))});h.ajax(p,r)}c&&c(g)})},a.hs=function(b,c){return b.Yb&&c?z.indexOf(b.Yb,c):-1},a.is=function(b){return b!=k},a.js=function(b){return!/[^\t\n\r ]/.test(b)},a.ks=function(b,c,d){this.OG=b;this.nU=!!d;b&&!c&&this.next()};y(ks,Nd);
ks.prototype.next=function(){var b=this.OG;b||f(O.gb);this.OG=this.nU?b.previousSibling:b.nextSibling;return b};a.ls=function(b){return 1==b.nodeType||3==b.nodeType&&!js(b.nodeValue)},a.ms=function(b){try{return b.next()}catch(c){return k}},a.ns=function(b,c,d){la(d)||(d=c&&b.childNodes.length?b.childNodes.length-1:0);ks.call(this,b.childNodes[d],j,c)};y(ns,ks);
a.os=function(b,c,d,e,g,h){oa(b)?(this.se="y"==b?c:0,this.ke="m"==b?c:0,this.Rd="d"==b?c:0,this.Fd="h"==b?c:0,this.Kd="n"==b?c:0,this.Md="s"==b?c:0):(this.se=b||0,this.ke=c||0,this.Rd=d||0,this.Fd=e||0,this.Kd=g||0,this.Md=h||0)};
os.prototype.Ik=function(b){var c=Math.min(this.se,this.ke,this.Rd,this.Fd,this.Kd,this.Md),d=Math.max(this.se,this.ke,this.Rd,this.Fd,this.Kd,this.Md);if(0>c&&0<d)return k;if(!b&&0==c&&0==d)return"PT0S";d=[];0>c&&d.push("-");d.push("P");(this.se||b)&&d.push(Math.abs(this.se)+"Y");(this.ke||b)&&d.push(Math.abs(this.ke)+"M");(this.Rd||b)&&d.push(Math.abs(this.Rd)+"D");if(this.Fd||this.Kd||this.Md||b)d.push("T"),(this.Fd||b)&&d.push(Math.abs(this.Fd)+"H"),(this.Kd||b)&&d.push(Math.abs(this.Kd)+"M"),
(this.Md||b)&&d.push(Math.abs(this.Md)+"S");return d.join("")};os.prototype.eg=function(b){return b.se==this.se&&b.ke==this.ke&&b.Rd==this.Rd&&b.Fd==this.Fd&&b.Kd==this.Kd&&b.Md==this.Md};os.prototype.clone=function(){return new os(this.se,this.ke,this.Rd,this.Fd,this.Kd,this.Md)};os.prototype.add=function(b){this.se+=b.se;this.ke+=b.ke;this.Rd+=b.Rd;this.Fd+=b.Fd;this.Kd+=b.Kd;this.Md+=b.Md};
a.ps=function(b){return 1==b.length?"0"+b:b},a.qs=/^#(?:[0-9a-f]{3}){1,2}$/i,a.rs=/Z|(?:([-+])(\d{2})(?::?(\d{2}))?)$/,a.ss=/^(\d{2})(?::?(\d{2})(?::?(\d{2})(\.\d+)?)?)?$/,a.ts=/^(\d{4})(?:(?:-?(\d{2})(?:-?(\d{2}))?)|(?:-?(\d{3}))|(?:-?W(\d{2})(?:-?([1-7]))?))?$/,a.us=function(b,c){var d=$.extend({all:n},us.R,c||{}),e=$(b).get(0).getBoundingClientRect();return!d.all&&(e.bottom<d.paddingTop||e.bottom>$(window).height())||d.all&&(e.top<d.paddingTop||e.bottom>$(window).height())?n:j};us.R={paddingTop:0};
a.vs=/^(?:rgb)?\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2})\)$/i,a.ws=/#(.)(.)(.)/,a.xs=function(b){var c=b.body,b=b.documentElement;return new Ob(c.scrollLeft||b.scrollLeft,c.scrollTop||b.scrollTop)},a.ys=function(b){for(var c;c=!b||1!=b.nodeType?k:ms(O.filter(new ns(b,n),ls));)b=c;return b},a.zs=function(b,c,d){lp.call(this,b,0,d?"添加父话题":"添加子话题");this.ry=d;this.Of=c;this.ts="";this.WH="/topic/parent/remove";this.qC=j};y(zs,lp);t=zs.prototype;
t.n=function(b){if(this.isEnabled=!b.getAttribute("data-disabled"))zs.m.n.call(this,b),this.ie(j),R(this.lE,n)};t.vf=function(b){var c;this.ry&&(c="/topic/autocomplete?no_create=true");zs.m.vf.call(this,b,c);this.M.zf.iE=n};t.uk=function(){return v(function(b){return z.filter(b,function(b){return z.every(this.data,function(d){return!this.qC&&3>=b.length?n:d[0]!==b[1]})},this)},this)};
t.cf=function(b,c){this.kh||(this.kh=j,this.xhr=new V(j),P(this.g(),this.xhr,"complete",this.bv),b||(b=-1),this.ry?this.xhr.ajax("/topic/add","tid="+this.Of+"&pid="+b+"&topic_text="+encodeURIComponent(c)):this.xhr.ajax("/topic/add","tid="+this.Of+"&cid="+b+"&topic_text="+encodeURIComponent(c)))};t.sE=function(b){return'<a class="nor" href="/topic/'+b[1]+'/organize">'+b[0]+"</a>"};
t.kp=function(b){if(!this.ea||!this.ea.Hb()){var c=new V(j);this.g().c(c,"success",function(){var d=Ie(c);d.r?U(d.msg):(np(this),this.Ye(),this.dispatchEvent({type:"remove_tag",data:{id:b}}))});this.ry?c.ajax(this.WH,"cid="+this.Of+"&pid="+b):c.ajax(this.WH,"pid="+this.Of+"&cid="+b);this.ea=c}};a.As=function(b,c){this.Vh=b instanceof Ob?b:new Ob(b,c)};y(As,gn);As.prototype.oa=function(b,c,d,e){var g=xs(Tb(b)),h=this.Vh.x+g.x,g=this.Vh.y+g.y,l=ym(b),h=h-l.x,g=g-l.y;zm(new Ob(h,g),b,c,d,k,k,e)};
a.Bs=function(b,c){"number"===$.type(c)&&(c={offsetTop:c});var d=$.extend({yJ:us},Tk,c||{});if(!d.yJ(b,d)){var e=$(b).offset().top-d.paddingTop-d.offsetTop||0;d.vC?$(document.documentElement).add(document.body).animate({scrollTop:e}):$(window).scrollTop(e)}},a.Cs=function(b,c){c.all=j;return us(b,c)},a.Ds=function(b){var c=b.match(vs);if(c){var b=Number(c[1]),d=Number(c[2]),c=Number(c[3]);if(0<=b&&255>=b&&0<=d&&255>=d&&0<=c&&255>=c)return[b,d,c]}return[]},a.Es=function(b){qs.test(b)||f(Error("'"+
b+"' is not a valid hex color"));4==b.length&&(b=b.replace(ws,"#$1$1$2$2$3$3"));return b.toLowerCase()},a.Fs={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",
darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",
firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",
lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",
mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",
rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},
a.Gs=function(b,c,d,e,g,h,l){this.aa=pa(b)?new Date(b,c||0,d||1,e||0,g||0,h||0,l||0):new Date(b?b.getTime():za())};y(Gs,uj);t=Gs.prototype;t.getHours=function(){return this.aa.getHours()};t.getMinutes=function(){return this.aa.getMinutes()};t.getSeconds=function(){return this.aa.getSeconds()};t.getUTCHours=function(){return this.aa.getUTCHours()};t.setHours=function(b){this.aa.setHours(b)};t.setMinutes=function(b){this.aa.setMinutes(b)};t.setSeconds=function(b){this.aa.setSeconds(b)};
t.setMilliseconds=function(b){this.aa.setMilliseconds(b)};t.setUTCHours=function(b){this.aa.setUTCHours(b)};t.add=function(b){uj.prototype.add.call(this,b);b.Fd&&this.setHours(this.aa.getHours()+b.Fd);b.Kd&&this.setMinutes(this.aa.getMinutes()+b.Kd);b.Md&&this.setSeconds(this.aa.getSeconds()+b.Md)};
t.Ik=function(b,c){var d=uj.prototype.Ik.call(this,b);return b?d+" "+bb(this.getHours())+":"+bb(this.getMinutes())+":"+bb(this.getSeconds())+(c?vj(this):""):d+"T"+bb(this.getHours())+bb(this.getMinutes())+bb(this.getSeconds())+(c?vj(this):"")};a.Hs=function(b){return uj.prototype.Ik.call(b,j)+"T"+bb(b.getHours())+":"+bb(b.getMinutes())+":"+bb(b.getSeconds())+vj(b)};t.eg=function(b){return this.getTime()==b.getTime()};t.toString=function(){return this.Ik()};
t.clone=function(){var b=new Gs(this.aa);b.Wg=this.Wg;b.Hl=this.Hl;return b};
a.Is=/[^\d]+$/,a.Js=function(b,c){var d=b.length-c.length;return 0<=d&&b.indexOf(c,d)==d},a.Ks=function(b){nq(ys(b),0).select()},a.Ls=function(b,c){var d=Ic(b);if(b.getElementsByTagName)for(var e in Mq)if(b.tagName==e||0<b.getElementsByTagName(e).length)return n;return!c&&" "==d||js(d)},a.Ms=j,a.Ns=function(b){if(b=vp(b||window))if(b.empty)try{b.empty()}catch(c){}else try{b.removeAllRanges()}catch(d){}},a.Os=function(b){lp.call(this);this.tD=k;this.ad="例如：互联网、医学、法律、数学...";this.data=b||[]};y(Os,lp);
t=Os.prototype;
t.n=function(b){this.e=b;this.af=J("zm-tag-editor-labels",this.e);this.ie(j);this.De();this.Ea();this.gg=H("zh-expert-topics");this.nn=H("zh-active-topics");if(this.gg)$(this.gg).on("click",".del",$.proxy(function(b){var d=$(b.target).parents(".item");d.data("active")?(nc(this.nn,d[0],0),Ck(d[0])):L(d[0]);z.forEach(this.data,function(b,c){b+""===d.data("url-token")+""&&this.data.splice(c,1)},this);Ps(this);this.dispatchEvent("remove")},this));if(this.nn)$(this.nn).on("click",".add",$.proxy(function(b){b=
$(b.target).parents(".item");nc(this.gg,b[0],0);Ck(b[0]);Ps(this);this.dispatchEvent("add")},this));this.data=$("#zh-expert-topics .item").map(function(){return $(this).data("url-token")}).get();this.Hm()};t.Zn=function(){this.hc||(this.hc=K("div","zm-tag-editor-editor",[this.lf=K("div","zg-section zm-tag-editor-command-buttons-wrap",[this.Ra=H("profile-expert-edit-input")])]),this.ad&&(this.wy=new gp(this.ad),this.wy.n(this.Ra),this.Ra.title=this.ad),mc(this.hc,this.af),this.vf(this.lf))};
t.vf=function(b){this.M=new go("/topic/autocomplete",this.Ra,k,k,b,j);this.M.Kf(j);this.M.pi=this.je;this.M.Jp(this.uk());this.M.Ew=[this.ad];this.g().c(this.M,"select",this.ap);this.g().c(this.M,Zl.Ih.Si,this.av);this.g().c(this.M,Zl.Ih.Si,this.Yu);this.g().c(this.M,Zl.Ih.XJ,function(){$(this.M.N.e).hide()})};t.Yu=function(){if(0===this.M.cb.length){var b=K("div",{className:"zu-autocomplete-empty"},"没有名字为 "+$(this.Ra).val()+" 的话题");$(this.M.N.e).html(b).show()}};
t.ap=function(){var b=z.slice(this.M.lg(),1);b&&3<b.length&&(this.xD=b,this.cf(b))};t.cf=function(b){this.data.push(b[1]);var c=$(this.gg).find("[data-url-token='"+b[1]+"']")[0];c?Ck(c):(Vj("TopicMediumV2",{member_url_token:S[1],topic_url_token:b[1]},this.lr,this),$(this.nn).find("[data-url-token='"+b[1]+"']").remove(),this.dispatchEvent("add"))};t.lr=function(b){b=$(b)[0];nc(this.gg,b,0);Ck(b);Ps(this)};t.Ye=ba();
t.Hm=function(){if(!Dg.Oc){var b=this;this.bg&&this.bg.G();var c=new Jl;c.Br="expert-item-moving";Kl(c,this.gg,4);c.w();this.bg=c;this.g().c(this.bg,"dragend",function(){this.dispatchEvent("sort")});$("a, input, .del, .add",this.gg).each(function(){b.g().c(this,"mousedown",function(b){b.stopPropagation()})});this.g().c(this.bg,"beforedragstart",function(){return J("editing",this.gg)?n:j})}};
a.Ps=function(b){var c=$(b.gg).children().length;6<c&&L($(b.gg).children()[6]);R(H("zh-profile-expert-empty"),0>=c);0<c&&R(H("zh-profile-expert-warning"),n);R(H("active-topics-wrap"),$(b.nn).children().length);b.Hm()};t.uk=function(){return v(function(b){return z.filter(b,function(b){return z.every(this.data,function(d){return d+""!==b[2]+""&&3<b.length})},this)},this)};a.Qs=function(b){lp.call(this,b,0);this.ts="";this.NC="/topic/ignore"};y(Qs,zs);
Qs.prototype.cf=function(b){this.kh||(this.kh=j,this.xhr=new V(j),P(this.g(),this.xhr,"complete",this.bv),this.xhr.ajax(this.NC,"tid="+b+"&method=add"))};Qs.prototype.kp=function(b){this.kh||(this.kh=j,this.xhr=new V(j),this.g().c(this.xhr,"complete",function(){np(this);this.Ye();this.kh=n}),this.xhr.ajax(this.NC,"tid="+b+"&method=del"))};a.Rs=function(){lp.call(this,k,k,"搜索话题");this.tD=k;this.ad="";this.data=[Gg[0]]};y(Rs,lp);t=Rs.prototype;
t.n=function(b){this.e=b;this.af=J("zm-tag-editor-labels",this.e);this.ie(j);this.De();this.Ea()};t.Zn=function(){this.hc||(this.hc=K("div","zm-tag-editor-editor",[this.Vn=K("div","zg-section zg-clear"),this.lf=K("div","zg-section zm-tag-editor-command-buttons-wrap",[this.Ra=H("zh-topic-merge-input"),K("a",{"class":"zg-mr15 zg-btn-blue",href:"#",name:"add",style:"display:none;"},"添加"),this.lE=H("zh-topic-merge-btn")])]),mc(this.hc,this.af),this.vf(this.lf))};
t.vf=function(b){this.M=new go("/topic/autocomplete",this.Ra,k,k,b,j);this.M.Kf(j);this.M.pi=this.je;this.M.Jp(this.uk());this.M.Ew=[this.ad];this.g().c(this.M,"select",this.ap);this.g().c(this.M,Zl.Ih.Si,this.av)};t.uk=function(){return v(function(b){return z.filter(b,function(b){return z.every(this.data,function(d){return d[1]!==b[1]&&3<b.length})},this)},this)};t.ap=function(){var b=z.slice(this.M.lg(),1);b&&3<b.length&&(this.xD=b,this.cf(b[3],b[0]))};
t.cf=function(b,c){var d=this;setTimeout(function(){d.Ra.value=c});this.tD=b};t.Ye=ba();a.Ss=function(b){lp.call(this,[],0);this.rD=this.Hs=k;this.HC="/reviewq/question?queue_id="+b+"&task_id="};y(Ss,lp);Ss.prototype.QS=function(){this.locked=n;var b=Ie(this.oB);b&&b.r?U(b.msg):(this.data=b.msg,this.ie(j),np(this))};a.Ts=function(b,c,d){T.call(this,d);this.N=c||So.F();this.Ab=b||this.N.Yw()};y(Ts,T);t=Ts.prototype;t.uy=k;t.qb=k;t.N=k;t.Ab=k;t.ob=j;t.jc=j;t.Pw=j;t.tb=-1;t.nc=k;t.ug=n;t.oL=n;t.aT=j;
t.Mg=k;t.lc=function(){return this.uy||this.N.lc(this)};t.Rr=function(){return this.qb||(this.qb=new im(this.lc()))};t.o=function(){this.e=this.N.o(this)};t.ba=function(){return this.N.ba(this.h())};t.Wc=function(b){return this.N.Wc(b)};t.$=function(b){this.e=this.N.n(this,b);"none"==b.style.display&&(this.ob=n)};
t.B=function(){Ts.m.B.call(this);oh(this,function(b){b.Ba&&Us(this,b)},this);var b=this.h();this.N.Qe(this);this.z(this.ob,j);this.g().c(this,"enter",this.xx).c(this,"highlight",this.Cx).c(this,"unhighlight",this.Lx).c(this,"open",this.aP).c(this,"close",this.kO).c(b,"mousedown",this.Ne).c(Tb(b),"mouseup",this.qO).c(b,["mousedown","mouseup","mouseover","mouseout","contextmenu"],this.jO);this.mi()&&Vs(this,j)};
a.Vs=function(b,c){var d=b.g(),e=b.lc();c?d.c(e,"focus",b.Me).c(e,"blur",b.$c).c(b.Rr(),"key",b.$b):d.wa(e,"focus",b.Me).wa(e,"blur",b.$c).wa(b.Rr(),"key",b.$b)};t.$a=function(){this.Tb(-1);this.nc&&this.nc.wb(n);this.ug=n;Ts.m.$a.call(this)};t.p=function(){Ts.m.p.call(this);this.qb&&(this.qb.G(),this.qb=k);this.N=this.nc=this.Mg=this.uy=k};t.xx=s(j);
t.Cx=function(b){var c=hs(this,b.target);if(-1<c&&c!=this.tb){var d=Ws(this);d&&d.ud(n);this.tb=c;d=Ws(this);this.ug&&d.setActive(j);this.aT&&(this.nc&&d!=this.nc)&&(d.Ub&64?d.wb(j):this.nc.wb(n))}Pc(this.h(),Wc.hn,b.target.h().id)};t.Lx=function(b){b.target==Ws(this)&&(this.tb=-1);Pc(this.h(),Wc.hn,"")};t.aP=function(b){if((b=b.target)&&b!=this.nc&&b.getParent()==this)this.nc&&this.nc.wb(n),this.nc=b};t.kO=function(b){b.target==this.nc&&(this.nc=k)};
t.Ne=function(b){this.jc&&(this.ug=j);var c=this.lc();c&&Ec(c)?c.focus():b.preventDefault()};t.qO=function(){this.ug=n};t.jO=function(b){var c;a:{c=b.target;if(this.Mg)for(var d=this.h();c&&c!==d;){var e=c.id;if(e in this.Mg){c=this.Mg[e];break a}c=c.parentNode}c=k}if(c)switch(b.type){case "mousedown":c.Ne(b);break;case "mouseup":c.ng(b);break;case "mouseover":c.od(b);break;case "mouseout":c.ii(b);break;case "contextmenu":c.ro(b)}};t.Me=ba();t.$c=function(){this.Tb(-1);this.ug=n;this.nc&&this.nc.wb(n)};
t.$b=function(b){return this.isEnabled()&&this.S()&&(0!=ph(this)||this.uy)&&this.uf(b)?(b.preventDefault(),b.stopPropagation(),j):n};
t.uf=function(b){var c=Ws(this);if(c&&"function"==typeof c.$b&&c.$b(b)||this.nc&&this.nc!=c&&"function"==typeof this.nc.$b&&this.nc.$b(b))return j;if(b.shiftKey||b.ctrlKey||b.metaKey||b.altKey)return n;switch(b.keyCode){case 27:if(this.mi())this.lc().blur();else return n;break;case 36:Xs(this);break;case 35:Ys(this,function(b,c){b--;return 0>b?c-1:b},0);break;case 38:if(this.Ab==Vo)Zs(this);else return n;break;case 37:if(this.Ab==Uo)this.Id()?$s(this):Zs(this);else return n;break;case 40:if(this.Ab==
Vo)$s(this);else return n;break;case 39:if(this.Ab==Uo)this.Id()?Zs(this):$s(this);else return n;break;default:return n}return j};a.Us=function(b,c){var d=c.h(),d=d.id||(d.id=c.ae());b.Mg||(b.Mg={});b.Mg[d]=c};t.J=function(b,c){Ts.m.J.call(this,b,c)};t.Zk=function(b,c,d){b.Ak|=2;b.Ak|=64;(this.mi()||!this.oL)&&uo(b,32,n);b.Gp(n);Ts.m.Zk.call(this,b,c,d);b.Ba&&this.Ba&&Us(this,b);c<=this.tb&&this.tb++};
t.removeChild=function(b,c){if(b=oa(b)?mh(this,b):b){var d=hs(this,b);-1!=d&&(d==this.tb?b.ud(n):d<this.tb&&this.tb--);(d=b.h())&&(d.id&&this.Mg)&&E.remove(this.Mg,d.id)}b=Ts.m.removeChild.call(this,b,c);b.Gp(j);return b};t.Hp=function(b){this.h()&&f(Error("Component already rendered"));this.Ab=b};t.S=q("ob");
t.z=function(b,c){if(c||this.ob!=b&&this.dispatchEvent(b?"show":"hide")){this.ob=b;var d=this.h();if(d){R(d,b);if(this.mi()&&(d=this.lc()))d.tabIndex=this.jc&&this.ob?0:-1;c||this.dispatchEvent(this.ob?"aftershow":"afterhide")}return j}return n};t.isEnabled=q("jc");
t.eb=function(b){if(this.jc!=b&&this.dispatchEvent(b?"enable":"disable"))if(b?(this.jc=j,oh(this,function(b){b.AJ?delete b.AJ:b.eb(j)})):(oh(this,function(b){b.isEnabled()?b.eb(n):b.AJ=j}),this.ug=this.jc=n),this.mi()){var c=this.lc();c&&(c.tabIndex=b&&this.ob?0:-1)}};t.mi=q("Pw");t.$e=function(b){b!=this.Pw&&this.Ba&&Vs(this,b);this.Pw=b;if(this.jc&&this.ob){var c=this.lc();c&&(c.tabIndex=b?0:-1)}};t.Tb=function(b){(b=qh(this,b))?b.ud(j):-1<this.tb&&Ws(this).ud(n)};
t.ud=function(b){this.Tb(hs(this,b))};a.Ws=function(b){return qh(b,b.tb)},a.Xs=function(b){Ys(b,function(b,d){return(b+1)%d},ph(b)-1)},a.$s=function(b){Ys(b,function(b,d){return(b+1)%d},b.tb)},a.Zs=function(b){Ys(b,function(b,d){b--;return 0>b?d-1:b},b.tb)},a.Ys=function(b,c,d){for(var d=0>d?hs(b,b.nc):d,e=ph(b),d=c.call(b,d,e),g=0;g<=e;){var h=qh(b,d);if(h&&b.TC(h)){b.pA(d);break}g++;d=c.call(b,d,e)}};t.TC=function(b){return b.S()&&b.isEnabled()&&!!(b.Ub&2)};t.pA=function(b){this.Tb(b)};
a.at=function(b,c){As.call(this,b,c)};y(at,As);at.prototype.Oo=0;at.prototype.Qm=ca("Oo");at.prototype.oa=function(b,c,d,e){var g=ag(b),g=fg(g),h;h=Ub(b);h=ac(h.Ga);h=new Ob(this.Vh.x+h.scrollLeft,this.Vh.y+h.scrollTop);var l=c,m=zm(h,b,l,d,g,10,e);if(0!=(m&496)){if(m&16||m&32)l^=2;if(m&64||m&128)l^=1;m=zm(h,b,l,d,g,10,e);0!=(m&496)&&zm(h,b,c,d,g,this.Oo,e)}};a.bt=function(b,c,d,e){hn.call(this,b,c);this.Oo=d?5:0;this.Bz=e||i};y(bt,hn);bt.prototype.lo=q("Oo");bt.prototype.Qm=ca("Oo");
bt.prototype.oa=function(b,c,d,e){var g=Am(this.element,this.Zf,b,c,k,d,10,e,this.Bz);if(g&496){var h=ct(g,this.Zf),c=ct(g,c),g=Am(this.element,h,b,c,k,d,10,e,this.Bz);g&496&&(h=ct(g,h),c=ct(g,c),Am(this.element,h,b,c,k,d,this.lo(),e,this.Bz))}};
a.ct=function(b,c){b&48&&(c^=2);b&192&&(c^=1);return c},a.dt={},a.et={},a.ft=function(b){if(b){var c=b.getBoundingClientRect(),d=c.bottom,c=c.top;d<$b().height&&0>c&&setTimeout(function(){var c=b.getBoundingClientRect().bottom,g=xs(document);window.scrollTo(g.x,g.y+c-d)})}},a.gt=function(b){function c(b){return $.isNumeric(b)?b+" ":b}var d;d=d||+new Date;if(0>=d-b)return"刚刚";b=Math.floor((d-b)/1E3);d=Math.floor(b/31536E3);if(1<=d)return c(d)+"年前";d=Math.floor(b/2592E3);if(1<=d)return c(d)+"月前";d=
Math.floor(b/604800);if(1<=d)return c(d)+"周前";d=Math.floor(b/86400);if(1<=d)return c(d)+"天前";d=Math.floor(b/3600);if(1<=d)return c(d)+"小时前";d=Math.floor(b/60);if(1<=d)return c(d)+"分钟前";d=Math.floor(b);return c(d)+"秒前"},a.ht=function(){var b=S;return 1===b||0===b?"匿名用户":['<a data-tip="p$t$',b[1],'" href="/people/',b[1],'" title="'+b[0]+'" class="','zm-item-link-avatar">','<img class="zm-item-img-avatar" src="'+b[2]+'" />',"</a>"].join("")},a.it=function(b,c){return!ma(b)?"匿名用户":['<a data-tip="p$t$',
b[1],'" href="/people/',b[1],'"',c?' class="'+c+'"':"",' title="',b[0],'">',b[0],"</a>"].join("")},a.jt=function(b){if(0===b||1===b)return"匿名用户";var c=K("a",{href:"/people/"+b[1],title:b[0]},b[0]);c.setAttribute("data-tip","p$t$"+b[1]);return c},a.kt=function(b){if(0===b||1===b)return K("span");if(ma(b)){var c=K("a",{href:"/people/"+b[1],title:b[0],"class":"zm-item-link-avatar"},K("img",{src:b[2],"class":"zm-list-avatar"}));c.setAttribute("data-tip","p$t$"+b[1]);return c}},a.lt=function(b){return 1===
b?j:ma(b)?b[3]===S[3]:n},a.mt=function(b,c){return $.post("/roundtable/"+b,{action:"add_question",url_token:c})},a.nt=function(b,c,d,e,g,h){h&&(e&&(e=$.proxy(e,h)),g&&(g=$.proxy(g,h)));$.post("/node/"+b,{method:c,params:d},function(b){b&&b.r?g&&g(b):e&&e(b)})},a.ot=function(b,c){return $.post("/question/askpeople",{qid:b,uid:c,op:"remove"})},a.pt=function(b,c,d){return $.post("/question/askpeople",{qid:b,uid:c,_source_type:d,op:"add"})},a.qt=function(b,c){return $.post("/node/AnswerVoteBarV2",{method:c,
params:{answer_id:b}})},a.rt=function(b,c){return $.get(c?"/node/AnswerFullVoteInfoV2":"/node/AnswerVoteInfoV2",{params:{answer_id:b}})},a.st=function(b,c,d,e,g){Gj.call(this,b,[c],[d],e,g)};y(st,Gj);st.prototype.Eh=function(){this.element.style.height=Math.round(this.coords[0])+"px"};a.tt=function(b,c,d,e,g){Gj.call(this,b,[c],[d],e,g)};y(tt,Gj);tt.prototype.Eh=function(){this.element.style.width=Math.round(this.coords[0])+"px"};
a.ut=function(b,c,d,e,g){(2!=c.length||2!=d.length)&&f(Error("Start and end points must be 2D"));Gj.apply(this,arguments)};y(ut,Gj);ut.prototype.Eh=function(){var b=this.Oi&&this.Id()?"right":"left";this.element.style[b]=Math.round(this.coords[0])+"px";this.element.style.top=Math.round(this.coords[1])+"px"};
a.vt=function(b){var c={},b=String(b),d="#"==b.charAt(0)?b:"#"+b;if(qs.test(d))return c.es=Es(d),c.type="hex",c;d=Ds(b);if(d.length){var e=d[0],b=d[1],d=d[2],e=Number(e),b=Number(b),d=Number(d);(isNaN(e)||0>e||255<e||isNaN(b)||0>b||255<b||isNaN(d)||0>d||255<d)&&f(Error('"('+e+","+b+","+d+'") is not a valid RGB color'));e=ps(e.toString(16));b=ps(b.toString(16));d=ps(d.toString(16));c.es="#"+e+b+d;c.type="rgb";return c}if(Fs&&(d=Fs[b.toLowerCase()]))return c.es=d,c.type="named",c;f(Error(b+" is not a valid color string"))},
a.wt=function(b){var c=new Gs(2E3),b=La(b),d=-1==b.indexOf("T")?" ":"T",b=b.split(d);var e=b[0].match(ts);if(e){var g=Number(e[2]),h=Number(e[3]),l=Number(e[4]),d=Number(e[5]),m=Number(e[6])||1;c.setFullYear(Number(e[1]));l?(c.setDate(1),c.setMonth(0),c.add(new os("d",l-1))):d?(c.setMonth(0),c.setDate(1),e=c.getDay()||7,c.add(new os("d",(4>=e?1-e:8-e)+(Number(m)+7*(Number(d)-1))-1))):(g&&(c.setDate(1),c.setMonth(g-1)),h&&c.setDate(h));d=j}else d=n;if(d&&!(d=2>b.length))b=b[1],d=b.match(rs),m=0,d&&
("Z"!=d[0]&&(m=60*d[2]+Number(d[3]),m*="-"==d[1]?1:-1),m-=c.getTimezoneOffset(),b=b.substr(0,b.length-d[0].length)),(d=b.match(ss))?(c.setHours(Number(d[1])),c.setMinutes(Number(d[2])||0),c.setSeconds(Number(d[3])||0),c.setMilliseconds(d[4]?1E3*d[4]:0),0!=m&&c.setTime(c.getTime()+6E4*m),d=j):d=n;return d?c:k},a.xt={ZJ:["公元前","公元"],YJ:["公元前","公元"],hK:"1 2 3 4 5 6 7 8 9 10 11 12".split(" "),uK:"1月 2月 3月 4月 5月 6月 7月 8月 9月 10月 11月 12月".split(" "),gK:"1月 2月 3月 4月 5月 6月 7月 8月 9月 10月 11月 12月".split(" "),
kn:"一月 二月 三月 四月 五月 六月 七月 八月 九月 十月 十一月 十二月".split(" "),rK:"1月 2月 3月 4月 5月 6月 7月 8月 9月 10月 11月 12月".split(" "),wK:"一月 二月 三月 四月 五月 六月 七月 八月 九月 十月 十一月 十二月".split(" "),IK:"星期日 星期一 星期二 星期三 星期四 星期五 星期六".split(" "),yK:"星期日 星期一 星期二 星期三 星期四 星期五 星期六".split(" "),$B:"周日 周一 周二 周三 周四 周五 周六".split(" "),xK:"周日 周一 周二 周三 周四 周五 周六".split(" "),TB:"日一二三四五六".split(""),vK:"日一二三四五六".split(""),sK:["1季","2季","3季","4季"],jK:["第1季度","第2季度","第3季度","第4季度"],PJ:["上午","下午"],QB:["y年M月d日EEEE","y年M月d日","yyyy-M-d","yy-M-d"],BK:["zzzzah时mm分ss秒",
"zah时mm分ss秒","ah:mm:ss","ah:mm"],Ku:6,Qu:[5,6],Lu:5},a.yt=function(b){if(b.altKey&&!b.ctrlKey||b.metaKey||112<=b.keyCode&&123>=b.keyCode)return n;switch(b.keyCode){case 18:case 20:case 93:case 17:case 40:case 35:case 27:case 36:case 45:case 37:case 224:case 91:case 144:case 12:case 34:case 33:case 19:case 255:case 44:case 39:case 145:case 16:case 38:case 224:case 92:return n;case 0:return!B;default:return 166>b.keyCode||183<b.keyCode}},a.zt={},a.At=function(b){var c=Tb(b),d=A&&b.currentStyle;if(d&&
Mc(Ub(c))&&"auto"!=d.width&&"auto"!=d.height&&!d.boxSizing)return c=vg(b,d.width,"width","pixelWidth"),b=vg(b,d.height,"height","pixelHeight"),new Qb(c,b);d=ug(b);c=xg(b);b=gg(b);return new Qb(d.width-b.left-c.left-c.right-b.right,d.height-b.top-c.top-c.bottom-b.bottom)},a.Bt=function(b,c){var d=Ub(c),e=k;if(A)d=e=d.xa().createStyleSheet(),A?d.cssText=b:d.innerHTML=b;else{var g=Vb(d.Ga,"head",i,i)[0];g||(e=Vb(d.Ga,"body",i,i)[0],g=d.o("head"),e.parentNode.insertBefore(g,e));var h=e=d.o("style");A?
h.cssText=b:h.innerHTML=b;d.appendChild(g,e)}},a.Ct=function(b,c){var d=b.style[gb(c)];return"undefined"!==typeof d?d:b.style[Uf(b,c)]||""},a.Dt=function(b,c,d){return Math.min(Math.max(b,c),d)},a.Et=function(){f(Error("unimplemented abstract method"))},a.Ft=function(){M.call(this)};y(Ft,el);
Ft.prototype.w=function(){this.rs=H("help-index");(new Pq).n(this.rs);var b=window.location.href,c="";0<b.indexOf("#")&&(c=b.substring(b.indexOf("#")),b=b.substring(0,b.indexOf("#")));"/help"===b.substring(b.length-5)&&(b+="/faq");var d=Wb("a",k,this.rs);z.forEach(d,function(d){(d.href===b||d.href===b+c)&&Jc(d,function(b){"UL"===b.tagName&&D.add(b,"force-display");"LI"===b.tagName&&D.add(b,"current")})},this);this.g().c(this.rs,"click",this.IO)};
Ft.prototype.IO=function(b){if((b=Gk(this.rs,b.target))&&0<b.href.indexOf("#")){var c=Kc(b,"ul",k),c=Wb("li",k,c);z.forEach(c,function(b){D.remove(b,"current")},this);D.add(b.parentNode,"current")}};a.Gt=function(b,c){M.call(this);this.bn=j;this.Ii=this.Zm=-1;this.YI="";this.tg=b||500;this.iN=c;this.zb=k};y(Gt,el);a.Ht=Wi("PMForm"+S.Yj)||Xi("PMForm"+S.Yj);t=Gt.prototype;t.sh=ca("e");t.h=q("e");t.cy=function(){this.zb=new yi(k,n);this.zb.fb("发送私信");Ih(this.zb,k);this.zb.z(j);this.e=this.zb.ba()};t.focus=function(){this.w();this.Ob.focus()};
t.w=function(){this.EP||(this.EP=j,this.bn&&(this.zb||this.cy(),this.e.innerHTML='<div class="zm-pm-wrap"><dl class="zm-form-table zm-form-table-medium"><dt class="zm-form-table-head zm-form-table-head-align-middle"><label class="zg-medium-gray">发给：</label></dt><dd class="zm-form-table-field"><div class="zm-pm-selector-wrap"><div class="zg-user-name" style="display:none;padding:4px 0 0 0"></div><input class="zg-form-text-input zm-pm-user-selector" type="text" /></div></dd><dt class="zm-form-table-head zm-form-table-head-align-middle"><label class="zg-medium-gray">内容：</label></dt><dd class="zm-form-table-field zm-form-table-field-last"><div class="zg-editor-simple-wrap zg-form-text-input"><textarea class="zg-editor-input" style="font-weight:normal"></textarea></div></dd></dl><div class="zh-pm-warnmsg" style="display:none;text-align:right;color:#C3412F;"></div><div class="zm-command zg-clear"><div class="zm-item-meta zg-left" style="margin: 0 0 0 57px;"><span class="zg-text-counter" style="display:none">还可以输入 500 字</span><span class="additional-info" ></span></div><a name="cancel" href="javascript:;" class="zm-command-cancel">取消</a><a name="send" href="javascript:;" class="zg-btn-blue zg-r3px" id="zh-question-pm-send-button">发送</a></div></div>'),this.Rf=
J("zg-user-name",this.e),this.Ob=J("zg-editor-input",this.e),this.zc=J("zm-pm-user-selector",this.e),this.bj=J("zm-command",this.e),this.yZ=J("zg-text-counter",this.e),this.Xo=J("zh-pm-warnmsg",this.e),this.EW=$(".additional-info",$(this.e)),this.zH=new Po(this.Ob),this.g().c(this.bj,"click",this.ha).c(this.Rf,"click",this.ha).c(this.Ob,"keydown",this.LO),this.zc&&((new gp("搜索用户")).n(this.zc),this.g().c(this.zc,"blur",this.iM),this.M=new go("/people/autocomplete",this.zc,k,k,J("zm-pm-wrap",this.e),
j),this.M.Kf(j),this.g().c(this.M,"select",this.lp)),this.ww(),this.Iy())};t.LO=function(b){if(13===b.keyCode&&(b.ctrlKey||b.metaKey))It(this),b.preventDefault()};t.iM=function(){this.WC&&clearTimeout(this.WC);this.WC=setTimeout(v(this.jM,this),200)};t.jM=function(){var b=xk(this.zc.value);-1===this.Ii&&(b&&"搜索用户"!==b)&&Jt(this,"请输入对方姓名，从下拉菜单里选择收件人")};t.Rt=ca("CU");t.vp=function(){this.Ob.value="";this.bn&&(this.zc.value="");R(this.Xo,n);this.Rf.innerHTML="搜索用户";this.Zm=-1};
t.show=function(){this.w();this.bn&&(this.zb.z(j),this.zb.oa())};t.ww=function(){if(this.kl)$(window).on("beforeunload.PMForm",v(function(){this.Kt()},this))};t.fw=function(){this.kl&&$(window).off("beforeunload.PMForm")};t.Kt=function(){this.kl&&this.Ob.value&&Ht.set("content",this.Ob.value)};t.Iy=function(){if(this.kl){var b=Ht.get("content");b&&(this.Ob.value=b)}};t.Gv=function(){this.kl&&Ht.remove("content")};t.lp=function(){var b=z.slice(this.M.lg(),1);Kt(this,b[3],b[0],j)};
a.Kt=function(b,c,d,e){-1===c?(c=b.Rf,R(b.zc,j),R(c,n)):c!==S[3]&&(b.Ii=c,b.YI=d,b.Rf&&b.zc&&(b.Rf.innerHTML=b.YI+(e?Ak():""),c=b.zc,R(b.Rf,j),R(c,n),b.zc.value=""))},a.It=function(b){if(!(b.Cd&&"pending"===b.Cd.state()))if(-1===b.Ii)Jt(b,"请填写收信人。");else{var c=b.Ob.value;La(c)?(c=-1!==b.Zm?$.post("/inbox/reply",{message_id:b.Zm,content:c,type:b.gB}):$.post("/inbox/post",{member_id:b.Ii,content:c,token:b.CU}),c.done(v(b.HS,b)),b.Cd=c):Jt(b,"请填写私信内容。")}};
t.ha=function(b){if(b=(b=this.qf(b.target))&&b.name)switch(b){case "edit":this.Ii=-1;b=this.Rf;R(this.zc,j);R(b,n);break;case "cancel":this.bn&&this.zb.z(n);break;case "send":It(this)}};a.Jt=function(b,c){b.Xo.innerHTML=c;R(b.Xo,j)};t.HS=function(b){Nk("message","send_message");b&&!b.r?(this.fw(),this.Gv(),this.bn&&this.zb.z(n),this.iN?U("发送成功"):window.location.reload()):Jt(this,b.msg)};t.kl=j;a.Lt=function(b){M.call(this);this.view=this.name=k;E.extend(this.options={},this.R,b||{})};y(Lt,Hd);a.Mt={},a.Nt=function(b,c){function d(c){Lt.call(this,c);this.name=b}y(d,Lt);ya(d.prototype,c);Mt[b]=d};Lt.prototype.R={};Lt.prototype.g=function(){return this.ah||(this.ah=new me(this))};Lt.prototype.w=ba();Lt.prototype.p=function(){Lt.m.p.call(this);this.view&&(E.remove(this.view.sd,this.name),this.view=k);this.ah&&(this.ah.G(),this.ah=k)};a.Ot=function(b){T.call(this);E.extend(this.D={},this.R,b||{});this.source=this.D.source;this.promise=$.Deferred().resolve();this.sd={}};y(Ot,T);t=Ot.prototype;t.R={source:k,Pa:["autoload","shortcut"],zA:j,En:"zg-btn-white zu-button-more"};t.Pa=function(b,c){var d,e=Mt[b];e||f(Error("Cannot find constructor"));d=new e(c);d.view=this;this.Ba?d.w(this):this.g().c(this,"initialized",function(){d.w(this)});this.sd[b]=d;return this};
t.cj=function(){!this.Xf&&this.D.zA&&(this.Xf=this.yv(),mc(this.Xf,this.e),this.g().c(this.Xf,"click",this.Jy))};t.B=function(){Ot.m.B.call(this);this.cj();z.forEach(this.Fb(),this.lr,this);z.forEach(this.D.Pa,this.Pa,this);this.dispatchEvent("initialized")};t.p=function(){E.forEach(this.sd,function(b){b.G()});this.sd=k;Ot.m.p.call(this)};a.Pt=function(b,c,d){b.Ba&&z.forEach(b.Fb(),c,d);b.g().c(b,"itemcreated",function(b){c.call(d,b.item)})};t.Fb=function(){return qc(this.e)};
t.lr=function(b){this.ck(b);this.dispatchEvent({type:"itemcreated",item:b})};t.ck=ha;a.Qt=function(b){b.Xf&&(L(b.Xf),b.Xf=k);b.dispatchEvent("complete")};t.pS=function(b){if(b){var c=b.results,d=!c||!c.length;d||this.Z(c);this.dispatchEvent("next");(d||b.next===n)&&Qt(this)}};t.Z=function(b,c){var b=$.isArray(b)?b.join(""):b,d=hc(b+" ");z.forEach(qc(d),this.lr,this);nc(this.e,d,c)};
t.Jy=function(){"pending"!==this.promise.state()&&(this.CI(j),this.promise=this.source().done(v(this.pS,this)).always(v(xa(this.CI,n),this)))};t.Yc=q("Xf");t.yv=function(){return K("a",{"aria-role":"button","class":this.D.En},"更多")};t.CI=function(b){this.Xf&&(this.Xf.innerHTML=b?'<i class="spinner-gray"></i> 加载中':"更多",D.enable(this.Xf,"loading",b))};a.St=function(b,c){var d=Array.prototype.slice.call(arguments),e=d.shift();"undefined"==typeof e&&f(Error("[goog.string.format] Template required"));return e.replace(/%([0\-\ \+]*)(\d+)?(\.(\d+))?([%sfdiu])/g,function(b,c,e,m,p,r,x,F){if("%"==r)return"%";var I=d.shift();"undefined"==typeof I&&f(Error("[goog.string.format] Not enough arguments"));arguments[0]=I;return Rt[r].apply(k,arguments)})},a.Rt={s:function(b,c,d){return isNaN(d)||""==d||b.length>=d?b:b=-1<c.indexOf("-",0)?b+ab(" ",d-b.length):
ab(" ",d-b.length)+b},f:function(b,c,d,e,g){e=b.toString();isNaN(g)||""==g||(e=b.toFixed(g));var h;h=0>b?"-":0<=c.indexOf("+")?"+":0<=c.indexOf(" ")?" ":"";0<=b&&(e=h+e);if(isNaN(d)||e.length>=d)return e;e=isNaN(g)?Math.abs(b).toString():Math.abs(b).toFixed(g);b=d-e.length-h.length;0<=c.indexOf("-",0)?e=h+e+ab(" ",b):(c=0<=c.indexOf("0",0)?"0":" ",e=h+ab(c,b)+e);return e},d:function(b,c,d,e,g,h,l,m){return Rt.f(parseInt(b,10),c,d,e,0,h,l,m)}};Rt.i=Rt.d;Rt.u=Rt.d;Nt("activeSource",{R:{RC:"%d 条新动态",En:"zu-main-feed-fresh-button",d0:ha},w:function(b){this.data=[];this.button=this.yv();lc(this.button,b.h());this.g().c(this.button,"click",function(){b.Z(this.data,0);this.setData([])});var c=this,d=this.options.source(function(b){b&&b.length&&c.setData(b.concat(c.data))},function(){return c.data});(!d||!qa(d.G))&&f(Error("Source must return a disposable object."));this.kN=d},setData:function(b){this.data=b;this.YR()},YR:function(){var b=this.data.length;zc(this.button,
St(this.options.RC,b));R(this.button,!!b)},yv:function(){return K("a",{href:"javascript:;",style:"display:none","class":this.options.En})},G:function(){Lt.prototype.G.call(this);Vc(this.kN);this.options=k;this.button&&(L(this.button),this.button=k)}});a.Tt=function(){M.call(this);this.size=k;this.kZ=xg(document.body).top;this.ia=new me(this);this.Yp=k;this.cN=250;this.wf()};y(Tt,Hd);ia(Tt);Tt.prototype.wf=function(){this.size=$b();var b=this.Yp=new an(this.update,this.cN,this);this.ia.c(window,"scroll",b.fire,n,b).c(window,"resize",b.fire,n,b)};Tt.prototype.g=q("ia");Tt.prototype.p=function(){Tt.m.p.call(this);this.ia.G();this.ia=k;this.Yp.G();this.Yp=k};Tt.prototype.update=function(){this.size=$b();this.dispatchEvent("update")};
a.Vt=function(b,c,d){var e=Ut;e.ia.c(e,"update",function h(){b.getBoundingClientRect().bottom<this.size.height&&(c.call(d),this.ia.wa(this,"update",h))})},a.Ut=Tt.F();$(function(){Ut.update()});Nt("autoload",{R:{sU:function(b){return 0!==b%3}},w:function(b){if(b.Yc()){var c=this,d=Ut;c.g().c(d,"update",function(d){var e;e=ua(c);var l=td[e];if(l){var m=la("abouttosee"),p=la(i);m&&p?(l=sd.abouttosee,e=!!l&&!!l[i]&&e in l[i]):e=!m&&!p?j:z.some(l,function(b){return m&&"abouttosee"==b.type||p&&b.capture==i})}else e=n;e&&(rg(b.Yc())&&400>=b.Yc().getBoundingClientRect().top-d.target.size.height)&&c.dispatchEvent("abouttosee")});var e=0;this.g().c(b,"complete",this.G).c(b,"next",function(){e+=1;
this.options.sU(e)&&this.enable()});this.enable()}},enable:function(){P(this.g(),this,"abouttosee",function(){this.view.Jy()})}});Nt("childConstructor",{R:{Tg:k},w:function(b){qa(this.options.Tg)&&Pt(b,this.FM,this)},FM:function(b){var c=new this.options.Tg;this.view.J(c);c.n(b)}});Nt("locationSource",{R:{Fy:20,param:k,kt:n,offset:function(b){return b.length}},w:function(b){function c(b){return{start:e.kt?z.Df(b).id.split("-")[1]:0,offset:e.offset(b)}}var d=location.href,e=this.options,g=b.Fb().length;(!g||g<e.Fy)&&Qt(b);b.source=function(){return $.post(d,(e.param||c)(b.Fb())).then(function(c){if(!c.r){var c=c.msg,d=c[0];pa(d)&&d<e.Fy&&Qt(b);return{results:c[1]}}})}}});Nt("nodeSource",{w:function(b){var c=$(b.h()).data("init"),d="/node/"+c.nodename,e=c.params,g=e.offset||0;(c=e.limit)&&b.Fb().length<c&&Qt(b);b.source=function(){return $.post(d,{method:"next",params:$.extend(e,{offset:g+b.Fb().length})}).then(function(b){return!b.r&&{results:b.msg}})}}});Nt("shortcut",{R:{items:">div"},w:function(b){b.Fb().length&&(this.Zo=new vl(this.options),this.Zo.n(b.h()),this.g().c(this.Zo,"action",function(c){c.data.index>=c.data.size&&b.Yc()&&rg(b.Yc())&&b.Yc().click()}))},G:function(){Lt.prototype.G.call(this);this.Zo&&(this.Zo.G(),this.Zo=k)}});a.Wt=function(b){Ot.call(this,b)};y(Wt,Ot);a.Xt=function(){this.jd=k};ia(Xt);a.Yt={"0":"其他",501:"不构成问题",502:"广告等垃圾信息",503:"违法违规内容",504:"不宜公开讨论的政治内容",505:"不友善内容",506:"个人信息不合规范",507:"发布不友善内容",508:"发布广告等垃圾信息"},a.Zt={question:{title:"为什么举报这个问题？",rb:[]},comment:{title:"为什么举报这个评论？",rb:[505,502,503,504,0]},answer:{title:"为什么举报这个回答？",rb:[502,505,503,504,0]},favlist:{title:"为什么举报这个收藏？",rb:[505,503,0]},member:{title:"为什么举报这个用户？",rb:[506,507,508,0]},message:{title:"为什么举报这个私信？",rb:[505,502,0]}};t=Xt.prototype;t.className="report-form-dialog";
t.YN=Tr(function(b){var c=Zt[b];return c.rb.length?$.Deferred().resolve(c):$.getJSON("/report/reason",{type:b}).then(function(b){c.rb=b;return c})});t.oO=function(b){if("ok"===b.key)return this.submit()};
t.Gm=function(b,c,d){var e=this;this.YN(b).done(function(g){var h=new yi;Ch(h,j);h.jw=j;Ih(h,Kh);h.addEventListener(Jh,e.oO,n,e);e.jd=h;h.fb(g.title);h.Oa("<form>"+("question"===b?$t(g.rb):au(g.rb))+'<p class="input-container"><input placeholder="请填写举报或申诉原因" type="text" name="detail" class="reason-text hidden zg-form-text-input"></p><p class="error-container"></p><p class="footnote">'+(d||"")+"</p></form>");h.z(j);e.vN={type:b,id:c};e.rv(b);D.add(h.h(),Xt.prototype.className);h.oa();h.Fi(450);Y.V({type:"ga_click_report_box",
data:{type:b}})})};t.submit=function(){var b=this.jd,c=this.vN,d=$("form",b.h()),e=d.valid();e&&($.post("/report",d.serialize()+"&"+$.param(c)).done(function(c){b.z(n);c.r?U(c.msg):U("您的举报我们已经收到，处理完成后会私信告知处理结果。",2E3)}),Y.V({type:"ga_click_report",data:{type:c.type}}));return e};
t.rv=function(b){var c=$(this.jd.ba()),d=$("form",c),e=$(".reason-text",c);c.on("change",":radio",function(b){c.find("li").removeClass("checked");$(b.target).parents("li").addClass("checked");b="0"===this.value;e.toggle(b);b&&e.placeholder()});"question"===b&&e.appendTo(c.find("li").has('input[value="0"]'));d.validate({rules:{reason:"required",detail:{rangelength:[2,100],required:function(){return!!$("input[name=reason]:checked",c).length}}},messages:{reason:"请选择举报理由",detail:"举报理由为 2-100 字"},errorLabelContainer:$(".error-container",
d)})};
a.au=function(b){var c=['<ul class="options clearfix">'];z.forEach(b,function(b){c.push('<li><label><input value="'+b+'" name="reason" type="radio"> '+Yt[b]+"</label></li>")});c.push("</ul>");return c.join("")},a.$t=function(b){var c=['<div><a href="http://www.zhihu.com/question/19806261" class="zg-right zg-link-gray">知乎提问规范</a>请选择举报原因</div>','<ul class="question-options clearfix">'];z.forEach(b,function(b){b.nodes?(c.push('<li><label><input name="reason" value="'+b.id+'" type="radio"> '+b.text+'</label><ul class="sub-list">'),
z.forEach(b.nodes,function(e){c.push('<li><label><input required data-msg-required="请选择举报理由" name="reason-'+b.id+'" value="'+e.id+'" type="radio"> '+e.text+"</label>");e.note&&c.push('<div class="note">'+e.note+"</div>");c.push("</li>")}),c.push("</ul></li>")):(c.push('<li><label><input value="'+b.id+'" name="reason" type="radio"> '+b.text+"</label>"),b.note&&c.push('<div class="note">'+b.note+"</div>"),c.push("</li>"))});c.push("</ul>");return c.join("")},a.bu=Xt.F();a.cu=function(){M.call(this);this.Te="zm-pm-item"};y(cu,el);cu.prototype.w=function(){var b=H("zh-create-pm");b&&this.g().c(b,"click",this.WR);var b=H("zh-pm-item-wrap"),c=new Wt;c.Pa("locationSource",{param:function(b){return{start:b[b.length-1].getAttribute("data-token")}}});c.n(b);this.g().c(b,"click",this.ha);$(function(){$("#zh-change-pm-admin").change(function(){var b=$(this).find("option:selected").attr("data-token");location.href="self"===b?"/admin_feedback":"/admin_feedback/"+b})})};
cu.prototype.WR=function(){var b;this.Mj();this.Sb.show();Kt(this.Sb,-1);(b=Wa(location.pathname,"admin_inbox")?"admin":$("#zh-change-pm-admin option:selected").attr("data-token"))&&this.Sb.Rt(b)};cu.prototype.Mj=function(){this.Sb||(this.Sb=new Gt)};
cu.prototype.ha=function(b){if(b=Gk(this.L_,b.target)){var c=b.name,d=Kc(b,k,this.Te);if(!d||!b.name)return j;var b=$(d).data(),e=b.member,g=b.name;switch(c){case "reply":d.getAttribute("data-adminmessagetoken");this.Mj();this.Sb.show();c=this.Sb;d=b.type;c.Zm=b.token;c.gB=d;Kt(this.Sb,e,g,n);this.Sb.Ob.focus();break;case "delete":var h=d.getAttribute("data-token");Ci("删除私信会话","你确定要删除与 "+g+"的所有会话吗？",function(b){if(b){var c=new V(j);c.on("success",function(){var b=Ie(c);b.r?U(b.msg):window.location.reload()});
c.ajax("/inbox/delete","type=thread&token="+h)}},this);break;case "edit":b=this.Rf,R(this.zc,j),R(b,n),this.Ii=-1}}};a.du=function(){M.call(this);this.Te="zm-pm-item"};y(du,el);
du.prototype.w=function(){this.Ps=H("zh-pm-detail-item-wrap");this.g().c(this.Ps,"click",this.ha);var b=H("zh-pm-editor-form");if(b){this.Sb=new Gt;this.Sb.bn=n;this.Sb.sh(b);this.Sb.show();if(b=this.Fb()[0]){var b=$(b).data(),c=this.Sb,d=b.type;c.Zm=b.token;c.gB=d;Kt(this.Sb,b.member,b.name)}else b=Hg,Kt(this.Sb,b.id,b.Uw);this.Sb.focus()}else this.Sb=new Gt;this.Fb().length&&(b=new Wt,b.Pa("locationSource",{param:function(b){return{start:b[b.length-1].getAttribute("data-token")}}}),b.n(this.Ps))};
du.prototype.Fb=function(){return qc(this.Ps)};
du.prototype.ha=function(b){var c=Gk(this.Ps,b.target);if(c&&(b=c.name,c=Kc(c,k,this.Te))){var c=$(c).data(),d=c.token;switch(b){case "reply":this.Sb.show();var b=this.Sb,e=c.type;b.Zm=d;b.gB=e;Kt(this.Sb,c.member,c.name,n);this.Sb.focus();break;case "delete":Ci("删除私信","你确定要删除这封私信吗？",function(b){if(b){var c=new V(j);P(this.g(),c,"success",function(){var b=Ie(c);b.r?U(b.msg):window.location.reload()});c.ajax("/inbox/delete","type=single&token="+d)}},this);break;case "report":bu.Gm("message",d,"被举报私信将会被管理员查阅")}}};a.eu=function(){};y(eu,ho);ia(eu);eu.prototype.O=s("goog-menuheader");a.fu=function(b,c,d){ro.call(this,b,d||eu.F(),c);uo(this,1,n);uo(this,2,n);uo(this,4,n);uo(this,32,n);this.da=1};y(fu,ro);po("goog-menuheader",function(){return new fu(k)});a.gu=function(){this.Ev=[]};y(gu,ho);ia(gu);a.hu=function(b,c){var d=b.Ev[c];if(!d){switch(c){case 0:d=b.O()+"-highlight";break;case 1:d=b.O()+"-checkbox";break;case 2:d=b.O()+"-content"}b.Ev[c]=d}return d};t=gu.prototype;t.wc=function(){return Xc.dK};t.o=function(b){var c=b.K().o("div",this.sf(b).join(" "),iu(this,b.ib(),b.K()));ju(this,b,c,!!(b.Ub&8)||!!(b.Ub&16));ko(this,b,c);return c};t.ba=function(b){return b&&b.firstChild};
t.n=function(b,c){var d=sc(c),e=hu(this,2);d&&D.has(d,e)||c.appendChild(iu(this,c.childNodes,b.K()));D.has(c,"goog-option")&&(b.Dp(j),this.Dp(b,c,j));return gu.m.n.call(this,b,c)};t.Oa=function(b,c){var d=this.ba(b),e=ku(this,b)?d.firstChild:k;gu.m.Oa.call(this,b,c);e&&!ku(this,b)&&d.insertBefore(e,d.firstChild||k)};a.iu=function(b,c,d){b=hu(b,2);return d.o("div",b,c)};t.Ei=function(b,c,d){c&&(Oc(c,d?Xc.fK:this.wc()),ju(this,b,c,d))};t.Dp=function(b,c,d){c&&(Oc(c,d?Xc.eK:this.wc()),ju(this,b,c,d))};
a.ku=function(b,c){var d=b.ba(c);if(d){var d=d.firstChild,e=hu(b,1);return!!d&&D.has(d,e)}return n},a.ju=function(b,c,d,e){e!=ku(b,d)&&(D.enable(d,"goog-option",e),d=b.ba(d),e?(b=hu(b,1),d.insertBefore(c.K().o("div",b),d.firstChild||k)):d.removeChild(d.firstChild))};t.ho=function(b){switch(b){case 2:return hu(this,0);case 16:case 8:return"goog-option-selected";default:return gu.m.ho.call(this,b)}};
t.jx=function(b){var c=hu(this,0);switch(b){case "goog-option-selected":return 16;case c:return 2;default:return gu.m.jx.call(this,b)}};t.O=s("goog-menuitem");a.lu=function(b,c,d,e){ro.call(this,b,e||gu.F(),d);this.ua(c)};y(lu,ro);t=lu.prototype;t.X=function(){var b=this.Zy;return b!=k?b:this.Yg()};t.ua=ca("Zy");t.Ei=function(b){uo(this,8,b);this.ee()&&!b&&this.Sc(n);var c=this.h();c&&this.N.Ei(this,c,b)};t.Dp=function(b){uo(this,16,b);var c=this.h();c&&this.N.Dp(this,c,b)};
t.Yg=function(){var b=this.ib();return ma(b)?(b=z.map(b,function(b){var d=D.get(b);return z.contains(d,"goog-menuitem-accel")||z.contains(d,"goog-menuitem-mnemonic-separator")?"":Ic(b)}).join(""),Ka(b)):lu.m.Yg.call(this)};t.ng=function(b){var c=this.getParent();if(c){var d=c.oH;c.oH=k;if(c=d&&pa(b.clientX))c=new Ob(b.clientX,b.clientY),c=d==c?j:!d||!c?n:d.x==c.x&&d.y==c.y;if(c)return}lu.m.ng.call(this,b)};t.uf=function(b){return b.keyCode==this.Xy&&this.le(b)?j:lu.m.uf.call(this,b)};t.WN=q("Xy");
po("goog-menuitem",function(){return new lu(k)});a.mu=function(){};y(mu,So);ia(mu);t=mu.prototype;t.wc=function(){return Xc.cK};t.Wc=function(b){return"UL"==b.tagName||mu.m.Wc.call(this,b)};t.jo=function(b){return"HR"==b.tagName?new Ro:mu.m.jo.call(this,b)};t.Yf=function(b,c){return uc(b.h(),c)};t.O=s("goog-menu");t.Qe=function(b){mu.m.Qe.call(this,b);Pc(b.h(),Wc.Xk,"true")};a.nu=function(b){Ro.call(this,Qo.F(),b)};y(nu,Ro);po("goog-menuseparator",function(){return new Ro});a.ou=function(b,c){Ts.call(this,Vo,c||mu.F(),b);this.$e(n)};y(ou,Ts);t=ou.prototype;t.pn=j;t.pL=n;t.O=function(){return this.N.O()};t.Yf=function(b){if(this.N.Yf(this,b))return j;for(var c=0,d=ph(this);c<d;c++){var e=qh(this,c);if("function"==typeof e.Yf&&e.Yf(b))return j}return n};t.Fa=function(b){this.J(b,j)};t.Ti=function(b,c){this.Zk(b,c,j)};t.removeItem=function(b){(b=this.removeChild(b,j))&&b.G()};t.gi=function(b){return qh(this,b)};t.Pl=function(){return ph(this)};
t.Fb=function(){var b=[];oh(this,function(c){b.push(c)});return b};t.ed=function(b,c){var d=this.S();d||R(this.h(),j);lg(this.h(),b,c);d||R(this.h(),n)};t.z=function(b,c,d){(c=ou.m.z.call(this,b,c))&&(b&&this.Ba&&this.pn)&&this.lc().focus();this.oH=b&&d&&pa(d.clientX)?new Ob(d.clientX,d.clientY):k;return c};t.xx=function(b){this.pn&&this.lc().focus();return ou.m.xx.call(this,b)};t.TC=function(b){return(this.pL||b.isEnabled())&&b.S()&&!!(b.Ub&2)};
t.$=function(b){var c=this.N,d;d=this.K();d=Vb(d.Ga,"div",c.O()+"-content",b);for(var e=d.length,g=0;g<e;g++)To(c,this,d[g]);ou.m.$.call(this,b)};t.uf=function(b){var c=ou.m.uf.call(this,b);c||oh(this,function(d){!c&&(d.WN&&d.Xy==b.keyCode)&&(this.isEnabled()&&this.ud(d),c=d.$b(b))},this);return c};t.Tb=function(b){ou.m.Tb.call(this,b);(b=qh(this,b))&&hg(b.h(),this.h())};a.pu=function(b,c,d){T.call(this);this.offset=this.Gi=0;this.PU=d;this.qN=b;this.url=c||window.location.href;this.gh="zm-item";this.rd={}};y(pu,T);t=pu.prototype;t.ru=!ub;t.ou=!ub;t.If=ca("gh");t.w=function(){this.bc=H("zh-load-more");this.n(this.qN)};
t.B=function(){pu.m.B.call(this);this.tn=1;qu(this);this.Vk=$(this.bc);this.bc&&ru(this)&&(this.g().c(this.bc,"click",function(){this.Go=j;this.Gh&&"pending"===this.Gh.state()&&1===this.tn?(this.Gh.done(v(this.Af,this)),this.BA=j,su(this,j)):this.rz()}),this.ru&&(this.hB=new an(this.oz,100,this),this.g().c(window,"scroll",function(){this.hB.fire()})));tu(this,this.Fb())};a.su=function(b,c){c?b.Vk.html('<i class="spinner-gray"></i>正在加载').prop("disabled",j):b.Vk.html("更多").prop("disabled",n)};
t.oz=function(){var b=this.bc;if(b&&rg(b)&&1E3>=b.getBoundingClientRect().top-$b().height&&!(this.qt||this.Gh&&"pending"===this.Gh.state()))this.ou&&(3===this.tn?(this.tn=1,this.BA=n):(this.Go=n,this.tn++,this.BA=j)),uu(this)};t.rz=function(){this.ru&&this.qt?(this.Af(this.qt),this.qt=k):(su(this,j),uu(this))};
a.ru=function(b){var c=b.Fb();b.offset=b.dt?b.dt(c):c.length;if(b.ds)return c=b.ds(),R(b.bc,c),c;if(b.bc){if("-1"===b.Vk.attr("data-next")||!c||10>c.length)return b.Vk.hide(),n;b.Vk.removeClass("hidden").show()}return j},a.uu=function(b,c,d){d=d||ha;if(!(b.Gh&&"pending"===b.Gh.state())){var e=b.DH($.extend(b.rd,{offset:b.offset,start:b.Gi}));b.Gh=$.post(b.url,e).done(d).done($.proxy(function(b){this.ru&&!c?this.BA?this.Af(b):(this.qt=b,su(this,n)):this.Af(b)},b));1!==b.tn&&su(b,j);return b.Gh}};
t.DH=aa();t.Af=function(b){if(b&&!b.r){var c=b.msg,d=c[0],e=c[1],g;2<c.length&&(g=c[2],this.bc.setAttribute("data-next",g));0<d&&(this.mv(e),this.offset=this.dt?this.dt(this.Fb()):this.offset+d);c=j;c=this.ds?this.ds(b):!(-1===g||10>d);R(this.bc,c);su(this,n);vu(this)}};a.vu=function(b){b.dispatchEvent({data:{Go:b.Go,ou:b.ou},type:"afterload"})};t.Fb=function(){return Xb(this.gh,this.e)};t.xH=function(b){return b.id.split("-")[1]};
a.qu=function(b){var c=b.Fb(),d;if(b.PU)if(b.bc&&(d=b.bc.getAttribute("data-next")),d)b.Gi=d;else if(c=z.Df(c))b.Gi=b.xH(c)};t.mv=function(b){var b=ma(b)?b.join(""):b,b=hc(b+" "),c=Xb(this.gh,b);tu(this,c);this.e.appendChild(b);qu(this)};a.tu=function(b,c){z.forEach(c,function(b){var c=this.ck(b);this.dispatchEvent({data:{item:b,OQ:c},type:"itemcreated"})},b)};t.ck=ha;a.wu=function(b){M.call(this);this.e=b;b=A||C&&!Gb("531")&&"TEXTAREA"==b.tagName;this.Q=new me(this);this.Q.c(this.e,b?["keydown","paste","cut","drop","input"]:"input",this)};y(wu,Hd);wu.prototype.ra=k;
wu.prototype.handleEvent=function(b){if("input"==b.type)xu(this),(!tb||this.e==Tb(this.e).activeElement)&&this.dispatchEvent(yu(b));else if("keydown"!=b.type||yt(b)){var c="keydown"==b.type?this.e.value:k;A&&229==b.keyCode&&(c=k);var d=yu(b);xu(this);this.ra=Ld(function(){this.ra=k;this.e.value!=c&&this.dispatchEvent(d)},0,this)}};a.xu=function(b){b.ra!=k&&(Id.clearTimeout(b.ra),b.ra=k)},a.yu=function(b){b=new md(b.Zb);b.type="input";return b};
wu.prototype.p=function(){wu.m.p.call(this);this.Q.G();xu(this);delete this.e};a.Au=function(b,c,d,e){M.call(this);this.Ud=b;this.Yh=c;this.tg=d;this.PD=e||zu;this.Oj=new wu(b);N(this.Oj,"input",this.cp,n,this);this.aj()};y(Au,Hd);a.zu=0;t=Au.prototype;t.cp=function(){this.aj()};t.aj=function(){var b=this.Sr();this.Yh&&(0>this.tg-b?(zc(this.Yh,"已超出 "+(b-this.tg)+" 字"),D.add(this.Yh,"zg-text-error")):(zc(this.Yh,"还可以输入 "+(this.tg-b)+" 字"),D.remove(this.Yh,"zg-text-error")))};t.p=function(){Au.m.p.call(this);delete this.Ud;this.Oj.G();this.Oj=k};
t.isValid=function(){return 0<=this.tg-this.Ud.value.length};t.Sr=function(){return this.Ud.value.length};a.Bu=function(b,c,d,e){Au.call(this,b,c,d,e)};y(Bu,Au);Bu.prototype.Sr=function(){return Lk(this.Ud.value)};a.Cu=function(){M.call(this);this.U=k;this.JI=n;this.Pg={}};y(Cu,el);ia(Cu);t=Cu.prototype;t.w=function(){this.li||(this.g().c(Ki,"question_title_change",function(){this.Pg[this.Dh]=k;this.vp()}),this.li=j,this.o(),this.Ea(),this.Cf())};t.show=function(){this.w();this.vp();this.Ac&&(this.Ac.checked=n,this.Cf());this.yc&&(this.yc.checked=n,this.Cf());Mo.F().refresh();this.U.z(j)};t.hide=function(){this.U.z(n)};t.yk=function(b,c,d,e){this.uh={title:b,type:c,QV:d,rd:e};this.Dh=c.type+":"+d};
t.vp=function(){this.U.fb(this.uh.title);this.Pg[this.Dh]||(this.xhr=new V(j),P(this.g(),this.xhr,"success",this.KU),this.xhr.ajax("/"+this.uh.type+"/"+this.uh.QV+"/sharetext","","GET"));H("zh-webshare-sina-pm").value=this.Pg[this.Dh]&&this.Pg[this.Dh].sina||"加载中...";this.HI.aj();No(this.MA);this.MA.fq();H("zh-webshare-mail-content").value=this.Pg[this.Dh]&&this.Pg[this.Dh].mail||"加载中...";No(this.YD);this.YD.fq();var b=this.Qk;b.w();b.vp();b.Ob.value=this.Pg[this.Dh]&&this.Pg[this.Dh].pm||"加载中...";
b.fM&&b.fM.aj();No(b.zH);b.zH.fq();R(b.zc,j);R(b.Rf,n)};t.KU=function(){var b=Ie(this.xhr);b&&b.r?U(b.msg):(this.Pg[this.Dh]=b,this.vp())};t.o=function(){var b=H("zh-webshare-dialog");b?(this.e=b,this.U=new yi(k,n),Ih(this.U,k),this.U.ba().appendChild(this.e),this.Qk=new Gt,this.Qk.zb=this.U,this.Qk.sh(H("tb-webshare-letter-content")),this.Qk.kl=n,this.Qk.w()):Mk("module WebshareDialog does not exist!")};t.tA=function(){this.Ac.checked=j;this.Cf()};t.sA=function(){this.yc.checked=j;this.Cf()};
a.Du=function(b,c){var d=H(c+"-content"),e=H(c);z.forEach(b.wV,function(b){D.remove(b,"zm-common-nav-bar-current-light")});z.forEach(b.vV,function(b){R(b,n)});D.add(e,"zm-common-nav-bar-current-light");R(d,j);b.gU||(b.U.oa(),b.gU=j)};
t.Ea=function(){var b=J("zm-common-nav-bar",this.e);this.g().c(b,"click",this.LS);this.wV=Xb("zm-common-nav-bar-link",this.e);this.vV=Xb("zm-tab-content",this.e);this.Jv=Xb("zm-command",this.e);this.g().c(this.Jv[0],"click",this.ha);this.g().c(this.Jv[1],"click",this.ha);this.g().c(this.Jv[2],"click",this.ha);this.pp=H("zh-webshare-sina-pm");this.MA=new Po(this.pp);this.HI=new Bu(this.pp,H("zg-webshare-sina-counter"),140,zu);this.rw=H("zh-webshare-mail-reciiver");this.qw=H("zh-webshare-mail-content");
this.YD=new Po(this.qw);this.g().c(Y,"sina_callback",function(b){this.tA(b.nb.id,b.nb.name)}).c(Y,"qq_callback",function(b){this.sA(b.nb.id,b.nb.name)});this.pv();this.g().c(J("zg-btn-blue",this.Qk.h()),"click",this.ha)};t.pv=function(){this.Ac=J("sina-checkbox",this.e);this.g().c(this.Ac,"change",this.mp);this.yc=J("qq-checkbox",this.e);this.g().c(this.yc,"change",this.mp)};
t.Cf=function(){var b=J("weibo-share-button",this.e),c=this.Ac.checked||this.yc.checked;D.enable(b,"zg-btn-blue",c);D.enable(b,"zg-btn-disabled",!c)};t.mp=function(b){var b=b.target,c=b.getAttribute("data-bindurl");b===this.Ac&&!Sg.id||b===this.yc&&!Tg.id?(window.open(c),b.checked=n):this.Cf()};t.LS=function(b){(b=this.qf(b.target))&&Du(this,b.id)};
t.ha=function(b){var c=this.qf(b.target);if(c&&c.name)switch(c.name){case "cancel":this.hide();break;case "send_sina":if(!D.has(c,"zg-btn-disabled")&&this.pp.value&&Eu(this.pp.value)){c=new Hk(j);c.add("content",this.pp.value);var d=[];this.Ac.checked&&d.push("sina");this.yc.checked&&d.push("qq");c.add("via",d.join(","));this.gk(c);this.uh&&Y.V({type:"ga_click_share_"+this.uh.type+"_weibo",data:{xJ:d}})}break;case "send_mail":this.rw.value&&Eu(this.qw.value)&&(c=new Hk(j),c.add("via","email"),c.add("email",
this.rw.value),c.add("title",""),c.add("content",this.qw.value),this.gk(c));break;case "send":if(c=this.Qk,"-1"===String(c.Ii))Jt(c,"请填写收信人。");else if(d=c.Ob.value,Eu(d))if(La(d)){var e=new Hk(j);e.add("talker_id",c.Ii);e.add("content",d);e.add("via","pm");this.gk(e);this.uh&&Y.V("ga_click_share_"+this.uh.type+"_message")}else Jt(c,"请填写私信内容。")}b.stopPropagation();b.preventDefault()};a.Eu=function(b){return 0!==b.indexOf("加载中")};
t.gk=function(b){E.forEach(this.uh.rd,function(c,d){b.add(d,c)});this.xhr=new V(j);P(this.g(),this.xhr,"complete",this.dv);this.xhr.ajax("/"+this.uh.type+"/share",b.Lc())};t.dv=function(){var b=Ie(this.xhr);b&&b.r?U(b.msg):(this.U.z(n),U("分享发送完毕"),this.rw.value="")};t.S=function(){return this.U.S()};a.Fu=void 0,a.Gu=[],a.Hu=[].slice,a.Iu=Vk(550,function(){if(Gu.length){var b={items:JSON.stringify(Gu)};$.post("/lastread/touch",b);Gu=[]}});Fu=function(){Gu.push(Hu.call(arguments));Iu()};a.Ju=function(b,c,d,e){bt.call(this,b,c,d||e);if(d||e)this.Qm(65|(e?32:132))};y(Ju,bt);a.Ku=function(){};y(Ku,no);ia(Ku);t=Ku.prototype;t.o=function(b){var c={"class":"goog-inline-block "+this.sf(b).join(" "),title:b.mg()||""},c=b.K().o("div",c,this.cj(b.ib(),b.K()));ko(this,b,c);return c};t.wc=function(){return Xc.wq};t.ba=function(b){return b&&b.firstChild.firstChild};t.cj=function(b,c){return c.o("div","goog-inline-block "+(this.O()+"-outer-box"),c.o("div","goog-inline-block "+(this.O()+"-inner-box"),b))};t.Wc=function(b){return"DIV"==b.tagName};
t.n=function(b,c){Lu(c,j);Lu(c,n);var d;a:{d=b.K().zE(c);var e=this.O()+"-outer-box";if(d&&D.has(d,e)&&(d=b.K().zE(d),e=this.O()+"-inner-box",d&&D.has(d,e))){d=j;break a}d=n}d||c.appendChild(this.cj(c.childNodes,b.K()));D.add(c,"goog-inline-block",this.O());return Ku.m.n.call(this,b,c)};t.O=s("goog-custom-button");
a.Lu=function(b,c){if(b)for(var d=c?b.firstChild:b.lastChild,e;d&&d.parentNode==b;){e=c?d.nextSibling:d.previousSibling;if(3==d.nodeType){var g=d.nodeValue;if(""==La(g))b.removeChild(d);else{d.nodeValue=c?g.replace(/^[\s\xa0]+/,""):Ma(g);break}}else break;d=e}};a.Mu=function(){};y(Mu,Ku);ia(Mu);B&&(Mu.prototype.Oa=function(b,c){var d=Mu.m.ba.call(this,b&&b.firstChild);d&&oc(this.createCaption(c,Ub(b)),d)});t=Mu.prototype;t.ba=function(b){b=Mu.m.ba.call(this,b&&b.firstChild);B&&(b&&b.__goog_wrapper_div)&&(b=b.firstChild);return b};t.n=function(b,c){var d=Wb("*","goog-menu",c)[0];if(d){R(d,n);Tb(d).body.appendChild(d);var e=new ou;e.n(d);b.th(e)}return Mu.m.n.call(this,b,c)};
t.cj=function(b,c){return Mu.m.cj.call(this,[this.createCaption(b,c),c.o("div","goog-inline-block "+(this.O()+"-dropdown")," ")],c)};t.createCaption=function(b,c){return Nu(b,this.O(),c)};a.Nu=function(b,c,d){return d.o("div","goog-inline-block "+(c+"-caption"),b)};t.O=s("goog-menu-button");a.Ou=function(b,c,d,e){yo.call(this,b,d||Mu.F(),e);uo(this,64,j);this.lm=new Ju(k,5);c&&this.th(c);this.uG=k;this.ra=new Jd(500);if((ii||ji)&&!Gb("533.17.9"))this.Cs=j};y(Ou,yo);t=Ou.prototype;t.Cs=n;t.tp=n;t.B=function(){Ou.m.B.call(this);this.la&&Pu(this,this.la,j);Pc(this.h(),Wc.Xk,"true")};t.$a=function(){Ou.m.$a.call(this);if(this.la){this.wb(n);this.la.$a();Pu(this,this.la,n);var b=this.la.h();b&&L(b)}};t.p=function(){Ou.m.p.call(this);this.la&&(this.la.G(),delete this.la);delete this.xT;this.ra.G()};
t.Ne=function(b){Ou.m.Ne.call(this,b);this.Hb()&&(this.wb(!this.ub(),b),this.la&&(b=this.ub(),this.la.ug=b))};t.ng=function(b){Ou.m.ng.call(this,b);this.la&&!this.Hb()&&(this.la.ug=n)};t.le=function(){this.setActive(n);return j};t.pO=function(b){this.la&&(this.la.S()&&!this.Yf(b.target))&&this.wb(n)};t.Yf=function(b){return b&&uc(this.h(),b)||this.la&&this.la.Yf(b)||n};
t.uf=function(b){if(32==b.keyCode){if(b.preventDefault(),"keyup"!=b.type)return j}else if("key"!=b.type)return n;if(this.la&&this.la.S()){var c=this.la.$b(b);return 27==b.keyCode?(this.wb(n),j):c}return 40==b.keyCode||38==b.keyCode||32==b.keyCode||13==b.keyCode?(this.wb(j),j):n};t.so=function(){this.wb(n)};t.SO=function(){this.Hb()||this.wb(n)};t.$c=function(b){this.Cs||this.wb(n);Ou.m.$c.call(this,b)};t.ab=function(){this.la||this.th(new ou(this.K()));return this.la||k};
t.th=function(b){var c=this.la;if(b!=c&&(c&&(this.wb(n),this.Ba&&Pu(this,c,n),delete this.la),b)){this.la=b;nh(b,this);b.z(n);var d=this.Cs;(b.pn=d)&&b.$e(j);this.Ba&&Pu(this,b,j)}return c};t.Fa=function(b){this.ab().J(b,j)};t.Ti=function(b,c){this.ab().Zk(b,c,j)};t.removeItem=function(b){(b=this.ab().removeChild(b,j))&&b.G()};t.gi=function(b){return this.la?qh(this.la,b):k};t.Pl=function(){return this.la?ph(this.la):0};t.z=function(b,c){var d=Ou.m.z.call(this,b,c);d&&!this.S()&&this.wb(n);return d};
t.eb=function(b){Ou.m.eb.call(this,b);this.isEnabled()||this.wb(n)};a.Qu=function(b){b.lm.Qm&&b.lm.Qm(33)};t.BI=function(){this.wb(j)};
t.wb=function(b,c){Ou.m.wb.call(this,b);if(this.la&&!!(this.da&64)==b){if(b)this.la.Ba||(this.tp?this.la.Z(this.h().parentNode):this.la.Z()),this.Mk=fg(this.h()),this.Zi=pg(this.h()),Ru(this),this.la.Tb(-1);else if(this.setActive(n),this.la.ug=n,this.h()&&Pc(this.h(),Wc.hn,""),this.jt!=k){this.jt=i;var d=this.la.h();d&&mg(d,"","")}this.la.z(b,n,c);if(!this.ag){var d=this.g(),e=b?d.c:d.wa;e.call(d,this.K().xa(),"mousedown",this.pO,j);this.Cs&&e.call(d,this.la,"blur",this.SO);e.call(d,this.ra,Kd,this.tm);
b?this.ra.start():this.ra.stop()}}};a.Ru=function(b){if(b.la.Ba){var c=b.lm;b.lm.element=b.xT||b.h();var d=b.la.h();b.la.S()||(d.style.visibility="hidden",R(d,j));!b.jt&&(b.lm.lo&&b.lm.lo()&32)&&(b.jt=og(d));c.oa(d,c.Zf^1,b.uG,b.jt);b.la.S()||(R(d,n),d.style.visibility="visible")}};
t.tm=function(){var b=pg(this.h()),c=fg(this.h());if(!(this.Zi==b||(!this.Zi||!b?0:this.Zi.left==b.left&&this.Zi.width==b.width&&this.Zi.top==b.top&&this.Zi.height==b.height))||!(this.Mk==c||(!this.Mk||!c?0:this.Mk.top==c.top&&this.Mk.right==c.right&&this.Mk.bottom==c.bottom&&this.Mk.left==c.left)))this.Zi=b,this.Mk=c,Ru(this)};a.Pu=function(b,c,d){var e=b.g(),d=d?e.c:e.wa;d.call(e,c,"action",b.so);d.call(e,c,"highlight",b.Cx);d.call(e,c,"unhighlight",b.Lx)};t.Cx=function(b){Pc(this.h(),Wc.hn,b.target.h().id)};
t.Lx=function(){Ws(this.la)||Pc(this.h(),Wc.hn,"")};po("goog-menu-button",function(){return new Ou(k)});a.Su=function(b,c){ou.call(this,b,c);this.pn=j;this.$e(j);this.z(n,j);this.Nf=new Od};y(Su,ou);t=Su.prototype;t.MV=n;t.WF=0;t.gf=k;t.$=function(b){Su.m.$.call(this,b);(b=b.getAttribute("for")||b.htmlFor)&&this.attach(this.K().h(b),1)};t.B=function(){Su.m.B.call(this);Md.forEach(this.Nf,this.CC,this);var b=this.g();b.c(this,"action",this.GR);b.c(this.K().xa(),"mousedown",this.WG,j);C&&b.c(this.K().xa(),"contextmenu",this.WG,j)};
t.attach=function(b,c,d,e,g){if(!b||!this.Nf.Qd(ua(b)))b?(c={e:b,UI:c,nR:d,dE:e?"contextmenu":"mousedown",Oy:g},this.Nf.set(ua(b),c),b=c):b=k,this.Ba&&this.CC(b)};t.CC=function(b){this.g().c(b.e,b.dE,this.lH)};t.detach=function(b){(!b||!this.Nf.Qd(ua(b)))&&f(Error("Menu not attached to provided element, unable to detach."));b=ua(b);if(this.Ba){var c=this.Nf.get(b);this.g().wa(c.e,c.dE,this.lH)}this.Nf.remove(b)};
a.Tu=function(b,c,d,e,g){var h=b.S();b.qy()&&b.MV?b.hide():(b.gf=g||k,b.dispatchEvent("beforeshow")&&(d="undefined"!=typeof d?d:4,h||(b.h().style.visibility="hidden"),R(b.h(),j),c.oa(b.h(),d,e),h||(b.h().style.visibility="visible"),b.Tb(-1),b.z(j)))};t.BI=function(b,c,d){c=la(b.UI)?new bt(b.e,b.UI,j):new at(c,d);c.Qm&&c.Qm(5);Tu(this,c,b.nR,b.Oy,b.e)};t.hide=function(){this.S()&&(this.z(n),this.S()||(this.WF=za(),this.gf=k))};t.qy=function(){return this.S()||150>za()-this.WF};t.GR=function(){this.hide()};
t.lH=function(b){for(var c=this.Nf.Gb(),d=0;d<c.length;d++){var e=this.Nf.get(c[d]);if(e.e==b.currentTarget){this.BI(e,b.clientX,b.clientY);b.preventDefault();b.stopPropagation();break}}};t.WG=function(b){this.S()&&!this.Yf(b.target)&&this.hide()};t.$c=function(b){Su.m.$c.call(this,b);this.hide()};t.p=function(){Su.m.p.call(this);this.Nf&&(this.Nf.clear(),delete this.Nf)};a.Uu=function(b){kr.call(this,j,"/topic/bio/update","bio");this.bq=b[0];this.rd=["tid="+this.bq[3]];this.content=b[1];this.Bb='<a href="javascript:;" name="edit">描述你关于 '+this.bq[0]+" 的经验</a>";this.qu=j};y(Uu,kr);Uu.prototype.dj=function(){Uu.m.dj.call(this);this.Ln.innerHTML="更新"};Uu.prototype.$=function(b){Uu.m.$.call(this,b);var b=this.K(),c=b.o("strong",k,K("a",{href:"/topic/"+this.bq[1],title:this.bq[0],"class":""},this.bq[0]));b.Do(c,this.Wb)};a.Vu=function(b,c){M.call(this);this.hQ=c;this.sl=b;this.items=[];this.n0="/url_to_fetch_question_related_topic_bio_items";this.Dy=n};y(Vu,el);
a.Wu=k,a.Xu=function(){Wu||(Wu=new Vu(Fg,n));return Wu},a.Yu=function(b){if(!b.locked)if(!b.pR&&b.Dy){b.locked=j;var c=new V(j);b.g().c(c,"success",function(b){this.pR=j;this.locked=n;b=Ie(b.target);b.r||(this.sl=b.msg,Yu(this))});c.ajax("/question/"+b.TH+"/bios",k,"GET")}else b.U||(b.U=new yi,b.U.fb("修改话题经验"),Ih(b.U,k),Ch(b.U,n),c=b.U.ba(),c.innerHTML='<div class="zg-section-title">修改每个话题旁边靠近你名字的简介：</div>',b.Z(c)),b.U.z(j)};
Vu.prototype.Z=function(b){this.e=K("div","zu-bio-editor-wrap",[this.kQ=K("div","zu-bio-editor-inner-wrap"),this.Ad=K("div","zm-command",[this.Ln=K("a",{name:"save",href:"javascript:;",className:"zg-r3px zg-btn-blue"},"完成")])]);z.forEach(this.sl,function(b){b=new Uu(b);b.Z(this.kQ);this.items.push(b)},this);this.hQ&&R(this.Ad,n);b.appendChild(this.e);this.g().c(this.Ad,"click",this.ha)};
Vu.prototype.Vw=function(){var b=this.items.length,c;if(!b&&this.sl.length)for(c=0;c<this.sl.length;c++)if(this.sl[c][1])return this.sl[c][1];var d=k;for(c=0;c<b;c++)if(d=this.items[c].ib())return d};Vu.prototype.ha=function(b){if((b=this.qf(b.target))&&"save"===b.name)this.U&&this.U.z(n),this.dispatchEvent("change")};a.Zu=function(){M.call(this);this.U=k;this.qa=0;this.Gy=[];this.Os=[];this.jB="最多输入 20 字";this.bw="最多输入 256 字"};y(Zu,el);a.$u=k,a.av=function(){$u||($u=new Zu);return $u};t=Zu.prototype;t.w=function(b){b||this.Tr()};
t.o=function(){this.SD=j;this.e=K("div",k,[this.Uj=K("div",k,[this.jh=K("div","zm-favo-list-content"),this.hC=K("div","zh-favo-add-new-wrap zm-command",this.lV=K("a",{"class":"zm-favo-dialog-create zg-left",href:"javascript:;"},"+ 创建收藏夹"),this.Iv=K("a",{href:"javascript:;","class":"zg-btn-blue"},"关闭")),this.Zu=K("div","zh-favo-add-new-wrap zm-command",this.sM=K("a",{href:"javascript:;","class":""},"取消"),this.mV=K("a",{"class":"zm-favo-dialog-create zg-btn-blue",href:"javascript:;"},"创建收藏夹"))]),this.Kl=
K("div",{style:"display:none"},[K("div",k,"标题"),K("div","zg-section",this.jm=K("input",{"class":"zg-form-text-input",style:"width:97%;font-size:13px"})),K("div",k,"描述（可选）"),K("div","zg-section zg-editor-simple-wrap zg-form-text-input",this.im=K("textarea",{"class":"zg-editor-input",style:"height:66px"})),this.GT=K("label",k,[this.GQ=K("input",{type:"radio",checked:"checked",value:"public",name:"mode"}),K("strong",k," 公开 "),K("span","zg-gray-normal","公开后不能设置为私密")]),this.QQ=K("br"),this.ET=K("label",
k,[this.FQ=K("input",{type:"radio",value:"private",name:"mode"}),K("strong",k," 私密 "),K("span","zg-gray-normal","只有你可以查看这个收藏夹")]),K("div","zm-command",[this.UA=K("a",{href:"javascript:;","class":"zg-mr10"},"取消"),this.br=K("a",{href:"javascript:;","class":"zg-mr10"},"完成"),this.gC=K("a",{"class":"zg-btn-blue"},"确认创建")])])]);R(this.Zu,n);(new gp(this.jB)).n(this.jm);(new gp(this.bw)).n(this.im);z.forEach(this.Gy,function(b){bv(this,b)},this);this.Gy.length||(this.jh.innerHTML='<div id="zh-fav-list-item-place-holder" class="zg-r5px zm-fav-list-item-place-holder">你可以创建多个收藏夹，将答案分类收藏</div> ',
R(this.Zu,j),R(this.hC,n));this.U=new yi(k,n);Ih(this.U,k);this.U.ba().appendChild(this.e);this.g().c(this.U,"afterhide",function(){this.Ie()})};
a.bv=function(b,c,d){var e=H("zh-fav-list-item-place-holder");e&&R(e,n);b.Pz=c[5]?"":K("a","zm-fav-list-item-lock zg-locked");e=K("span","zm-favo-list-item-title");zc(e,c[1]);e=K("a",{"class":"zg-r5px zm-favo-list-item-link",href:"javascript:;"},[b.Pz,e,K("span",{className:"zg-gray",innerHTML:'<span class="num">'+c[3]+'</span> 条答案 <span class="zg-bull">•</span> '+c[4]+" 人关注"})]);b.Pz&&b.Pz.setAttribute("data-tip","s$b$私密收藏夹");e.setAttribute("data-lid",c[0]);z.contains(b.Os,c[0])&&D.add(e,"zm-favo-list-item-link-active");
c=J("zm-favo-list-item-link",b.jh);d&&c?lc(e,c):b.jh.appendChild(e)};t.Ea=function(){this.g().c(this.UA,"click",function(){this.qa?cv(this,0):dv(this)}).c(this.lV,"click",function(){Y.V({type:"ga_click_add_collection"});cv(this,1)}).c(this.Iv,"click",function(){dv(this)}).c(this.mV,"click",function(){Y.V({type:"ga_click_add_collection"});cv(this,1)}).c(this.sM,"click",function(){dv(this)}).c(this.br,"click",function(){dv(this)}).c(this.gC,"click",this.Bf).c(this.jh,"click",this.FS)};
t.FS=function(b){var c=Kc(b.target,"A");if(c&&!this.locked){var b=c.getAttribute("data-lid"),d=n;D.has(c,"zm-favo-list-item-link-active")?(d=j,this.vD=b):this.pD=b;c=new Hk;c.add("answer_id",this.qa);c.add("favlist_id",b);this.kA=new V(j);this.locked=j;P(this.g(),this.kA,"complete",this.iL);this.kA.ajax(d?"/collection/remove":"/collection/add",c.Lc())}};
t.iL=function(){this.locked=n;this.Iv.innerHTML="关闭";var b=Ie(this.kA);b&&!b.r?(b=Xb("zm-favo-list-item-link",this.jh),z.forEach(b,function(b){var d=b.getAttribute("data-lid"),e=J("num",b),g=parseInt(e.innerHTML,10);d===this.vD?(e.innerHTML=g-1+"",D.remove(b,"zm-favo-list-item-link-active")):d===this.pD&&(e.innerHTML=g+1+"",D.add(b,"zm-favo-list-item-link-active"))},this),this.pD=this.vD=k,Nk("Favorite","add_favorite")):U("添加失败: "+b.msg)};
t.show=function(b){this.w(b);this.Wy&&(this.U.z(j),this.Iv.innerHTML="关闭",this.qa?(R(this.br,n),cv(this,0)):(cv(this,1),R(this.UA,n),this.br.innerHTML="取消"))};
a.gv=function(b,c,d,e){var g=H("zh-fav-head-title"),h=H("zh-fav-head-description-source"),c=c||(g?Hc(g):""),d=d||(h?Hc(h):"");b.uD=e||Ig;b.SD?ev(b):b.o();b.Wy=j;b.Ea();cv(b,1);R(b.UA,n);b.br.innerHTML="取消";b.gC.innerHTML="保存";b.U.fb("编辑收藏夹");b.jm.value=Ya(c);b.im.value=Ya(d);b.uD[1]?(R(b.GT,n),R(b.ET,n),R(b.QQ,n)):b.FQ.setAttribute("checked",j);b.gQ=fv(b);b.U.z(j);b.Bs=j};t.Tr=function(){(this.qa||!this.Wy)&&$.get("/collections/json",{answer_id:this.qa}).done(v(this.tS,this))};
a.ev=function(b){var c=Xb("zm-favo-list-item-link",b.jh);z.forEach(c,function(b){var c=b.getAttribute("data-lid");D.remove(b,"zm-favo-list-item-link-active");z.contains(this.Os,+c)&&D.add(b,"zm-favo-list-item-link-active")},b)};t.tS=function(b){b&&!b.r&&(this.Gy=b.msg[0],this.Os=b.msg[1],this.SD?ev(this):this.o(),this.Wy=j,this.Ea(),this.show(j))};
a.cv=function(b,c){var d=!!c;b.U.fb(0===c?"添加到收藏夹":"创建新收藏夹");R(b.Uj,!d);R(b.Kl,d);new El(b.jm,b.jB);new El(b.im,b.bw);if(1===c)$(b.Kl).on("change.FavoDiag","input, textarea, select",function(){b.Vd()});else $(b.Kl).off("change.FavoDiag"),b.Ie()},a.fv=function(b){var c=new Hk,d=xk(b.jm.value),e=Ua(b.im.value===b.bw?"":b.im.value);e||(e=-1);c.add("title",d);c.add("description",e);c.add("is_public",b.GQ.checked?1:0);return c};
t.Bf=function(){var b=xk(this.jm.value);if(b&&b!==this.jB){b=fv(this);this.qa&&b.add("answer_id",this.qa);if(this.Bs){if(this.gQ.Lc()===b.Lc()){dv(this);return}b.add("favlist_id",this.uD[0])}this.xhr=new V(j);P(this.g(),this.xhr,"complete",this.TK);this.xhr.ajax(this.Bs?"/collection/update":"/collection/create",b.Lc())}};
t.TK=function(){var b=Ie(this.xhr);b&&!b.r?this.Bs?(dv(this),U("编辑成功"),setTimeout(function(){window.location.reload()},1E3),this.Bs=n):this.qa?(R(this.Zu,n),R(this.hC,j),cv(this,0),this.Os.push(b.msg[0]),bv(this,b.msg,j),this.jm.value="",this.im.value=""):(dv(this),U("创建成功"),setTimeout(function(){window.location.href="/collections/mine"},1E3)):U(b.msg)};t.S=function(){return this.U.S()};
a.dv=function(b){b.U.z(n);b.dispatchEvent(hv);Y.V({type:"ga_click_collect_answer",data:{count:$(".zm-favo-list-item-link-active",b.jh).length}})},a.hv="close";Zu.prototype.Vd=function(){$(window).on("beforeunload.FavoDiag",v(s("你对收藏夹的修改还未保存，确认离开该页面吗？"),this))};Zu.prototype.Ie=function(){$(window).off("beforeunload.FavoDiag")};a.iv=function(b,c){return $.post("/node/ColumnPostVoteBarV2",{method:c,params:{post_id:b}})},a.jv=function(b,c){return $.get(c?"/node/ColumnPostFullVoteInfoV2":"/node/ColumnPostVoteInfoV2",{params:{post_id:b}})};a.kv=function(b,c,d){T.call(this);this.ld=b;this.entryType=c||"answer";this.Cd=k;this.D=$.extend({},this.R,d||{})};y(kv,T);a.lv={xe:1,Hh:-1,UB:0};kv.prototype.R={cW:"up",lN:"down",IM:"count",rt:"pressed"};E.extend(kv.prototype,lv);t=kv.prototype;t.da=lv.UB;
t.n=function(b){kv.m.n.call(this,b);var c=this.D,b=this.L=$(b);this.Hu=$("."+c.cW,b);this.Bu=$("."+c.lN,b);this.EB=$("."+c.IM,b);c=this.Bu.hasClass(this.D.rt);this.Hu.hasClass(this.D.rt)?this.da=lv.xe:c&&(this.da=lv.Hh);mv(this);this.Hu.click($.proxy(this.lB,this));this.Bu.click($.proxy(this.kB,this));return this};t.be=q("da");
t.cc=function(b){if(S.Ia()){if(b!==this.da&&E.Og(lv,b)){this.dispatchEvent({type:"action",data:{state:b}});this.Cd&&"pending"===this.Cd.state()&&this.Cd.abort();var c=this.da,d=+this.EB.text(),e=0;b===lv.xe?e=1:c===lv.xe&&(e=-1);this.EB.text(d+e);this.da=b;mv(this);b={};b[lv.xe]="vote_up";b[lv.Hh]="vote_down";b[lv.UB]="vote_neutral";this.Cd=("post"===this.entryType?iv:qt)(this.ld,b[this.da]);this.Cd.done(v(function(b){b.r||this.Ve()},this))}}else c=Jk.F(),b=b===lv.xe?"question_answer_vote_up":"question_answer_vote_down",
c.Ha=b,c.z(j),c.Tc.apply(c,{question_answer_vote_up:["voteup","加入知乎，即可投「赞同」票","精彩回答值得推荐"],question_answer_vote_down:["votedown","加入知乎，即可投「反对」票","把错误的认知踩在脚下"]}[b])};t.WV=function(b){b===lv.xe?Nk("vote","voteup","side_vote"):b===lv.Hh&&Nk("vote","votedown","side_vote")};t.lB=function(){this.cc(this.da===lv.Hh?lv.xe:this.da^lv.xe)};t.kB=function(){this.cc(this.da===lv.xe?lv.Hh:this.da^lv.Hh)};
a.mv=function(b){var c=b.da,d=b.D,e=c===lv.xe,c=c===lv.Hh,g=e?"取消赞同":"赞同",h=c?"取消反对":"反对，不会显示你的姓名";b.Hu.toggleClass(d.rt,e).find(".label").text(g).end().attr("aria-pressed",e).attr("title",g);b.Bu.toggleClass(d.rt,c).find(".label").text(h).end().attr("aria-pressed",c).attr("title",h)};t.Ve=function(){this.dispatchEvent("change")};a.nv=function(b,c){this.ld=b;this.entryType=c;this.Bm=k;this.md=n};y(nv,T);t=nv.prototype;t.ac=q("md");t.La=function(b){this.md=!!b};t.Wa=function(){return this.oq.data("votecount")};t.nk=function(){this.Bm&&"pending"===this.Bm.state()||(this.Bm=("post"===this.entryType?jv:rt)(this.ld,this.md).done(v(this.Ct,this)))};t.Ct=function(b){if(b=La(b))b=$(b),this.oq.replaceWith(b),this.oq=b,this.Ea(),this.dispatchEvent("change")};t.Ea=function(){var b=this;$("a.more",this.oq).click(function(){b.La(j);b.nk()})};
t.B=function(){this.oq=$(this.e);this.Ea()};a.ov=function(){M.call(this);this.rb=[];this.aZ="";this.Dl=this.jd=k;this.wf()};y(ov,el);ia(ov);
a.pv=Pg,a.qv={"remove-question":{Sf:"删除",title:"确定要删除该问题吗？",rb:[300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,99,0]},"mute-question":{Sf:"隔离",title:"确定要隔离该问题吗？",rb:[130,131,132,0]},"unmute-question":{Sf:"解除隔离",title:"确定要解除隔离该问题吗？",rb:[0]},"lock-question":{Sf:"锁定",title:"确定要锁定该问题吗？",rb:[140]},"unlock-question":{Sf:"解除锁定",title:"确定要解除锁定该问题吗？",rb:[0]},"remove-answer":{Sf:"删除",title:"确定要删除该答案吗？",rb:[300,301,302,303,304,305,99,0]},"collapse-answer":{Sf:"折叠",title:"确定要折叠该答案吗？",rb:[220,
221,222,223,224,225]},"uncollapse-answer":{Sf:"解除折叠",title:"确定要解除折叠该答案吗？",rb:[0]},"remove-comment":{Sf:"删除",title:"确定要删除该评论吗？",rb:[300,301,302,303,304,305,99,0]},"remove-image":{Sf:"删除",title:"确定要删除该图片吗？",rb:[180,181,182,183,184]},"remove-video":{Sf:"删除",title:"确定要删除该视频吗？",rb:[200,201,202,203,204]}},a.rv={"delete":'<span class="zg-gray-normal">删除后将私信通知作者并备份该内容</span>'},a.sv=function(b,c,d){var e=new V(j);e.addEventListener("success",function(b){b=Ie(b.target);if(b.r)U(b.msg);else{var c=b.msg;if(c){if(c.refresh){setTimeout(function(){window.location.reload()},
2E3);return}if(c.redirect){window.location.href=c.redirect;return}}U("操作成功！");d&&d(b)}});e.ajax(b,c)};t=ov.prototype;t.wf=function(){this.o();this.Ea()};
t.o=function(){var b=K("div",{style:"min-height:80px;padding:15px 0 0 0"},[this.G_=K("div","zg-section",[this.lk=K("select",{style:"min-width: 250px; max-width: 100%;"}),this.$n=K("label",{className:"zg-error-text",style:"display:none;margin-left:.5em;white-space: nowrap;"},"请填写修改理由")]),this.$u=K("div"),this.mR=K("div",{"class":"zg-gray-normal"}),this.OH=K("div",{"class":"zg-form-text-input",style:"display:none"},this.ph=K("textarea",{style:"width:100%"}))]);this.jd=new yi;Ch(this.jd,j);Ih(this.jd,
Kh);this.jd.ba().appendChild(b)};t.Ea=function(){this.g().c(this.ph,["change","input"],function(){R(this.$n,!La(this.ph.value))}).c(this.lk,"change",this.hP).c(this.jd,Gh,this.Bx).c(this.jd,Jh,function(b){if("ok"===b.key)return this.Bj();if(b.key===Lh)return this.po()})};t.Bx=function(){this.Dl=this.rr=k;tv(this)};t.po=function(){this.ea&&this.ea.Hb()&&this.ea.abort();this.jd.z(n);this.dispatchEvent("cancel")};
t.Bj=function(){if(this.ea&&this.ea.Hb())return n;var b="0"===this.lk.value,c=this.ph.value;if(this.rr&&this.lk){if(b&&!c)return R(this.$n,j),this.ph.focus(),n;R(this.$n,n);var d=this.rr.getAttribute("data-action"),e=this.rr.getAttribute("data-content");e&&this.Ru&&(e=e+"&"+this.Ru);e=new fj(e||this.Ru);e.add("reason",this.lk.value);b&&e.add("detail",c);sv(d,e.toString(),v(this.jP,this))}};t.jP=function(b){this.jd.z(n);this.pb&&this.pb(b)};t.z=function(b){this.jd.z(b)};
a.tv=function(b){b.ph.value="";b.lk.innerHTML="";b.$u.innerHTML="";R(b.$n,n)},a.vv=function(b,c,d,e,g){tv(b);b.pb=d;b.Ru=g;b.rr=c;(c=qv[c.getAttribute("data-op")])?(b.jd.fb(c.title),zc(b.jd.uc.Yc("ok"),c.Sf||"确定"),c=c.rb,R(b.OH,1===c.length&&0===c[0]),e="delete"===e||z.contains(c,99),b.$u.innerHTML=e?rv["delete"]:"",z.forEach(c,function(b){this.lk.appendChild(K("option",{value:b},pv[+b]))},b),uv(b,Number(b.lk.firstChild.value))):Mk("no op code!")},a.uv=function(b,c){var d=b.mR;b.Dl&&z.contains([300,
301,302],c)?$.post("/manage",$.extend({action:"get_member_info",reason:c},b.Dl)).done(function(b){d.innerHTML="用户已被警告 "+b.warn_num+" 次，禁言 "+b.ban_num+" 次"}):d.innerHTML=""};t.hP=function(b){var b=Number(b.target.value),c=0===b,d=99===b;R(this.OH,c);c||R(this.$n,n);uv(this,b);R(this.$u,!d);return j};a.wv=function(){M.call(this);this.jc=this.Cq()};y(wv,Hd);t=wv.prototype;t.C=k;t.IL=j;t.Pb=le("goog.editor.Plugin");t.lJ=function(){this.C&&(this.disable(this.C),this.C=k)};t.enable=function(b){this.C==b?this.jc=j:this.Pb.log(ce,"Trying to enable an unregistered field with this plugin.",i)};t.disable=function(b){this.C==b?this.jc=n:this.Pb.log(ce,"Trying to disable an unregistered field with this plugin.",i)};t.isEnabled=function(b){return this.C==b?this.jc:n};t.Cq=mf;t.JQ=mf;
t.p=function(){this.C&&this.lJ(this.C);wv.m.p.call(this)};a.xv=E.an({Ex:1,MO:2,Zr:3,Dj:4,$r:5,execCommand:6,queryCommandValue:7,CH:8,nM:10,mM:11}),a.yv=E.Wh(8,10,11);wv.prototype.execCommand=function(b,c){var d=this.JQ(b);d||(B&&zv(this.C,j,j),this.C.Xh());try{var e=this.of.apply(this,arguments)}finally{d||(this.C.kf(),Av(this.C))}return e};wv.prototype.Se=s(n);a.Bv=function(b,c,d,e,g){this.hE=b;this.PA=c;this.Sq=d;this.mE=e;this.Hw=g||{}},a.Cv=function(b,c){this.zW=b;this.nD=c},a.Dv=function(b,c,d,e){var g=[];b.Sq&&b.PA&&g.push("<!DOCTYPE HTML>");g.push('<html style="background:none transparent;min-width:0;');b.Sq&&g.push("height:",b.mE?"100%":"auto");g.push('">');g.push("<head><style>");d&&d.nD&&g.push(d.nD);B&&b.PA&&g.push(" img {-moz-force-broken-image-icon: 1;}");g.push("</style></head>");g.push('<body g_editable="true" hidefocus="true" ');Ms&&g.push("contentEditable ");
g.push('class="editable ');g.push('" id="',b.hE,'" style="min-width:0;');B&&b.Sq&&(g.push(";width:100%;border:0;margin:0;background:none transparent;",";height:",b.PA?"100%":"auto"),b.mE?g.push(";overflow:auto"):g.push(";overflow-y:hidden;overflow-x:auto"));tb&&g.push(";outline:hidden");for(var h in b.Hw)g.push(";"+h+":"+b.Hw[h]);g.push('">',c,"</body></html>");b=g.join("");e=e.contentDocument||e.contentWindow.document;e.open();e.write(b);e.close()};a.Kv=function(b,c){M.call(this);this.bh=this.id=b;this.lb=k;this.sd={};this.Kj={};for(var d in xv)this.Kj[d]=[];this.pl="";this.Ek={};this.Ek[Ev]=1;this.Ek[Fv]=1;this.my=this.Ds=n;this.ur=new yj(this.ND,Gv,this);this.sr={};for(var e in Hv)this.sr[Hv[e]]=0;B&&(this.Ce=new yj(this.qo,Iv,this));this.kc=new me(this);this.AW=[];this.Wj=Jv;this.vm=Ub(c||document);this.Pc=this.vm.h(this.id);this.el=this.vm.Ta()};y(Kv,Hd);Kv.prototype.field=k;Kv.prototype.Pc=k;Kv.prototype.Pb=le("goog.editor.Field");
a.Ev="change",a.Fv="delayedchange",a.Hv={YW:"cvc",OX:"load",XY:"unload",PW:"beforechange",WW:Ev,cX:Fv,QW:"beforefocus",lX:"focus",SW:"blur",RW:"beforetab",BX:"ifrsz",AY:"selectionchange"},a.Jv=0,a.Lv=k;t=Kv.prototype;t.dh=n;t.sJ=n;t.tu=n;t.h=q("field");t.addListener=function(b,c,d,e){var g=this.h();vq&&(g&&this.rc())&&(g=g.ownerDocument);this.kc.c(g,b,c,d,e)};t.vj=function(b){return this.sd[b]};a.Iv=15,a.Gv=250;Kv.prototype.rc=nf;Kv.prototype.Ho=nf;Kv.prototype.zI=mf;a.Mv={46:j,8:j};A||(Mv[9]=j);
a.Nv={86:j,88:j};A&&(Mv[229]=j);a.Ov=function(b){var c=!(b.ctrlKey||b.metaKey)&&b.keyCode in Mv;return(b.ctrlKey||b.metaKey)&&b.keyCode in Nv||c},a.Pv=function(b,c){b.Wj=2;b.field=c;b.lb=Ub(c);b.Ds=n;b.my=n;c.setAttribute("g_editable","true")};
Kv.prototype.Hv=function(){this.kc&&this.kc.Qc();if((ii||ji)&&this.rc()&&this.zI()){try{var b=this.lb.Ta();b.removeEventListener("keydown",this.Bn,n);b.removeEventListener("touchend",this.Bn,n)}catch(c){}delete this.Bn}if(tb&&this.rc()){try{b=this.lb.Ta(),b.removeEventListener("focus",this.vv,n),b.removeEventListener("blur",this.uv,n)}catch(d){}delete this.vv;delete this.uv}this.Ce&&this.Ce.stop();this.ur.stop()};
Kv.prototype.p=function(){(1==this.Wj||this.fe())&&this.Pb.Ok("Disposing a field that is in use.");this.Pc&&this.execCommand("clearlorem");this.Wj=Jv;for(var b in this.sd){var c=this.sd[b];c.Cq()||c.disable(this)}this.lb=this.field=k;this.Hv();this.Gl&&(Ad(this.Gl),this.Gl=k);this.vm=k;this.kc&&(this.kc.G(),this.kc=k);for(;b=this.AW.pop();)b.G();Lv==this.id&&(Lv=k);for(var d in this.sd)b=this.sd[d],b.IL&&b.G();delete this.sd;Kv.m.p.call(this)};
a.Qv=["DOMNodeInserted","DOMNodeRemoved","DOMNodeRemovedFromDocument","DOMNodeInsertedIntoDocument","DOMCharacterDataModified"];Kv.prototype.wA=function(){if(sq||!this.rc())this.kc.c(this.h(),"DOMSubtreeModified",this.Fx);else{var b=this.lb.xa();this.kc.c(b,Qv,this.Fx,j);this.kc.c(b,"DOMAttrModified",v(this.GE,this,this.Fx),j)}};
a.Rv=function(b,c){if(9==c.keyCode&&!b.dispatchEvent({type:"beforetab",shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.ctrlKey})||B&&c.metaKey&&(37==c.keyCode||39==c.keyCode))return c.preventDefault(),n;var d;if(!(d=c.charCode))d=Ov(c)?j:!(!B||c.ctrlKey||c.metaKey||B&&!c.charCode);b.nx=d;b.nx&&b.Xh();return j},a.Sv={8:1,9:1,13:1,33:1,34:1,35:1,36:1,37:1,38:1,39:1,40:1,46:1},a.Tv={65:j,86:j,88:j},a.Uv={8:1,9:1,13:1,27:1,33:1,34:1,37:1,38:1,39:1,40:1};t=Kv.prototype;
t.Fo=function(b,c){for(var d=this.Kj[b],e=z.slice(arguments,1),g=0;g<d.length;++g){var h=d[g];if((h.isEnabled(this)||yv[b])&&h[xv[b]].apply(h,e))return j}return n};t.vQ=function(b,c){for(var d=this.Kj[b],e=z.slice(arguments,1),g=0;g<d.length;++g){var h=d[g];(h.isEnabled(this)||yv[b])&&h[xv[b]].apply(h,e)}};t.xt=function(b,c,d){for(var e=this.Kj[b],g=z.slice(arguments,1),h=0;h<e.length;++h){var l=e[h];if(l.isEnabled(this)||yv[b])g[0]=l[xv[b]].apply(l,g)}return g[0]};
a.Vv=function(b,c,d){var e={},b=b.xt(8,c||"",e);Tf(d,e);d.innerHTML=b};t.tf=function(b){(B||Rv(this,b))&&!this.Fo(1,b)&&Cq&&Wv(this,b)};t.NO=function(b){if(B){if(!Rv(this,b))return}else this.nx=j,this.Xh();!this.Fo(2,b)&&!Cq&&Wv(this,b)};t.OO=function(b){!B&&(this.nx||Ov(b))&&this.qo();this.Fo(3,b);Xv(this,"selectionchange")||(Sv[b.keyCode]||(b.ctrlKey||b.metaKey)&&Tv[b.keyCode])&&this.rI.start()};
a.Wv=function(b,c){if(!c.altKey){var d=mb?c.metaKey:c.ctrlKey;if(d||Uv[c.keyCode]){var e=c.charCode||c.keyCode;17!=e&&b.Fo(5,c,String.fromCharCode(e).toLowerCase(),d)&&c.preventDefault()}}};t.execCommand=function(b,c){for(var d=arguments,e,g=this.Kj[6],h=0;h<g.length;++h){var l=g[h];if(l.isEnabled(this)&&l.Se(b)){e=l.execCommand.apply(l,d);break}}return e};
t.queryCommandValue=function(b){var c=this.fe()&&this.Re;if(oa(b))return this.ut(b,c);for(var d={},e=0;e<b.length;e++)d[b[e]]=this.ut(b[e],c);return d};t.ut=function(b,c){for(var d=this.Kj[7],e=0;e<d.length;++e){var g=d[e];if(g.isEnabled(this)&&g.Se(b)&&(c||g.Cq()))return g.queryCommandValue(b)}return c?k:n};t.GE=function(b,c){if(!Xv(this,Ev)){var d=c.Zb;try{if(d.originalTarget.prefix||"scrollbar"==d.originalTarget.nodeName)return}catch(e){return}d.prevValue!=d.newValue&&b.call(this,d)}};
t.Fx=function(b){Xv(this,Ev)||(b=b.vE?b.Zb:b,b.target.firebugIgnore||(this.my=this.Ds=j,this.Ce.start()))};t.Xr=function(){A&&this.execCommand("clearlorem",j);B&&this.hw();this.kf()};a.Yv=function(b){var c;return b.rc()&&(c=b.lb)?(b=c.Ta())&&b.frameElement:k},a.Zv=function(b){return(b=b.lb&&b.lb.Ta())&&lq(b)},a.Av=function(b,c,d){if(!Xv(b,"selectionchange")){var e=Zv(b),e=e&&e.Eb();b.Re=!!e&&uc(b.h(),e);b.dispatchEvent("cvc");b.dispatchEvent({type:"selectionchange",J_:c&&c.type});b.Fo(4,c,d)}};
t.iP=function(){var b=this.qI;this.qI=k;Av(this,i,b)};t.Xh=function(){Xv(this,"beforechange")||this.dispatchEvent("beforechange")};a.zv=function(b,c,d){c&&(b.Ce&&es(b.Ce),b.Ek[Ev]=1);d&&($v(b),b.Ek[Fv]=1)},a.aw=function(b,c,d){!c&&b.Ce&&es(b.Ce);b.Ek[Ev]=0;b.Ek[Fv]=0;c&&b.qo();d&&b.ND()},a.Xv=function(b,c){return!!b.Ek[c]||b.sr[c]&&500>=za()-b.sr[c]};t.kf=function(b){aw(this,j,b)};t.qo=function(){Xv(this,Ev)||(this.Ce&&this.Ce.stop(),this.my=this.Ds=j,Xv(this,Fv)||this.ur.start())};
t.ND=function(){Xv(this,Fv)||(this.ur.stop(),this.Ds=n,this.dispatchEvent(Fv))};a.$v=function(b){b.Ce&&es(b.Ce);es(b.ur)};t.hw=function(){this.MD();this.OD()};t.MD=function(){Xv(this,"beforefocus")||(this.execCommand("clearlorem",j),this.dispatchEvent("beforefocus"))};t.OD=function(){if(!Xv(this,"focus")){Lv=this.id;this.Re=j;this.dispatchEvent("focus");if(B){var b=this.h(),c=Zv(this);if(c){var d=yp(c);0==zp(c)&&(!d||d==b||"BODY"==d.tagName)&&Ks(b)}}!tq&&this.rc()&&this.lb.Ta().parent.getSelection().removeAllRanges()}};
t.yr=function(){Xv(this,"blur")||(Lv==this.id&&(Lv=k),this.Re=n,this.dispatchEvent("blur"))};a.bw=function(b){Kc(b.target,"A")&&b.preventDefault()};t.zj=function(b){Lv=this.id;if(A){var c=b.target;c&&("A"==c.tagName&&b.ctrlKey)&&this.vm.Ta().open(c.href)}this.tu=j};t.wx=function(){this.tu=n};t.OE=function(b){if(!this.sJ||this.tu)this.tu=n,Av(this,b),A&&(this.qI=b.target,this.rI.start())};t.UO=function(b){Av(this,b)};
t.Ll=function(){if(this.queryCommandValue("usinglorem"))return" ";if(!this.fe()){var b=this.Pc;b||this.Pb.log(be,"Couldn't get the field element to read the contents",i);return b.innerHTML}var c=this.h(),b=c.cloneNode(n),c=c.innerHTML;A&&c.match(/^\s*<script/i)&&(c=" "+c);b.innerHTML=c;this.vQ(11,b);return this.xt(10,b.innerHTML)};
t.oe=function(b,c,d,e){if(1==this.Wj)this.Pb.log(ce,"Can't set html while loading Trogedit",i);else{e&&this.execCommand("clearlorem");c&&b&&(c="<p>"+c+"</p>");d&&zv(this,n,j);b=c;if(c=this.h()){if(this.rc()&&C)for(var g=c.ownerDocument.getElementsByTagName("HEAD"),h=g.length-1;1<=h;--h)g[h].parentNode.removeChild(g[h])}else c=this.Pc;c&&Vv(this,b,c);e&&this.execCommand("updatelorem");this.fe()&&(d?(B&&es(this.Ce),aw(this)):this.kf())}};
t.qB=function(){var b=this.lb.xa();b.designMode="on";yq&&b.execCommand("styleWithCSS",n,n)};t.DF=function(){this.pl&&cw(this)&&Bt(this.pl,this.h())};t.fe=function(){return 2==this.Wj};t.focus=function(){if(!Ms&&this.rc())this.lb.Ta().focus();else{if(tb)var b=this.el.pageXOffset,c=this.el.pageYOffset;this.h().focus();tb&&this.el.scrollTo(b,c)}};t.jg=function(){(qq||C)&&dw(this);this.focus()};a.dw=function(b){var c=b.h();if(c){var d=ys(c);c==d?nq(c,0).select():as(d,j);Av(b)}};
t.ie=function(b){this.Wj=1;var c=this.Pc;this.nodeName=c.nodeName;this.Z_=c.className;this.cssText=c.style.cssText;c.className+=" editable";this.My(b)};t.My=function(b){var c=this.Pc;if(c){var c=c.innerHTML,d={},c=this.xt(8,c,d),e=this.vm.o("IFRAME",this.BE());if(cw(this)){var g=v(this.lF,this,e,c,d);this.Gl=N(e,"load",g,j);b&&(e.src=b)}this.DC(e);cw(this)||this.lF(e,c,d)}};
t.Yr=function(){A&&Ns(this.lb.Ta());Lv!=this.id&&this.execCommand("updatelorem");if((ii||ji)&&this.rc()&&this.zI()){var b=this.lb.Ta();this.Bn=v(b.focus,b);b.addEventListener("keydown",this.Bn,n);b.addEventListener("touchend",this.Bn,n)}tb&&this.rc()?(this.vv=v(this.hw,this),this.uv=v(this.yr,this),b=this.lb.Ta(),b.addEventListener("focus",this.vv,n),b.addEventListener("blur",this.uv,n)):(Bq?(this.addListener("focus",this.OD),this.addListener(kd,this.MD)):this.addListener("focus",this.hw),this.addListener("blur",
this.yr,B));if(B)this.wA();else{this.addListener(["beforecut","beforepaste","drop","dragend"],this.Xh);var c=this.kf,d;d=d||0;this.addListener(["cut","paste"],function(){return c.apply(this,Array.prototype.slice.call(arguments,0,d))});this.addListener("drop",this.Xr)}this.addListener(C?"dragend":"dragdrop",this.Xr);this.addListener("keydown",this.tf);this.addListener("keypress",this.NO);this.addListener("keyup",this.OO);this.rI=new yj(this.iP,250,this);zq&&this.addListener("click",bw);this.addListener("mousedown",
this.zj);this.sJ?(this.kc.c(this.lb.xa(),"mouseup",this.OE),this.addListener("dragstart",this.wx)):this.addListener("mouseup",this.OE);this.addListener("mouseover",this.UO);this.DF();aw(this);this.Pb.info("Dispatching load "+this.id);this.dispatchEvent("load");for(var e in this.sd)this.sd[e].enable(this)};a.cw=function(b){if(!la(b.py)&&(b.py=n,A&&b.rc())){for(var c=b.vm.Ta();c!=c.parent;)try{c=c.parent}catch(d){break}c=c.location;b.py="https:"==c.protocol&&-1==c.search.indexOf("nocheckhttps")}return b.py};
t.DC=function(b){var c=this.Pc;b.className=c.className;b.id=c.id;oc(b,c)};t.Zw=function(b){var c=Mc(Ub(this.Pc));return new Bv(this.id,c,n,n,b)};t.FJ=function(b,c,d){d=this.Zw(d);cw(this)?(b=(b.contentDocument||b.contentWindow.document).body,Ms&&(b.contentEditable=j),b.className="editable",b.setAttribute("g_editable",j),b.hideFocus=j,b.id=d.hE,Tf(b,d.Hw),b.innerHTML=c):Dv(d,c,new Cv(this.h(),this.pl),b)};
t.lF=function(b,c,d){this.Gl&&(Ad(this.Gl),this.Gl=k);b.bZ="true";this.FJ(b,c,d);Pv(this,(b.contentDocument||b.contentWindow.document).body);!Ms&&this.rc()&&this.qB();this.Yr()};t.BE=function(){var b="padding:0;"+this.Pc.style.cssText;Js(b,";")||(b+=";");b+="background-color:white;";A&&(b+="overflow:visible;");return{frameBorder:0,style:b}};a.ew=function(b){T.call(this);this.sb=b;this.LZ=this.sb.Qr();this.Lr=this.sb.Ed?this.sb.Na:this.sb.Na.h();this.isContentEditable=this.sb.isContentEditable();this.GV=30;this.Bc=new Jd(1E3*this.GV);this.Y=Eg?Eg.Y:0};y(ew,T);t=ew.prototype;t.p=function(){fw(this);this.Bc.G();ew.m.p.call(this)};
t.n=function(b){this.e=b;this.Lj=J("draft-saved-info",b);R(this.Lj,n);this.Zx=J("draft-saved-time",b);this.pM=J("draft-clear-button",b);this.xZ=this.isContentEditable?Fv:["change","input"];b=this.g().c(this.Bc,Kd,this.eA).c(this.pM,"click",this.qM).c(this.Lr,"keydown",this.PQ);"oninput"in this.Lr&&!A?b.c(this.Lr,"input",this.mQ):b.c(this.Lr,"keydown",this.nQ);var c=Kg&&1E3*Kg[1];c&&(gw(this,c),this.iB=setInterval(v(function(){gw(this,c)},this),22E3))};
t.PQ=function(b){if((b.metaKey||b.ctrlKey)&&"s"===dk[b.keyCode])this.bR(),this.isContentEditable||b.preventDefault()};a.hw=function(b){R(b.Lj,j);zc(b.Zx,"保存中…");b.lQ()};t.mQ=function(){hw(this)};t.nQ=function(b){Ug(b.keyCode)&&hw(this)};t.SA=function(){this.Bc.start()};t.WA=function(){this.Bc.stop()};t.Oa=function(b){this.sb.Oa(b);this.sb.Fp()};t.ib=function(){return this.sb.kg()};
t.gI=function(){if(!this.ag){var b=this.ib();b&&(b=(new fj).add("qid",this.Y).add("content",b),Ei("/answer/draft/save",k,"POST",b.toString()),this.Bf())}};t.tW=150;t.eA=Vk(ew.prototype.tW,ew.prototype.gI);t.cR=350;t.bR=Vk(ew.prototype.cR,ew.prototype.gI);t.oQ=3E3;t.lQ=Vk(ew.prototype.oQ,function(){this.ag||(this.ib()?this.eA():iw(this))});a.fw=function(b){b.iB&&(clearInterval(b.iB),b.iB=k)};t.Bf=function(){fw(this);R(this.Lj,j);R(this.Lj,j);zc(this.Zx,"已保存");this.dispatchEvent("saveContent")};
a.gw=function(b,c){var d=gt(c||za());/^\d/.test(d)&&(d=" "+d);d="已存于"+d;R(b.Lj,j);zc(b.Zx,d)};t.qM=function(b){b.preventDefault();Ci("清除草稿","你确定要清除保存的草稿吗？",function(b){b&&(this.Oa(""),iw(this),this.sb.ready(function(){var b=this.Na;this.Ed?cs(b,b.value.length):b.field.lastChild?as(b.field.lastChild):b.jg();this.Al&&(this.Al.scrollTop=this.Al.scrollHeight)}))},this)};a.iw=function(b){Ei("/answer/draft/delete",k,"POST","qid="+b.Y);fw(b);R(b.Lj,n);b.dispatchEvent("clearContent")};a.jw=function(b,c,d){nr.call(this,n);this.mb=!!b;this.tJ=c;this.Bb="&nbsp;";this.An=d;this.pu=this.tw=this.rE=this.enabled=j;if(S.ye||!S.Ia())this.Ly='<span style="font-style: normal;color: #999;">写回答…</span>'};y(jw,nr);t=jw.prototype;t.AE=function(){var b=Wb("h2","zm-editable-content",H("zh-question-title"))[0];return{title:b&&(/answer\/\d+$/.test(location.pathname)?Hc(b):b.firstChild.nodeValue)||"",Lk:this.oj}};t.Vw=q("An");t.Bp=ca("mb");
t.Ot=function(b){this.An=b?b:S[4];this.li&&$.trim(b)&&(b=Za(b,20),this.SL.innerHTML="，"+Ua(b)+'<a name="edit_bio" class="zu-edit-button" href="javascript:;"><i class="zu-edit-button-icon"></i>修改话题经验</a>')};t.eb=function(b,c){this.enabled=b;this.li?(this.vh(),this.Bb=c,this.Wb.innerHTML=this.Bb):c&&(this.Bb=c)};t.$=function(b){jw.m.$.call(this,b);this.li=j;D.add(this.Wb,"zu-answer-form-disabled-wrap")};t.p=function(){this.us&&(L(this.us),this.uJ=this.us=k);jw.m.p.call(this)};
t.yj=function(b){this.Bp(b.mb);this.Jq&&(this.Jq.checked=b.mb)};t.B=function(){jw.m.B.call(this);this.g().c(Ki,"anon_change",this.yj)};
t.Sg=function(){jw.m.Sg.call(this);var b=this.K(),c=S.Ia();this.us=b.o("div","zh-answer-form clearfix",[c?kt(this.tJ):"",this.uJ=b.o("div",k,[b.o("div","zu-answer-form-title",[c?jt(this.tJ):"我来回答这个问题",this.SL=b.o("span")])])]);this.Ot(this.An);b.Do(this.us,this.oj);this.g().c(this.uJ,"click",this.ha);S.Ia()||kw(this,'<div class="signin-mask-tip-answer"></div>','<div class="zm-command"><a class="zg-r3px zg-btn-blue" href="javascript:;">我要回答</a></div>',function(b,c){function g(){Jk.F().z(j);Jk.F().Ha=
"question_answer_add_start";Jk.F().Tc("answer","加入知乎，即可回答该问题","你的知识、经验和见解可以帮助别人")}b.on("click",g);c.on("click",g)});S.Ia()&&!S.ye&&kw(this,'<div class="active-mask-tip-answer">为正常使用知乎提问、回答、评论和编辑功能，请验证您的邮箱、激活帐号。</div>','<div class="zm-command"><a class="zg-r3px zg-btn-blue" href="javascript:;">我要激活</a></div>',function(b,c){function g(){zl.F().z(j)}b.on("click",g);c.on("click",g)})};
a.kw=function(b,c,d,e){c=$(c).css("top",0).css("z-index",9);$(b.Ad).hide();d=$(d);$(b.oj).append(c).after(d);e&&e.call(b,c,d)};
t.Wl=function(b){switch(b){case "edit_bio":b=Xu();if(!this.sv){var c=Eg.Xb;b.Dy=j;b.TH=c;this.g().c(b,"change",this.iz)}this.sv=j;Yu(b);break;case "cancel_delete":this.dispatchEvent("cancel_delete_answer");break;case "answer_my_question":var d=this;this.Tk?this.Tk.show():(d.Tk=$('<div class="question-tip-box-bottom">确定想要回答你自己提出的问题吗？<br>如果需要对问题做出更多的解释和说明，请编辑问题描述。 如果需要对其他回答做出回应，请在相应回答下通过评论发布。<br><div class="zg-clear"><a href="javascript:;" class="zg-right zg-btn zg-btn-blue" name="confirm">确定</a><a href="javascript:;" class="zg-right zg-link-gray " name="cancel">取消</a></div></div>'),d.Tk.on("click",
'[name="cancel"]',function(){d.Tk.hide()}).on("click",'[name="confirm"]',function(){d.Tk.hide();$(d.Wb).hide();d.eb(j);d.vd()}),$(d.Wb).after(d.Tk))}return j};t.De=function(){"editing"===this.status?this.Nb&&R(this.Nb,j):this.Nb&&R(this.Nb,n);R(this.Bd,n);this.Wb&&R(this.Wb,!this.enabled)};t.xM='<div class="zm-command clearfix"><div class="draft-controls zg-left"><span class="draft-saved-info"><a class="draft-clear-button goog-inline-block" href="#" data-tip="s$b$删除草稿"><i class="zg-icon zg-icon-bin"></i><span class="hide-text">清除草稿</span></a><span class="draft-saved-time"></span></span></div><% if (questionStatus !== "normal") { %><span class="zg-gray-normal" style="margin-right:5px;">被<%= statusText %>的问题不允许添加新的回答</span><a class="zg-right" data-tip="s$b$为什么部分问题会被「关闭」「建议修改」？" href="//www.zhihu.com/question/21290061 "><i class="zg-icon zg-icon-question-mark"></i></a><% } %><span class="<%= (questionStatus !== "normal" ? "hidden" : "") %>"><label style="cursor:pointer"><input name="anno-checkbox" type="checkbox">匿名</label> <a class="submit-button zg-btn-blue" name="save" href="javascript:;">发布回答</a></span></div>';
t.dj=function(){var b=Pk(this.xM);this.Ad=hc(b({questionStatus:Eg.status,statusText:{suggest:"建议修改",evaluate:"建议修改",close:"关闭"}[Eg.status]}));this.Ln=$(".submit-button",this.Ad)[0];var b=$("input[name=anno-checkbox]",this.Ad)[0],c=$("label",this.Ad)[0];this.Jq=b;Eg.mb&&(this.Jq.checked=j);tg(c,j);this.Nb.appendChild(this.Ad);this.ready(function(){if(this.Na&&this.Na.on)this.Na.on("load",this.bQ,n,this)})};
t.bQ=function(){var b=new ew(this);Tc(this,b);this.g().c(b,"saveContent",function(){var b=!this.Ed&&this.Na.vj("FullScreenPlugin");if(b&&b.$p){var c=$(b.$p);c.stop().text("草稿已经保存").fadeTo(600,0.5).delay(3E3).fadeOut(600,function(){c.text("")})}},n,this);var c=this.Ed?this.Na:this.Na.h();this.g().c(c,"focus",function(){b.SA()}).c(c,"blur",function(){b.WA();b.eA()});b.n(this.Ad)};t.iz=function(){var b=Xu().Vw();b&&this.Ot(b)};a.lw=function(b){var c=k;try{c=b.rules||b.cssRules}catch(d){15==d.code&&(d.styleSheet=b,f(d))}return c},a.mw=function(b){var c=[],b=b||document.styleSheets,d=la(i)?i:n;if(b.imports&&b.imports.length)for(var e=0,g=b.imports.length;e<g;e++)z.extend(c,mw(b.imports[e]));else if(b.length){e=0;for(g=b.length;e<g;e++)z.extend(c,mw(b[e]))}else{var h=lw(b);if(h&&h.length)for(var e=0,g=h.length,l;e<g;e++)l=h[e],l.styleSheet&&z.extend(c,mw(l.styleSheet))}(b.type||b.rules||b.cssRules)&&(!b.disabled||d)&&c.push(b);
return c};a.nw=/a(:(link|visited|active|hover))?/,a.ow=function(){this.Tn="";this.rh=[]};ow.prototype.clone=function(){var b=new ow;b.rh=this.rh.concat();b.Tn=this.Tn;return b};
a.pw=function(b,c,d){var e=[],g;for(g in c){var h=c[g];h&&e.push(g,":",h,d?" !important":"",";")}b.Tn=e.join("")},a.qw=/(^|;|{)\s*color:([^;]+);/g,a.sw=function(b){this.Hz=[];this.iv={};if(b){for(var c=[],b=b.split(/\s+/gm),d=0;d<b.length;d++)if(b[d]){var e=new rw(b[d]);c.push(e)}this.wi=c}},a.rw=function(b){var c=tw[b];if(c)return c;for(var c=b.match(/[#\.]/)?b.split(/(?=[#\.])/):[b],d={},e=0;e<c.length;e++){var g=c[e];"."==g.charAt(0)?d.className=g.substring(1,g.length):"#"==g.charAt(0)?d.id=g.substring(1,
g.length):d.tagName=g.toUpperCase()}this.BF=b;this.hR=d;this.VI={};tw[b]=this},a.tw={},a.uw=function(b,c){var d=c.uid,e=b.VI[d];if("undefined"!=typeof e)return e;var g=b.hR,e=g.tagName,h=g.className,g=g.id,l=j;e&&"*"!=e&&e!=c.nodeName?l=n:g&&g!=c.id?l=n:h&&!c.lM[h]&&(l=n);return b.VI[d]=l},a.ww=function(b){var c=ua(b),d=vw[c];if(d)return d;d=[];do{var e={id:b.id,nodeName:b.nodeName};e.uid=ua(e);var g={};if(b.className)for(var h=D.get(b),l=0;l<h.length;l++)g[h[l]]=1;e.lM=g;d.unshift(e)}while(b=b.parentNode);
this.PG=d;this.uid=ua(this);vw[c]=this},a.vw={},a.xw={},a.yw="color visibility quotes list-style-type list-style-image list-style-position list-style page-break-inside orphans widows font-family font-style font-variant font-weight text-indent text-align text-transform white-space caption-side border-collapse border-spacing empty-cells cursor".split(" "),a.zw="font-family font-size font-weight font-variant font-style color text-align text-decoration text-indent text-transform letter-spacing white-space word-spacing".split(" ");a.Aw=function(b,c){Kv.call(this,b,c)},a.Bw=void 0;y(Aw,Kv);t=Aw.prototype;t.Pb=le("goog.editor.SeamlessField");t.JF=n;t.AQ=n;t.Ho=q("JF");t.RE=function(){Xv(this,Ev)||Cw(this)};
t.NA=function(){if(this.Pp?0:this.Pp=j){var b=n,c=Yv(this);if(c){var d,e=Yv(this),g=e.contentDocument.body;d=g.parentNode;0===parseInt(Ct(e,"height"),10)&&Tf(e,"height","1px");if(Mc(Ub(g)))e=d.offsetHeight;else if(e=d.scrollHeight,d.clientHeight!=d.offsetHeight){d=e;if(!(e=Bw))e=document.createElement("div"),e.style.cssText="overflow:auto;position:absolute;top:0;width:100px;height:100px",g=document.createElement("div"),mg(g,"200px","200px"),e.appendChild(g),document.body.appendChild(e),g=e.offsetWidth-
e.clientWidth,L(e),e=Bw=g;e=d+e}d=e;this.qR&&(d=Math.max(d,this.qR));parseInt(Ct(c,"height"),10)!=d&&(c.style.height=d+"px",b=j)}this.Pp=n;b&&this.dispatchEvent("ifrsz")}};
a.Cw=function(b){if(b.Pp?0:b.Pp=j){var c=Yv(b),d=b.h(),e=n;if(c&&d){var g,h=c.parentNode,l=h.offsetWidth;parseInt(Ct(c,"width"),10)!=l&&(g=xg(d),c.style.width=l+"px",d.style.width=l-g.left-g.right+"px",e=j);h=h.offsetHeight;b.Ho()&&parseInt(Ct(c,"height"),10)!=h&&(g||(g=xg(d)),c.style.height=h+"px",d.style.height=h-g.top-g.bottom+"px",e=j)}b.Pp=n;e&&b.dispatchEvent("ifrsz")}},a.Dw=function(b){b.h()&&(Cw(b),b.Ho()||b.NA())};t.Rx="";a.Ew=n;t=Aw.prototype;t.rc=function(){return!Ms};
t.wA=function(){Aw.m.wA.call(this);if(this.rc()){var b=Yv(this).ownerDocument;this.kc.c(b,Qv,this.RE,j);this.VQ=xd(this.lb.Ta(),"load",this.NA,j,this);this.kc.c(b,"DOMAttrModified",v(this.GE,this,this.RE),j)}};t.qo=function(){Xv(this,Ev)||(Aw.m.qo.call(this),this.rc()&&this.NA())};
t.yr=function(){if(!Xv(this,"blur")&&(Aw.m.yr.call(this),!Ms&&!tq)){var b=this.lb.Ta(),c=n;Ad(this.cG);this.cG=xd(b.document.body,"dragover",function(){c=j});fa.setTimeout(v(function(){if(!c&&this.lb){var b=Zv(this),e=this.lb.Ta();Ns(e);b&&(b.collapse(j),b.select())}},this),0)}};t.qB=function(){Aw.m.qB.call(this);var b=this.lb.xa();b.execCommand("enableInlineTableEditing",n,"false");b.execCommand("enableObjectResizing",n,"false")};
t.DF=function(){!this.rc()&&!Ew&&(this.pl&&Bt(this.pl,this.h()),Ew=j)};t.My=function(b){if(this.rc())Aw.m.My.call(this,b);else if(b=this.Pc)Pv(this,b),b.contentEditable=j,Vv(this,b.innerHTML,b),this.Yr()};t.Yr=function(){if(this.rc()){var b=this;fa.setTimeout(function(){Dw(b)},0)}Aw.m.Yr.call(this)};t.BE=function(){return{frameBorder:0,style:"padding:0;"}};
t.DC=function(b){if(!this.AQ){var c=this.Pc;c&&(this.JF="auto"==Xf(c,"overflowY"))}var c=this.Pc,d=Ub(c),e=c.style.width,g=c.style.height;Tf(c,"visibility","hidden");var d=d.o("DIV",{style:"height:0;clear:both",innerHTML:"&nbsp;"}),h=d.cloneNode(j);c.insertBefore(d,c.firstChild);c.appendChild(h);var h=At(c),d=h.width,h=h.height,l="";this.Ho()&&(l="&nbsp;",Tf(c,"position","relative"),Tf(c,"overflow","visible"),Tf(b,"position","absolute"),Tf(b,"top","0"),Tf(b,"left","0"));mg(c,d,h);Mc(Ub(c))&&(this.I_=
c.style.lineHeight,Tf(c,"lineHeight","0"));c.innerHTML=l;mg(b,d,h);mg(c,e,g);Tf(c,"visibility","");c.appendChild(b);cw(this)||(c=b.contentWindow.document,Mc(Ub(b.ownerDocument))&&(c.open(),c.write("<!DOCTYPE HTML><html></html>"),c.close()))};t.Zw=function(b){var c=this.Pc;if(c)return new Bv(this.id,Mc(Ub(c)),j,this.Ho(),b);f(Error("no field"))};
t.FJ=function(b,c,d){Tf(b,"visibility","hidden");var d=this.Zw(d),e=this.Pc,g=this.pl;if(!this.Rx){var h=this.Pc;if(h){var l=h.ownerDocument,m=ua(l);if(!xw[m]){for(var p=ua(l),r=[],l=mw(l.styleSheets),x=0,F;F=l[x];x++)if((F=lw(F))&&F.length)for(var I=0,G=F.length;I<G;I++){var Q=new ow,X;X=Q;var ka=F[I],Na=ka.style;if(Na){var Ea=i,Va=i;Na&&(Ea=ka.selectorText)&&(Va=Na.cssText)?A&&(Va+="/* */"):ka.cssText&&(Va=/([^\{]+)\{/,Ea=Va.exec(ka.cssText)[1],Va=ka.cssText.replace(Va,"").replace(/\}[^\}]*$/g,
""));if(Ea){ka=X;ka.rh=[];Ea=Ea.split(/,\s*/gm);for(Na=0;Na<Ea.length;Na++){var ne=Ea[Na];0<ne.length&&ka.rh.push(new sw(ne))}X.Tn=Va;X=j}else X=n}else X=n;X&&r.push(Q)}xw[p]=r}p=xw[m];m=[];for(r=0;r<p.length;r++)m.push(p[r].clone());l=new ww(h);x=new rw("body");for(p=0;p<m.length;p++){F=m[p].rh;r=F.length;for(I=0;I<r;I++){G=F[I];Q=G;X=l.uid;if(Q.iv[X])X=Q.iv[X];else{for(var Va=0,Na=Ea=ka=k,ne=l.PG,PD=ne.length,Qj=0;Qj<=Q.wi.length;Qj++){for(Ea=Q.wi[Qj];Va<PD;){var wx=ne[Va];if(Ea&&uw(Ea,wx)){ka=
{XD:Va,sI:Qj};Va++;break}else Na&&uw(Na,wx)&&(ka={XD:Va,sI:Qj-1});Va++}Na=Ea}X=Q.iv[X]=ka}X&&(Q=X.sI,G=G.wi,Va=G.length-1,X.XD==l.PG.length-1||Q<Va?(G=G.concat(),G.splice(0,Q+1,x),Q=new sw,Q.wi=G,F.push(Q)):0<Q&&Q==Va&&(Q=new sw,Q.wi=[x,G[Va]],F.push(Q)))}}l=new ow;h=h.currentStyle||Tb(h).defaultView.getComputedStyle(h,"")||{};p=new sw;p.wi=[new rw("html")];l.rh=[p];x={};for(p=0;r=yw[p];p++)x[r]=h[gb(r)];pw(l,x);m.push(l);l=new ow;x=new sw;x.wi=[new rw("body")];F={position:"relative",top:"0",left:"0",
right:"auto",display:"block",visibility:"visible"};for(p=0;r=zw[p];p++)F[r]=h[gb(r)];pw(l,F,j);l.rh=[x];m.push(l);h=[];r=m.length;for(p=0;p<r;p++){F=m[p];l=h;I=F.rh.length;x=n;for(G=0;G<I;G++){Q=F.rh[G].wi;X=Q.length;for(Va=0;Va<X;Va++)l.push(Q[Va].BF," ");G<I-1&&l.push(",");B&&!Gb("1.9a")&&(x=x||nw.test(Q[X-1].BF))}F=F.Tn;x&&(F=F.replace(qw,"$1 color: $2 ! important; "));l.push("{",F,"}\n")}this.Rx=h.join("")}}e=new Cv(e,g+this.Rx);d.Sq&&(g=xg(e.zW),(g.top||g.left||g.right||g.bottom)&&Tf(b,"margin",
-g.top+"px "+-g.right+"px "+-g.bottom+"px "+-g.left+"px"));Dv(d,c,e,b);Dw(this);Tf(b,"visibility","visible")};t.Hv=function(){Ad(this.cG);Ad(this.VQ);Aw.m.Hv.call(this)};a.Fw={};Fw._default_={cx:function(b){return $.get("/node/CommentV2",{params:{comment_id:b}})},Ml:Et,Nl:Et,add:function(b){return $.post("/node/AnswerCommentAddV2",{method:"add_comment",params:b})},remove:function(b){return $.post("/node/CommentV2",{method:"remove_comment",params:{comment_id:b}})},Ey:function(b,c){return $.post("/node/CommentV2",{method:c?"like_comment":"undo_like_comment",params:{comment_id:b}})}};
Fw.answer={Ml:function(b,c){return $.get("/node/AnswerCommentBoxV2",{params:{answer_id:b,load_all:c}})},Nl:function(b){return $.get("/node/AnswerCommentListV2",{params:{answer_id:b}})},add:function(b){return $.post("/node/AnswerCommentAddV2",{method:"add_comment",params:b})},HL:function(b,c){return $.post("/node/AnswerCommentV2",{method:"author_remove_comment",params:{comment_id:b,is_block:c}})}};
Fw.question={Ml:function(b){return $.get("/node/QuestionCommentBoxV2",{params:{question_id:b}})},Nl:function(b){return $.get("/node/QuestionCommentListV2",{params:{question_id:b}})},add:function(b){return $.post("/node/QuestionCommentAddV2",{method:"add_comment",params:b})}};
Fw.favlist={Ml:function(b){return $.get("/node/FavlistCommentBoxV2",{params:{favlist_id:b}})},Nl:function(b){return $.get("/node/FavlistCommentListV2",{params:{favlist_id:b}})},add:function(b){return $.post("/node/FavlistCommentAddV2",{method:"add_comment",params:b})}};
Fw.post={cx:function(b){return $.get("/node/PostCommentV2",{params:{comment_id:b}})},Ml:function(b,c){return $.get("/node/PostCommentBoxV2",{params:{post_id:b,load_all:c}})},Nl:function(b){return $.get("/node/PostCommentListV2",{params:{post_id:b}})},add:function(b){return $.post("/node/PostCommentV2",{method:"add_comment",params:b})},Ey:function(b,c){return $.post("/node/PostCommentV2",{method:c?"like_comment":"undo_like_comment",params:{comment_id:b}})},remove:function(b){return $.post("/node/PostCommentV2",
{method:"remove_comment",params:{comment_id:b}})}};
Fw.roundtable={cx:function(b){return $.get("/node/RoundtableCommentV2",{params:{comment_id:b}})},Ml:function(b,c){return $.get("/node/RoundtableCommentBoxV2",{params:{roundtable_id:b,load_all:c}})},Nl:function(b){return $.get("/node/RoundtableCommentListV2",{params:{roundtable_id:b}})},add:function(b){return $.post("/node/RoundtableCommentV2",{method:"add_comment",params:b})},Ey:function(b,c){return $.post("/node/RoundtableCommentV2",{method:c?"like_comment":"undo_like_comment",params:{comment_id:b}})},
remove:function(b){return $.post("/node/RoundtableCommentV2",{method:"remove_comment",params:{comment_id:b}})}};a.Hw=function(b,c){var d=b.split("!");this.type=d[0]+"!";this.namespace=d[1];this.Dc=new Gw(c)};y(Hw,id);a.Gw=function(b){this.category=b.category;this.action=b.action;this.label=b.label;this.value=b.value};Gw.prototype.fill=function(b,c){this[b]=this[b].replace("?",c);return this};a.Iw=function(b){T.call(this);E.extend(this.D={},this.R,b||{});this.Jh=new Od;this.Uf=k};y(Iw,T);t=Iw.prototype;t.R={trigger:{A:"data-editable"},MK:"hc-actionbar",MQ:"checked",UU:100,KP:100};
t.B=function(){Iw.m.B.call(this);this.wn=K("div");document.body.appendChild(this.wn);var b=this.D,c=new An(b.trigger,n,k,this.e);c.Xt=b.UU;c.gs=b.KP;c.sh(this.wn);N(c,"trigger",function(b){c.ed(new hn(b.anchor,1))});N(c,"beforeshow",function(b){this.Uf=b.target.anchor;this.Z()},n,this);c.className=b.MK;this.QP=c};t.ax=q("QP");
a.Jw=function(b,c){var d=b.D.MQ,e=qc(b.wn),g=z.find(e,function(b){return b.getAttribute("data-action")===c});if(!g||D.has(g,d))return n;z.forEach(e,function(b){D.remove(b,d)});D.add(g,d);return j};t.XL=function(b,c,d){c=K("div",{title:b.T,"data-action":b.name,className:"button "+b.name+(0===c?" first":c===d.length-1?" last":"")},[K("i","icon icon-actionbar-"+b.name)]);tg(c,j);this.g().c(c,"click",function(){Jw(this,b.name)&&b.jl(this.Uf)});return c};
t.Z=function(){this.wn.innerHTML="";jc(this.wn,z.map(E.Ka(this.Jh.ku()),this.XL,this))};a.Kw=function(b){T.call(this);E.extend(this.D={},this.R,b||{})};y(Kw,T);Kw.prototype.R={cF:{},EL:j};
Kw.prototype.B=function(){Kw.m.B.call(this);var b=this,c=this.e;if(this.D.EL){var d=new Iw({});d.Jh.set("link",{name:"link",T:"链接",jl:function(b){zc(b,b.href)}||ha});d.Jh.set("text",{name:"text",T:"文本",jl:function(b){zc(b,b.getAttribute("data-title"))}||ha});d.n(c);var e=d.ax();bs(e,new Of(2,0,0,0));e.bm=new Of(2,0,0,0)||k;var g=d.g();g.c(e,"beforeshow",function(b){var b=b.target.anchor,c=Hc(b);c===b.href?Jw(d,"link"):(c!==b.getAttribute("data-title")&&b.setAttribute("data-title",c),Jw(d,"text"))}).c(e,
"beforehide",function(b){if((b=b.target)&&c.contains(b)&&Lw(b))return n});var h;g.c(e,"show",function(b){h=b.target.anchor;D.add(h,"hover")}).c(e,"hide",function(){h&&(D.remove(h,"hover"),h=k)});this.Bq=d}this.g().c(c,"paste",function(){setTimeout(function(){var c=b.D,d=b.e,e=Bc(d,function(b){return 3===b.nodeType&&!Mw(b,d,function(b){return Lw(b)||"CODE"===b.nodeName||"PRE"===b.nodeName})}),g,h=lq(),F=h&&xp(h);z.forEach(e,function(b){var c=b.nodeValue,d=c.replace(Nw,function(b){Fa(b,"http")||(b=
"http://"+b);return b.link(b)});d!==c&&(c=hc(d),F===b&&(g=c.lastChild),oc(c,b))});g&&as(g);var I=c.cF,c=z.filter(d.getElementsByTagName("A"),function(b){var c=b.getAttribute("href");if(c=!(!c||"#"===c))if(c=!b.getAttribute("data-editable"))if(c=z.contains(Ow,b.protocol))c=Hc(b),Fa(b.href,c)?b=i:(b.setAttribute("data-editable",j),b.setAttribute("data-title",c),b=j),c=!b;return c}),c=z.map(c,function(b){return Pw(b.href).done(function(c){var e=I;if(c&&d.contains(b)){var e=e||{},g=function(b,c,d){var e=
lq();if(e){var g=e.W(),h=e.ta(),l=e.ka(),m=e.Ja();uc(c,g)&&(g=b,h=0);uc(c,l)&&(l=b,m=0);d(function(){g===b&&l===b?as(b):Yp(g,h,l,m).select()})}else d(ha)},h={link:function(b,c){b.setAttribute("data-editable",j);c.title===b.href?b.setAttribute("data-title",b.hostname.split(".").slice(/(.com|.edu|.gov|.net|.org)$/.test(b.hostname)?-2:-3).join(".").replace(/^www\./,"")+" 的页面"):(b.setAttribute("data-title",c.title),g(b,b,function(d){zc(b,c.title);d()}))},image:function(b,c){var d=document.createElement("img");
d.src=c.src;d.setAttribute("data-rawwidth",c.width);d.setAttribute("data-rawheight",c.height);g(d,b,function(c){oc(d,b);c()})}};(e=e[c.type]||h[c.type])&&e(b,c)}})});c.length&&(b.dispatchEvent("willScrape"),$.when.apply($,c).always(function(){b.dispatchEvent("didScrape")}))})}).c(c,"keydown",this.BP)};
Kw.prototype.BP=function(b){var c=Ug(b.keyCode),d=8===b.keyCode;if(!(b.ctrlKey||(b.altKey||b.metaKey)||!c&&!d)){var c=lq(),e=c.W(),g=c.ka(),h=this.e,l,m=Mw(e,h,Lw)||g!==e&&(l||(l=Mw(g,h,Lw)));if(m){var p=Hc(m),r=c.ta(),x=c.Ja();if(m.getAttribute("data-editable")&&p===m.href){var F=n;l=l||Mw(g,h,Lw)||m;var h=m.contains(e),I=l.contains(g);if(d)h&&(e=m,r=0,F=j),I&&(g=l,x=Wr(l),F=j),F&&Yp(e,r,g,x).select();else if(h&&I&&l===m){if(!c.isCollapsed()||!(0===r||p.length===r))b.preventDefault(),as(m)}else h&&
(e=m.nextSibling,r=0,F=j),I&&(g=l.previousSibling,x=Wr(g),F=j),F&&Yp(e,r,g,x).select()}}}};a.Nw=/\b(?:(?:https?):\/\/|www\.)(?:\([\-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[\-A-Z0-9+&@#\/%=~_|$?!:,.])*(?:\([\-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[A-Z0-9+&@#\/%=~_|$])/ig,a.Ow=["http:","https:"],a.Mw=function(b,c,d){for(;b&&b!==c;){if(d(b))return b;b=b.parentNode}},a.Lw=function(b){return"A"===b.nodeName},a.Pw=Tr(function(b){return $.post("/scraper",{url:b})});a.Qw=function(b,c,d){T.call(this);this.id=b;this.type=c;this.field=k;this.Xd=this.zg=n;this.me="写下你的评论…";this.placeholder='<p style="color:#999">'+this.me+"</p>";this.hm="";this.ma=0;this.jG=$.Deferred().resolve();this.Oz=this.Ss=k;this.$C="zm-comment-box";this.Jk=k;(b=Fw[c])||f(Error("API not found"));this.Wi=$.extend({},Fw._default_,b);E.extend(this.D={},this.R,d||{})};y(Qw,T);t=Qw.prototype;t.R={gG:n,autofocus:j,sw:"empty",Te:"zm-item-comment"};
t.$=function(b){Qw.m.$.call(this,b);Rw(this);var b=location.hash.slice(1).split("-"),c="comment"===b[0]&&b[1];c&&(b=z.find(Sw(this),function(b){return b.getAttribute("data-id")===c}),Ck(b));this.Xd=j;z.forEach(Sw(this),this.lz,this)};a.Tw=function(b,c,d){var e=J(b.$C,c);d&&(b.Jk=d);e?b.n(e):(b.zg=j,b.Z(c))};t.CL="zm-comment-bubble";t.zC="."+Qw.prototype.CL;t.zu=function(b){return $(b,this.e)};t.o=function(){this.e=K("div",{"class":this.$C,style:"display:none"});this.Vd()};t.ej=s('<i class="icon icon-spike zm-comment-bubble"></i><div class="zm-comment-spinner">正在加载，请稍等 <i class="spinner-lightgray"></i></div>');
t.p=function(){Qw.m.p.call(this);this.field=this.dD=this.Kn=this.pC=this.Jk=this.Oz=this.hG=k};a.Uw=function(b){var c=b.yl,d=c.h();if(c.Ll()!==b.placeholder){c.oe(n,b.placeholder);var e=["click","focus","keydown"],g=function(){c.oe(n,this.hm||"");this.field.lastChild?as(this.field.lastChild):c.jg();yd(d,e,g,n,this)};N(d,e,g,n,b);var h;window.getSelection?(h=window.getSelection(),h.anchorNode&&uc(b.field,h.anchorNode)&&h.removeAllRanges()):document.selection&&b.field.blur()}};
t.ws=function(b){(b=b.h&&b.h())&&(new Kw({cF:{image:ha}})).n(b)};t.vs=function(b,c){if(b.h){var d=(new fj).add("type",this.type+"_comment").add("resource_id",this.id),e=b.h();this.w_=d=new cr(e,{ln:{content:d.toString()},fk:J("zu-main")});new Zq(e,{$z:er});qa(c)&&c(d)}};a.Vw=function(b){b.focus();b=Ap(b);b.collapse();b.select()},a.Sw=function(b){return $(b.Kn).children(".zm-item-comment").get()};t.Wt=function(b){D.enable(this.dD,"expanded",b)};
t.Ki=function(b,c){this.dispatchEvent(new Hw("click!comment",{category:"?",action:this.type+"_comments",label:"?_"+b,value:pa(c)?c:this.Wa()}))};t.yj=function(){this.Xd?Ww(this):this.zg=j};t.nS=function(b){if(13===b.keyCode&&(b.ctrlKey||b.metaKey))this.Dq(),$(this.field).blur(),b.preventDefault();27===b.keyCode&&Xw(this)};
t.ha=function(b){var c=Gk(this.e,b.target);if(c&&c.name){var d=Kc(c,k,this.D.Te);b.preventDefault();switch(c.name){case "reply_comment":a:if(S.Ia()){var c=J("zm-comment-content-wrap",d),e=J("zm-comment-form",c),g=d.getAttribute("data-id"),h=this,l;if(e){l=J("zm-comment-editable",e);if(rg(e)){if(us(e)){R(e,n);break a}}else R(e,j);Vw(l)}else{d="";S.Ia()&&(d='<img class="avatar" src="'+S.TN()+'">');e=hc('<div class="zm-comment-form expanded"><div class="zm-comment-editable-wrap">'+d+'<div class="zm-comment-editable" aria-label="写下你的回复"></div></div><div class="zm-command zg-clear"><a href="javascript:;" class="zm-comment-submit zg-right zg-btn-blue">评论</a><a href="javascript:;" class="zm-comment-close zm-command-cancel">取消</a></div></div>');
c.appendChild(e);l=J("zm-comment-editable",e);var m=new Aw(l);m.ie();this.vs(m,function(){Vw(l)});this.ws(m);var d=J("zm-comment-close",e),c=J("zm-comment-submit",e),p=function(){var b=La(m.Ll()),c=La(Hc(l));b&&c?Yw(h,{content:b,eU:g},function(b){b.r||(R(e,n),m.oe(n,""),(b=z.Df(Sw(h)))&&Bs(b,{offsetTop:100,vC:j}))}):(U("请填写内容"),l.focus())};N(d,"click",function(){R(e,n)});N(c,"click",p);N(l,"keydown",function(b){if(13===b.keyCode&&(b.ctrlKey||b.metaKey))p(),b.preventDefault()})}Bs(e,100)}else d=Jk.F(),
"question"===this.type?d.Ha="question_comment_reply":"answer"===this.type&&(d.Ha="question_answer_comment_reply"),d.z(j),d.Tc();break;case "cancelanon":d=$(this.e).parents(".feed-item-hook").data("qid");gs(0,k,d);break;case "delcomment":this.Xl(c);break;case "like_comment":if(S.Ia()){var d=$(c),b=Kc(c,k,this.D.Te),c=$(".like-num",b),r=b.getAttribute("data-id"),b=!d.hasClass("liked");this.Wi.Ey(r,b);var r=$("em",c),x=+r.text()+(b?1:-1);c.toggleClass("liked",b).toggleClass("nil",0>=x).attr("data-tip",
"s$r$"+x+" 人觉得这个很赞");r.text(x);d.toggleClass("liked",b);uk(d[0],b?"取消赞":"赞")}else d=Jk.F(),d.z(j),d.Tc();break;case "author_delcomment":var F=Kc(c,k,this.D.Te),I=F.getAttribute("data-id"),G=Ci("删除评论",'你确定要删除这条评论吗？<p style="margin-top: 0.2em;color:#999;"><label><input type="checkbox">同时将此人屏蔽</label></p>',function(b){if(b){var b=$(":checkbox",G.h()).prop("checked"),c=xa(L,F);this.Wi.HL(I,Number(b)).done(v(function(){qa(c)&&c();this.ma-=1;Zw(this)},this))}},this);break;case "admin_delcomment":var d=
ov.F(),Q=Kc(c,k,this.D.Te),b={id:Q.getAttribute("data-id"),type:"comment"};d.Dl=b;vv(d,c,v(function(){L(Q);this.ma-=1;Zw(this)},this),"delete");d.z(j);break;case "closeform":Xw(this);break;case "report":this.as(c);b.stopPropagation();break;case "addnew":this.Dq();break;case "load-more":this.Ki("comments_all"),this.hG(c)}}};
t.hG=function(b){this.Ss&&"pending"===this.Ss.state()||(b&&D.add(b,"loading"),this.Ss=this.Oz||this.iG(),this.Ss.done(v(function(c){c=$(c).filter(".zm-item-comment").get();if(c.length){var d=Sw(this);d.length&&(c=z.filter(c,function(b){return!z.find(d,function(c){return c.getAttribute("data-id")===b.getAttribute("data-id")})}),c=z.concat(d,c).sort(function(b,c){return b.getAttribute("data-id")-c.getAttribute("data-id")}),z.forEach(c,this.BC,this),b&&L(b));jc(this.Kn,c)}},this)))};
a.Xw=function(b){0<b.Wa()?(b.hm=b.ib(),b.Wt(n),Uw(b)):b.Jk?b.collapse():b.Wt();b.Ie()};t.expand=function(){this.La(j)};t.collapse=function(){this.La(n)};t.ac=q("Xd");t.La=function(b){if(b!==this.Xd){b&&(this.zu(this.zC).hide(),this.Vd());this.Xd=b;this.dispatchEvent(b?"beforeexpand":"beforecollapse");R(this.e,this.Xd);var c=v(function(){b&&$w(this);this.dispatchEvent(b?"expand":"collapse")},this);b&&this.zg?Ww(this).done(c):c()}};t.pe=function(){this.La(!this.Xd)};
a.$w=function(b){if(b.Jk){var c=$(b.Jk);b.zu(b.zC).show().css("left",c.position().left+c.width()/2)}},a.Ww=function(b){if("pending"!==b.jG.state()){b.$a();b.e.innerHTML=b.ej();b.expand();var c=b.Wi.Ml(b.id,b.D.gG).done(v(b.YT,b));return b.jG=c}};t.iG=function(){return this.Wi.Nl(this.id)};a.ax=function(b,c,d,e){var c=$(c),g=$(d);d?($(".zm-command, .zm-comment-info",b.e).hide(),$(b.field).hide().after(g).after(c)):c.insertAfter(b.field);e&&e.call(b,c,g)};
t.YT=function(b){b=hc(La(b));z.forEach($("."+this.D.Te,b).get(),this.lz,this);this.zg=n;this.$a();oc(b,this.e);this.e=b;Rw(this)};
a.Rw=function(b){E.forEach({pC:".load-more",Kn:".zm-comment-list",dD:".zm-comment-form",field:".zm-comment-editable"},function(b,c){this[c]=$(b,this.e)[0]},b);b.field.setAttribute("aria-label",b.me);if(ni){var c=b.field;c.setAttribute("contentEditable",j);var d=b.yl={h:function(){return c},Ll:function(){return c.innerHTML},oe:function(b,d){c.innerHTML=d},jg:function(){Ks(c)}};b.vs(d);b.ws(d)}else{var e=K("textarea",{placeholder:b.me,"class":"zm-comment-textarea"});oc(e,b.field);new Po(e,22);b.field=
e;b.yl={h:function(){return e},Ll:function(){return e.value},oe:function(){e.value="";e.style.height=Zf(22,j)},jg:function(){e.focus()}}}b.g().c(b.field,["change","keyup"],function(b){27!==b.keyCode&&(this.hm=Ls(this.field)?"":this.ib())});S.Ia()&&!S.ye&&ax(b,'<div class="active-mask-tip-comment">为正常使用知乎提问、回答、评论和编辑功能，请验证您的邮箱、激活帐号。</div>','<div class="zm-command"><a class="zg-r3px zg-btn-blue" href="javascript:;">我要激活</a></div>',function(b,c){function d(){zl.F().z(j)}b.on("click",d);c.on("click",d)});
S.Ia()||ax(b,'<div class="signin-mask-tip-comment"></div>',k,function(c,d){function e(){Jk.F().z(j);"question"===b.type?Jk.F().Ha="question_comment_box":"answer"===b.type&&(Jk.F().Ha="question_answer_comment_box");Jk.F().Tc("comment","加入知乎，即可发表你的评论","你的参与，会让讨论更加全面")}c.on("click",e);d.on("click",e)});Uw(b);b.g().c(b.e,"click",b.ha).c(b.field,"keydown",b.nS).c(Ki,"anon_change",b.yj).c(b.yl.h(),["click","focus"],xa(b.Wt,j)).c(b.yl.h(),"focus",xa(b.Ki,"add_comment_start"));b.ma=Number(b.e.getAttribute("data-count"));
$(b.e).on("focusin focusout","."+b.D.Te,function(b){$(this).toggleClass("focusin","focusin"===b.type)});!ub&&b.pC&&(b.Oz=$.Deferred(function(b){setTimeout(b.resolve,2E3)}).promise().then($.proxy(b.iG,b)));Zw(b);$w(b)},a.Zw=function(b){var c=b.D,d=!b.Wa();D.enable(b.e,c.sw,d);if(b.Jk){var e=b.Wa();uk(b.Jk,e?e+" 条评论":"添加评论")}d&&b.field&&c.autofocus&&b.field.focus();b.dispatchEvent("change")};t.ib=function(){var b=La(this.yl.Ll());return b===this.placeholder?"":b};
t.Dq=function(){var b=this.ib(),c=La(Hc(this.field));b&&"TEXTAREA"===this.field.tagName&&c||b?Yw(this,b):(U("请填写内容"),this.field.focus())};t.Wa=q("ma");a.Yw=function(b,c,d){if(!(b.Bm&&"pending"===b.Bm.state())){var e;ra(c)&&(e=c.eU,c=c.content);var c=Oa(c),g=new Od;g.set(b.type+"_id",b.id);g.set("content",c);e&&g.set("reply",e);c=b.Wi.add(g.ku());c.done($.proxy(b.dO,b)).done(d);b.Bm=c;b.hm=b.ib();b.Ki("add_comment_submit")}};
t.dO=function(b){if(b.r)return U(b.msg);this.Wi.cx(b.msg).done($.proxy(this.ZT,this));this.yl.oe("");Uw(this);this.Wt(n)};t.lz=function(b){this.BC(b)};
t.BC=function(b){if(Rg("auth_f_manage")&&!("favlist"===this.type||$(".del",b).length)){var c=b.getAttribute("data-id");$("<a>",{href:"#",name:"admin_delcomment","class":"del zm-comment-op-link needsfocus",html:'<i class="zg-icon zg-icon-comment-del"></i>删除',"data-op":"remove-comment","data-action":"/manage?"+$.param({comment_id:c,action:"remove_comment2"})}).appendTo($(".zm-comment-ft",b))}};t.ZT=function(b){this.hm="";b=hc(b);this.Kn.appendChild(b);this.lz(b);this.ma+=1;Zw(this)};
t.as=function(b){S.Ia()?(b=Kc(b,k,this.D.Te).getAttribute("data-id"),bu.Gm("comment",b)):(b=Jk.F(),b.z(j),b.Tc())};t.Xl=function(b){var c=Kc(b,k,this.D.Te),d=c.getAttribute("data-id");Ci("删除评论","你确定要删除这条评论吗？",function(b){if(b){var g=xa(L,c);this.Wi.remove(d).done(v(function(){qa(g)&&g();this.ma-=1;Zw(this)},this))}},this)};t.Vd=function(){$(window).on("beforeunload.CommentForm",v(function(){if(this.hm)return"你的评论还未保存，确认离开该页面吗？"},this))};t.Ie=function(){$(window).off("beforeunload.CommentForm")};a.bx=function(b){this.L=$(b);this.wf()};bx.prototype.wf=function(){var b=[this.L.get(0)].concat(this.L.parents().get()),c=$.map(b,function(b){return $(b).data("navigable")})[0],d=c&&$.grep(c.items(),function(c){return~$.inArray(c,b)})[0];this.z_=c;this.zR=d};bx.prototype.getItem=q("zR");a.cx=function(b,c,d,e){nr.call(this,b,c,d,e)};y(cx,nr);cx.prototype.Vd=function(){$(window).on("beforeunload.AnswerEditor",v(s("你的修改还未保存，确认离开该页面吗？"),this))};cx.prototype.Ie=function(){$(window).off("beforeunload.AnswerEditor")};cx.prototype.vh=function(){cx.m.vh.call(this);this.Ie()};cx.prototype.vd=function(){cx.m.vd.call(this);this.Vd()};a.dx=function(){this.Ev=[]};y(dx,gu);ia(dx);dx.prototype.o=function(b){var c=dx.m.o.call(this,b);D.add(c,"goog-submenu");ex(this,b,c);return c};dx.prototype.n=function(b,c){c=dx.m.n.call(this,b,c);D.add(c,"goog-submenu");ex(this,b,c);var d=Wb("div","goog-menu",c);if(d.length){var e=new ou(b.K()),d=d[0];R(d,n);b.K().xa().body.appendChild(d);e.n(d);b.th(e,j)}return c};
dx.prototype.Oa=function(b,c){var d=this.ba(b),e=d&&d.lastChild;dx.m.Oa.call(this,b,c);e&&(d.lastChild!=e&&D.has(e,"goog-submenu-arrow"))&&d.appendChild(e)};dx.prototype.Qe=function(b){dx.m.Qe.call(this,b);var c=b.ba(),d=b.K(),d=Vb(d.Ga,"span","goog-submenu-arrow",c)[0];fx(b,d);d!=c.lastChild&&c.appendChild(d);Pc(b.h(),Wc.Xk,"true")};
a.ex=function(b,c,d){var e=c.K().o("span");e.className="goog-submenu-arrow";fx(c,e);b.ba(d).appendChild(e)},a.fx=function(b,c){b.Id()?(D.add(c,"goog-submenu-arrow-rtl"),zc(c,b.Gq?"◄":"►")):(D.remove(c,"goog-submenu-arrow-rtl"),zc(c,b.Gq?"►":"◄"))};a.gx=function(b,c,d,e){lu.call(this,b,c,d,e||dx.F())};y(gx,lu);a.hx=218;t=gx.prototype;t.Sd=k;t.DA=k;t.eF=n;t.pc=k;t.Ir=n;t.Gq=j;t.EQ=n;t.B=function(){gx.m.B.call(this);this.g().c(this.getParent(),"hide",this.fH);this.pc&&ix(this,this.pc,j)};t.$a=function(){this.g().wa(this.getParent(),"hide",this.fH);this.pc&&(ix(this,this.pc,n),this.Ir||(this.pc.$a(),L(this.pc.h())));gx.m.$a.call(this)};t.p=function(){this.pc&&!this.Ir&&this.pc.G();this.pc=k;gx.m.p.call(this)};
t.ud=function(b,c){gx.m.ud.call(this,b);c&&(this.ab().ug=j);b||(this.Sd&&Id.clearTimeout(this.Sd),this.Sd=Ld(this.Ug,hx,this))};t.Yt=function(){var b=this.getParent();b&&Ws(b)==this&&(jx(this,j),kx(this),this.p_=n)};t.Ug=function(){var b=this.pc;b&&b.getParent()==this&&(jx(this,n),oh(b,function(b){"function"==typeof b.Ug&&b.Ug()}))};a.lx=function(b){b.Sd&&Id.clearTimeout(b.Sd);b.DA&&Id.clearTimeout(b.DA)};t.z=function(b,c){var d=gx.m.z.call(this,b,c);d&&!this.S()&&this.Ug();return d};
a.kx=function(b){oh(b.getParent(),function(b){b!=this&&"function"==typeof b.Ug&&(b.Ug(),lx(b))},b)};t.$b=function(b){var c=b.keyCode,d=this.Id()?37:39,e=this.Id()?39:37;if(this.eF){if(!this.ab().$b(b))if(c==e)this.Ug();else return n}else if(this.isEnabled()&&(c==d||c==this.Xy))this.Yt(),Xs(this.ab()),lx(this);else return n;b.preventDefault();return j};t.VR=function(){this.pc.getParent()==this&&(lx(this),this.wm.ud(this),kx(this))};t.fH=function(b){b.target==this.wm&&(this.Ug(),lx(this))};
t.od=function(b){this.isEnabled()&&(lx(this),this.DA=Ld(this.Yt,hx,this));gx.m.od.call(this,b)};t.le=function(b){lx(this);if(this.Ub&8)return gx.m.le.call(this,b);this.Yt();return j};
a.jx=function(b,c){b.dispatchEvent(kh(64,c));var d=b.ab();if(c!=d.S()&&(c&&(d.Ba||d.Z(),d.Tb(-1)),b.eF=c,D.enable(b.h(),"goog-submenu-open",c),d.z(c),c)){var d=new bt(b.h(),b.Gq?6:4,b.EQ),e=b.ab(),g=e.h();e.S()||(g.style.visibility="hidden",R(g,j));d.oa(g,b.Gq?4:6);e.S()||(R(g,n),g.style.visibility="visible")}},a.ix=function(b,c,d){var e=b.g();(d?e.c:e.wa).call(e,c,"highlight",b.VR)};t.Fa=function(b){this.ab().J(b,j)};t.Ti=function(b,c){this.ab().Zk(b,c,j)};
t.removeItem=function(b){(b=this.ab().removeChild(b,j))&&b.G()};t.gi=function(b){return qh(this.ab(),b)};t.Pl=function(){return ph(this.ab())};t.Fb=function(){return this.ab().Fb()};t.ab=function(){this.pc?this.Ir&&this.pc.getParent()!=this&&nh(this.pc,this):this.th(new ou(this.K()),j);this.pc.h()||this.pc.o();return this.pc};t.th=function(b,c){var d=this.pc;b!=d&&(d&&(this.Ug(),this.Ba&&ix(this,d,n)),this.pc=b,this.Ir=!c,b&&(nh(b,this),b.z(n,j),b.pn=n,b.$e(n),this.Ba&&ix(this,b,j)))};t.Yf=function(b){return this.ab().Yf(b)};
po("goog-submenu",function(){return new gx(k)});a.mx=function(b,c,d,e){gx.call(this,b,c,d,e)};y(mx,gx);mx.prototype.$b=function(b){var c=mx.m.$b.call(this,b),b=parseInt(dk[b.keyCode],10);isNaN(b)||this.ab().Tb(b-1);return c};a.nx=function(b){E.extend(this.D={},this.R,b||{});this.content="";this.gd=this.Tf=this.Fh=k;this.Xd=n;this.valid=j};y(nx,T);t=nx.prototype;t.R={BV:"textarea.content",YL:".toggle-expand",sV:".summary",HM:"zm-editable-content"};
t.B=function(){nx.m.B.call(this);var b=this.e,c=this.D;this.content=$(c.BV,b).remove().val();this.Fh=$(c.sV,b);this.gd=$(c.YL,this.Fh);if(this.Fh.length){if(this.gd.length)this.gd.click(n).on("click",$.proxy(this.expand,this));this.Fh.on("click",$.proxy(this.lP,this))}else this.valid=n,this.expand=this.collapse=ha,this.dispatchEvent("invalid")};t.Yc=function(){return this.gd.get(0)};t.ib=q("content");t.La=function(b){b?this.expand():this.collapse()};
t.lP=function(b){var c=lq();if(!c||!c.Mc())c=$(b.target).closest("a").get(0),c&&"javascript:"!==c.protocol||(b.preventDefault(),b.stopPropagation(),this.expand())};t.expand=function(){this.Xd||(this.Xd=j,this.Tf?this.Tf.show():this.Fh.length&&(this.Tf=$("<div>",{html:this.content,"class":this.D.HM}).insertBefore(this.Fh)),this.Fh.hide(),this.dispatchEvent("expand"))};t.collapse=function(){this.Xd&&(this.Xd=n,this.Tf.hide(),this.Fh.show())};a.ox=function(b){T.call(this);this.rW="votebar-mobile";this.dw="votebar-mobile-dialog";this.sW=b;L(b.h());D.add(b.h(),this.rW);Tc(this,b);this.g().c(b,"action",function(){this.zb&&this.zb.z(n)})};y(ox,T);ox.prototype.$=function(b){ox.m.$.call(this,b);this.g().c(b,"click",this.dT)};ox.prototype.SQ='<div class="text zg-clear"><label class="zg-left">赞同</label><label class="zg-right">反对</label></div>';
ox.prototype.dT=function(){this.zb&&this.zb.G();var b=new yi(k,n);b.jw=j;b.Cp(j);b.LN=j;var c=b.ba();c.appendChild(this.sW.h());c.appendChild(hc(this.SQ));D.add(b.h(),this.dw);b.z(j);this.zb=b;Tc(this,b)};a.px=function(b,c,d){T.call(this);this.Y=b;this.qa=d;this.RM=c||Eg;this.Mv=k};y(px,T);a.qx={all_can_comment:"允许任何人评论",followee_can_comment:"允许我关注的人评论",nobody_can_comment:"关闭评论"};t=px.prototype;
t.Fz=function(){var b=J("zm-item-answer",this.e)||this.e;this.qa=b.getAttribute("data-aid");this.We="1"===b.getAttribute("data-isowner");this.Xb=b.getAttribute("data-atoken");this.pg="1"===b.getAttribute("data-deleted");this.Sv=+b.getAttribute("data-created");this.JP=+b.getAttribute("data-helpful");this.BQ="1"===b.getAttribute("data-good");this.fh="1"===b.getAttribute("data-collapsed");this.mb=k};t.Py=function(){Fu("answer",this.Xb,"read")};
t.Qy=function(){Fu("answer",this.Xb,/^\/question\//.test(location.pathname)?"read":"touch")};
t.B=function(){function b(){c();var b=l.Eq.gi(0);b.ab&&b.ab()&&(b.Yt(),b.ab().Tb(0))}function c(){rx(l);l.Eq.Tb(0)}px.m.B.call(this);this.Fz();this.Lg=J("zm-item-answer-author-info",this.e);var d=this.Xp=new nx;this.J(d);d.n(this.e);d.Yc()&&P(this.g(),d,"expand",this.Py);Vt(this.e,this.Qy,this);(this.Qb=this.Qb||J("zm-item-meta",this.e))&&this.g().c(this.Qb,"click",this.sm);if(this.We)this.Lg&&(this.qH=(this.mb=Wa(this.Lg.innerHTML,"匿名用户"))?k:this.Lg.innerHTML.replace(/src=".+?"/g,'src="'+S[2]+'"'),
this.g().c(this.Lg,"click",function(b){"cancel-anon"===b.target.name&&gs(n)}));else{var e=J("zm-votebar",this.e)||J("zm-votebar",this.Qb);e&&(d=new kv(this.qa),d.n(e),this.sc=d,this.g().c(d,"change",this.TT).c(d,"action",function(b){b.data.state===lv.xe?Y.V({type:"ga_click_vote_up",target:this}):b.data.state===lv.Hh&&Y.V({type:"ga_click_vote_down",target:this})}),(e=J("votenum-mobile",this.Qb))&&(new ox(d)).n(e))}if(d=J("zm-item-vote-info",this.e)){this.Nk=new nv(this.qa);this.J(this.Nk);this.Nk.n(d);
d=$(".zm-item-vote-count",this.e);d[0]||(d=$(".zm-item-vote-count",this.Qb));var g=[d[0],$(".zm-votebar .count",this.e)[0]];if(g.length){var h=this.Nk;this.Nk.on("change",function(){z.forEach(g,function(b){uk(b,h.Wa())})})}}this.Bo();$(this.e).on("contentchange",$.proxy(this.Bo,this));this.by();this.Ea();d=new bx(this.e);d=sk.CB(d.getItem()||this.e);rk(qk(rk(qk(rk(qk(rk(qk(rk(qk(rk(qk(rk(qk(d,"v",function(){this.sc&&this.sc.lB()},this),{group:"操作",name:"赞同"}),"d",function(){this.sc&&this.sc.kB()},
this),{group:"操作",name:"反对"}),"f x",this.de,this),{group:"操作",name:"分享"}),"s c",this.ux,this),{group:"操作",name:"收藏"}),"t",this.XE,this),{group:"操作",name:"感谢"}),"c",this.vx,this),{group:"操作",name:"打开评论"}),"shift+c",this.px,this),{group:"操作",name:"定位到评论框"});var e=mb?"⌘":"ctrl",l=this;Dg.HF&&$("a[name=admin]",this.Qb)[0]&&rk(qk(rk(qk(d,"meta+.",c),{group:"管理",name:"展开菜单",key:e+"+."}),"meta+k",b),{group:"管理",name:"展开折叠子菜单 (Kill)",key:e+"+k"});if(ub&&!ji&&(d=J("more-actions",this.Qb))){var m={share:{label:"分享",
action:this.de},fav:{label:"收藏",action:this.ux},report:{label:"举报",action:this.as},nohelp:{label:this.JP?"没有帮助":"撤销没有帮助",action:this.QE}},p=new ou,e=function(b){ph(p)&&p.Fa(new nu);var c=new lu(m[b].label);c.ua(b);p.Fa(c)};e("share");e("fav");this.We||(e("nohelp"),S.Ia()&&e("report"));e=new Ou("operation",p);e.tp=j;Qu(e);e.uG=new Of(7,0,7,0);e.tm=ba();e.Wc=nf;e.n(d);D.add(p.h(),"zh-answer-more-actions");this.g().c(p,"action",function(b){var c=m[b.target.X()];c&&c.action.call(this,b)})}};
t.vA=function(b){var c=this.Bo();c&&Uq(c,b)};t.Bo=function(){if(this.kq)return this.kq;var b=J("zm-editable-content",this.e),c=this.sc&&this.sc.h();!this.We&&(!ub&&S.Ia())&&(c&&$(c).is(":visible")&&b&&230<$(b).height())&&(b=this.kq=new Xq(k,b),this.J(b),b.Hi="votebar",b.Cz=50,b.n(c))};t.TT=function(){this.Nk&&this.Nk.nk()};
a.sx=function(b){if(!b.Ae&&b.We&&Eg&&b.qa){b.Ae=new cx(n,"/answer/content","content");Tc(b,b.Ae);b.Ae.pu=j;b.Ae.tw=j;b.Ae.AE=jw.prototype.AE;var c=J("zm-item-rich-text",b.e);b.Ae.rd=["id="+b.Y];b.Ae.n(c);b.g().c(b.Ae,"shouldUpdateContent",function(b){if(ma(b.data))return n});b.g().c(b.e,"click",function(b){"suggest_edit"===b.target.name&&(this.Ae.vd(),$(".zh-question-censor-tip",this.e).hide());return j})}};
t.Ea=function(){this.Lg&&this.g().c(this.Lg,"click",this.ha);this.We&&(this.FL=S);this.g().c(Ki,"anon_change",function(b){this.We?this.Bp(b.mb):this.sc.be()===lv.xe&&this.Nk.nk()});sx(this);$(this.e).on("focusin focusout",function(b){$(this).toggleClass("focusin","focusin"===b.type)})};t.qf=function(b){return Gk(this.e,b)};
t.ha=function(b){if(b=(b=this.qf(b.target))&&b.name)if("edit"===b){b=Xu();if(!this.sv){var c=Eg.Xb;b.Dy=j;b.TH=c;this.g().c(b,"change",this.iz)}this.sv=j;Yu(b)}else"complex"===b&&(b=J("zm-item-answer-summary",this.e),c=J("zm-item-rich-text",this.e),R(b,n),R(c,j))};t.iz=function(){var b=Xu().Vw()||S[4]||"";b&&this.Ot(b)};t.Ot=function(b){this.An=b;this.Bp(n)};t.by=function(){var b=J("zm-item-answer-author-wrap",this.e),b=J("zm-list-avatar",b);Zj.add(b)};
t.Bp=function(b){b?this.Lg.innerHTML='<h3 class="zm-item-answer-author-wrap">匿名用户<a class="zg-link-gray cancel-anon" href="javascript:void(0);" name="cancel-anon">取消匿名</a></h3>':this.We&&(this.qH?this.Lg.innerHTML=this.qH.replace("</h3>","").replace("</H3>","")+'<a name="edit" class="zu-edit-button" href="javascript:;"><i class="zu-edit-button-icon"></i>修改话题经验</a></h3>':(b=[],b.push('<h3 class="zm-item-answer-author-wrap">'),b.push(ht()),b.push(it(S,"zm-item-answer-creator")),b.push("</h3>"),this.Lg.innerHTML=
b.join("")))};t.CQ=q("We");
a.tx=function(b,c){b.na||(b.na=new Qw(b.qa,"answer",c),b.J(b.na),Tw(b.na,b.Qb,$(".toggle-comment",b.Qb)[0]))},a.rx=function(b){if(b.Eq)b.Eq.z(j);else{var c;var d=$("a[name=admin]",b.Qb)[0];if(d){b.RK=d;hx=0;c=new Su;b.J(c);c.attach(d,5);d=b.fh?new lu("取消折叠"):new mx("折叠");d.ua("collapse");if(!b.fh){for(var e=0;e<qv["collapse-answer"].rb.length;e++){var g=new lu([K("span","",(e+1).toString()+" "),document.createTextNode(pv[qv["collapse-answer"].rb[e]])]);g.ua(qv["collapse-answer"].rb[e]);d.Fa(g)}D.add(d.ab().h(),
"manage-menu")}e=new lu("删除");e.ua("delete");c.Fa(d);c.Fa(e);c.Z(b.e);D.add(c.h(),"manage-menu")}else c=i;c&&(Tu(c,new bt(b.RK,1,j),0,new Of(5,0,5,0)),b.g().c(c,"action",function(b){var c=b.target,b=c.X(),c=c.h(),d=new fj;if("collapse"===b)d.add("answer_id",this.qa).add("action","collapse2").add("collapse",this.fh?"cancel":"done"),c.setAttribute("data-op",this.fh?"uncollapse-answer":"collapse-answer"),c.setAttribute("data-action","/manage?"+d.toString()),ux(this,c);else if("delete"===b)d.add("answer_id",
this.qa).add("action","remove_answer2"),c.setAttribute("data-op","remove-answer"),c.setAttribute("data-action","/manage?"+d.toString()),ux(this,c,"delete");else if(pa(b)){var e=$(this.e),c=new fj;c.add("answer_id",this.qa).add("action","collapse2").add("collapse",this.fh?"cancel":"done").add("reason",b);sv("/manage",c.toString(),function(){e.hide("fast",function(){e.remove()})})}}),vx(b,c),b.Eq=c)}},a.ux=function(b,c,d){var e=ov.F();e.Dl={id:b.qa,type:"answer"};vv(e,c,v(function(){R(this.e,n)},b),
d);e.z(j)};
t.sm=function(b){var c=this.qf(b.target),d=c&&c.name;if(d)switch(d){case "addcomment":if("添加评论"===$.trim($(c).text())&&this.ri("comment","question_answer_add_comment_start"))break;this.vx();this.na.ac()&&this.na.Ki("view_comments",parseInt(Hc(c),10)||0);break;case "remove":this.Xl();break;case "thanks":Y.V({type:"ga_click_thank_answer",target:c});this.XE();break;case "comment_opt":this.SU=c;if(!this.aD||!this.aD.Hb()){b=this.AM;if(!b){var c=$(c).data(),e=new Su,b=new xx("禁止转载");b.Sc(!c.copyable);e.Fa(b);
e.Fa(new nu);this.Nv=[];E.forEach(qx,function(b,c){var d=new xx(b);d.ua(c);d.Sc(c===this.Mv);this.Nv.push(d);e.Fa(d)},this);e.Fa(new nu);e.Fa(new lu("删除"));this.g().c(e,"action",this.lO);vx(this,e);e.Z(document.body);D.add(e.h(),"zm-question-answer-meta-comment-option-menu");b=this.AM=e}this.Mv||(c=new V(j),P(this.g(),c,"success",function(b){if((b=Ie(b.target))&&!b.r){var c=b.msg;z.forEach(this.Nv,function(b){b.X()===c&&b.Sc(j)});this.Mv=c}else U(b.msg)}),c.ajax("/answer/comment_permission?answer_id="+
this.qa,k,"GET"),this.aD=c);b.S()?b.z(n):Tu(b,new bt(this.SU,1,j),0,new Of(5,0,5,0))}break;case "admin":rx(this);break;case "share":Y.V({type:"ga_click_share_answer_box",target:c});this.de();break;case "nohelp":this.QE(b);break;case "report":this.as(b);break;case "favo":Y.V({type:"ga_click_collect_answer_box",target:c}),this.ux()}};
t.ri=function(b,c){var d={thank:["thank","加入知乎，即可「感谢」作者","用最简单的方式赞美认真的态度认真的人"],favo:["favo","加入知乎，即可收藏精彩回答","你可以把好内容装进一个收藏夹，方便随时查看"],share:["share","加入知乎，即可和朋友分享精彩内容","分享到新浪微博、腾讯微博或通过私信分享"],comment:["comment","加入知乎，即可发表你的评论","你的参与，会让讨论更加全面"],nohelp:[]};if(!S.Ia()){var e=Jk.F();e.Ha=c;e.z(j);e.Tc.apply(e,d[b]);return j}return n};t.as=function(){this.ri("report")||bu.Gm("answer",this.qa)};
t.QE=function(b){var b=b.target,c=!!b.h;Y.V({type:"ga_click_answer_not_helpful",target:c?b.h():b});if(!this.ri("nohelp","question_answer_not_helpful")){this.cw&&"pending"===this.cw.state()&&this.cw.abort();var d,e;e=c?b.Yg():b.innerHTML;e=(d=-1<e.indexOf("撤销"))?"没有帮助":"撤销没有帮助";c?b.Nm(e):b.innerHTML=e;d=d?"/answer/helpful":"/answer/not_helpful";c||Ck(b);this.cw=$.post(d,{aid:this.qa})}};
t.de=function(){if(!this.ri("share","question_question_share")){var b=Cu.F();b.yk("分享回答","answer",this.Xb,{aid:this.qa});b.show();Du(b,"tb-webshare-sina")}};t.ux=function(){if(!this.ri("favo","question_answer_collect"))if(S.Ia()&&!S.ye)zl.F().z(j);else{var b=av(),c=this.qa;if(b.qa!==c&&b.jh){var d=Xb("zm-favo-list-item-link",b.jh);z.forEach(d,function(b){D.remove(b,"zm-favo-list-item-link-active")},b)}b.qa=c;b.show()}};t.vx=function(){this.na||tx(this);this.na.pe()};
t.px=function(b){this.na?this.na.field.focus():this.vx();b.preventDefault()};t.XE=function(){if(!this.ri("thank","question_answer_thank")){var b=$("a[name=thanks]",this.Qb)[0];b&&!D.has(b,"disabled")&&(uk(b,"已感谢"),D.add(b,"disabled"),Ck(b),$.post("/answer/thanks",{aid:this.qa}))}};a.vx=function(b,c){b.g().c(c,"show",function(){D.add(this.Qb,"zm-item-meta-has-menu")}).c(c,"hide",function(b){b.currentTarget===b.target&&D.remove(this.Qb,"zm-item-meta-has-menu")})};
t.lO=function(b){var c=b.target,b=c.X();"禁止转载"===b?(b=!c.ee(),$.post("/node/AnswerMetaV2",{method:"set_copyright",params:{answer_id:this.qa,is_copyable:Number(b)}}),$(".copyright",this.Qb).html(b?"":'<span class="zg-bull">&bull;</span> 禁止转载')):"删除"===b?this.Xl():b in qx&&$.post("/answer/comment_permission",{answer_id:this.qa,permission:b}).done(v(function(b){b&&!b.r&&z.forEach(this.Nv,function(b){b.Sc(b===c)})},this))};
t.Xl=function(){Ci("你确定要删除自己的答案吗？","答案内容不会被永久删除，你还可以撤消本次删除操作。",function(b){b&&(this.pg=j,this.status=-1,yx(this))},this)};a.yx=function(b){var c=new V(j);P(b.g(),c,"success",function(){R(this.e,!this.pg);this.pg?this.Su="set_delete":(sx(this),this.Su="cancel_delete");this.dispatchEvent("change");$(this.e).parent(".zm-item").hide()});c.ajax("/answer/"+(b.pg?"remove":"unremove"),"aid="+b.qa)};t.h=q("e");a.zx=function(){T.call(this)};y(zx,T);t=zx.prototype;t.ao="zm-item-expanded";t.bl="zm-item-answer";t.B=function(){zx.m.B.call(this);this.Fz();this.Ea();this.by();this.Mh();this.dm();!this.Vi&&this.st&&Vt(this.e,this.fR,this)};t.p=function(){this.Vi=k;Vc(this.Be);Vc(this.yI);zx.m.p.call(this)};t.Mh=function(){this.yI=rk(qk(sk.CB(this.e),"o",this.pe,this),{group:"操作",name:"显示全部/收起"})};
t.Fz=function(){var b=this.e,c=this.bl&&J(this.bl,b);c&&(this.qa=c.getAttribute("data-aid"),this.fm=c.getAttribute("data-isowner"),this.dZ=c.getAttribute("data-atoken"));this.Y=b.getAttribute("data-qid");if(!(b=b.getAttribute("data-qtoken")))b=(b=J("question_link",this.e))&&b.pathname.split("/")[2];this.st=b;this.Vi=c};t.by=function(){var b=J("zm-item-answer-author-wrap",this.e),b=J("zm-list-avatar",b);Zj.add(b)};t.ac=function(){return D.has(this.e,this.ao)};t.pe=function(){this.La(!this.ac())};
a.Ax=function(b,c){$(".feed-question-detail-item",b.e).toggleClass("question-detail-expanded",c)};t.La=function(b){b!==this.ac()&&(b||(ft(this.Be.h()),Ax(this,n)),D.enable(this.e,this.ao,b),b&&At(this.e).height<$b().height&&1<$("a.collapse",this.e).length&&$("a.collapse",this.e).eq(0).remove(),this.Vi&&b&&this.dm(),this.Vi&&this.Be&&(this.Be.vA(b),this.Be.Xp.La(b)),this.dispatchEvent(b?"expand":"collapse"))};t.Ea=function(){this.g().c(this.e,"click",this.ha)};
t.ha=function(b){var b=b.target,c=b.name;if(!c){b=Kc(b,"A");if(!b||!b.name)return;c=b.name}this.Sa=b;var d="new"===$("#feed-ver").val()?j:n;switch(c){case "expand":this.La(j);if(d||this.fm)b.name="toggleExpanded";break;case "toggleExpanded":this.pe();break;case "expandQuestionDetail":Ax(this,j);break;case "complex":this.La(j);break;case "collapse":this.La(n);break;case "focus":d&&Nk("follow","follow_question","v2");Kk(this.Sa,"question",v(this.NP,this),i,{follow_text:"关注问题"});break;case "follow-p":c=
b;Kk(this.Sa,"people",xa(Ck,c),i,{follow_text:c.getAttribute("data-follow_text")});break;case "ignore":Y.V({type:"ga_click_question_ignore",target:b});this.dispatchEvent({type:"ignore",Y:this.Y});"ROUNDTABLE_FOLLOW"===this.e.getAttribute("data-feedtype")?(c=this.e.getAttribute("data-rtoken"),$.post("/roundtable/"+c,{action:"mute"})):$.post("/question/uninterest",{qid:this.Y});break;case "share":this.Be||this.de();break;case "toggle-comment":this.Ji&&this.Ji(),this.na.ac()&&this.na.Ki("view_comments",
parseInt(Hc(b),10)||0)}this.Sh&&this.Sh(b)};t.NP=function(){this.Sa&&Ck(this.Sa)};t.fR=function(){Fu("question",this.st,"touch")};t.dm=function(){if(this.Vi){this.Be=new px(this.Y,{Xb:this.st},this.qa);var b=J("zm-item-meta",this.e);this.Be.Qb=b;this.J(this.Be);this.Be.n(this.Vi);b=this.Be.Xp;this.g().c(b,"expand",function(){this.La(j)});this.dm=ha}};t.Om=ca("Sh");a.Bx=function(b,c,d){pu.call(this,b,c,d)};y(Bx,pu);Bx.prototype.ck=function(b){var c=new zx;this.J(c);c.n(b);c.La(n)};
a.Cx=function(){T.call(this);this.na=k};y(Cx,zx);t=Cx.prototype;t.bl="entry-body";t.p=function(){Vc(this.na);Cx.m.p.call(this)};t.Mh=function(){Cx.m.Mh.call(this);var b=this.yI;this.Vi||rk(qk(rk(qk(rk(qk(b,"c",this.Ji,this),{group:"操作",name:"打开评论"}),"f x",this.de,this),{group:"操作",name:"分享"}),"shift+c",this.Ax,this),{group:"操作",name:"定位到评论框"});rk(qk(b,"shift+o",this.cT,this),{group:"操作",name:"新窗口打开条目"});this.e.getAttribute("tabindex")===k&&(this.e.tabIndex="-1")};
t.cT=function(){window.open($(".question_link",this.e).attr("href"))};t.de=function(){var b=Cu.F();b.yk("分享问题","question",this.st,{qid:this.Y});b.show();Du(b,"tb-webshare-sina")};t.Ji=function(){this.na||this.zw();this.na.pe()};t.Ax=function(){this.na?this.na.field.focus():this.Ji()};t.zw=function(){if(!this.na){var b=$(".zm-item-meta",this.e).get(0),c=$(".toggle-comment",this.e)[0];this.na=new Qw(this.Y,"question");this.J(this.na);Tw(this.na,b,c)}};a.Dx=function(b){var c=b.type;if(!la(c))return k;switch(c.toLowerCase()){case "checkbox":case "radio":return b.checked?b.value:k;case "select-one":return c=b.selectedIndex,0<=c?b.options[c].value:k;case "select-multiple":for(var c=[],d,e=0;d=b.options[e];e++)d.selected&&c.push(d.value);return c.length?c:k;default:return la(b.value)?b.value:k}},a.Ex=function(b,c){var d=b.elements[c];if(d.type)return Dx(d);for(var e=0;e<d.length;e++){var g=Dx(d[e]);if(g)return g}return k};a.Fx=function(b){M.call(this);this.e=b;b=ra(this.e)&&1==this.e.nodeType?this.e:this.e?this.e.body:k;this.IQ=!!b&&eg(b);this.dG=N(this.e,B?"DOMMouseScroll":"mousewheel",this)};y(Fx,Hd);
Fx.prototype.handleEvent=function(b){var c=0,d=0,e=0,b=b.Zb;if("mousewheel"==b.type){d=1;if(A||C&&(nb||Gb("532.0")))d=40;e=Gx(-b.wheelDelta,d);la(b.wheelDeltaX)?(c=Gx(-b.wheelDeltaX,d),d=Gx(-b.wheelDeltaY,d)):d=e}else e=b.detail,100<e?e=3:-100>e&&(e=-3),la(b.axis)&&b.axis===b.HORIZONTAL_AXIS?c=e:d=e;pa(this.rG)&&(c=Dt(c,-this.rG,this.rG));pa(this.sG)&&(d=Dt(d,-this.sG,this.sG));this.IQ&&(c=-c);c=new Hx(e,b,c,d);this.dispatchEvent(c)};a.Gx=function(b,c){return C&&(mb||ob)&&0!=b%c?b:b/c};
Fx.prototype.p=function(){Fx.m.p.call(this);Ad(this.dG);delete this.dG};a.Hx=function(b,c,d,e){c&&this.w(c,i);this.type="mousewheel";this.detail=b;this.hj=d;this.ij=e};y(Hx,md);a.Ix=function(){M.call(this)};y(Ix,Hd);t=Ix.prototype;t.Ec=0;t.Wo=0;t.Uo=100;t.Fl=0;t.Dk=1;t.IF=n;t.Zs=n;t.ua=function(b){b=Jx(this,b);this.Ec!=b&&(this.Ec=b+this.Fl>this.Uo?this.Uo-this.Fl:b<this.Wo?this.Wo:b,!this.IF&&!this.Zs&&this.dispatchEvent("change"))};t.X=function(){return Jx(this,this.Ec)};t.Ep=function(b){b=Jx(this,b);this.Fl!=b&&(this.Fl=0>b?0:this.Ec+b>this.Uo?this.Uo-this.Ec:b,!this.IF&&!this.Zs&&this.dispatchEvent("change"))};
t.fi=function(){return this.Dk==k?this.Fl:Math.round(this.Fl/this.Dk)*this.Dk};t.Kc=function(){return Jx(this,this.Wo)};t.Zc=function(){return Jx(this,this.Uo)};t.kx=q("Dk");a.Jx=function(b,c){return b.Dk==k?c:b.Wo+Math.round((c-b.Wo)/b.Dk)*b.Dk};a.Kx=function(b){T.call(this,b);this.kC=k;this.Va=new Ix;N(this.Va,"change",this.TE,n,this)};y(Kx,T);a.Lx=Gd("dragvaluestart"),a.Mx=Gd("dragvalueend"),a.Nx=Gd("dragextentstart"),a.Ox=Gd("dragextentend"),a.Px=Gd("dragstart"),a.Qx=Gd("dragend");t=Kx.prototype;t.Ab="horizontal";t.ys=n;t.wR=n;t.Wf=10;t.Vo=0;t.LF=j;t.jc=j;t.Zd=n;t.o=function(){Kx.m.o.call(this);var b=this.K().o("div",this.O(this.Ab));this.$(b)};
t.$=function(b){Kx.m.$.call(this,b);D.add(b,this.O(this.Ab));var b=this.h(),c=Wb(k,"goog-slider-thumb",b)[0];c||(c=this.K().o("div","goog-slider-thumb"),Oc(c,Xc.wq),b.appendChild(c));this.Ya=this.Dd=c;Oc(this.h(),Xc.tK);Rx(this)};t.B=function(){Kx.m.B.call(this);this.re=new Yg(this.Ya);this.hg=new Yg(this.Dd);this.re.cg(this.Zd);this.hg.cg(this.Zd);this.re.Zv=this.hg.Zv=ha;this.qb=new im(this.h());Sx(this,j);this.h().tabIndex=0;Tx(this)};
a.Sx=function(b,c){c?(b.g().c(b.re,"beforedrag",b.Ur).c(b.hg,"beforedrag",b.Ur).c(b.re,["start","end"],b.bs).c(b.hg,["start","end"],b.bs).c(b.qb,"key",b.tf).c(b.h(),"mousedown",b.zj),b.LF&&Ux(b,j)):(b.g().wa(b.re,"beforedrag",b.Ur).wa(b.hg,"beforedrag",b.Ur).wa(b.re,["start","end"],b.bs).wa(b.hg,["start","end"],b.bs).wa(b.qb,"key",b.tf).wa(b.h(),"mousedown",b.zj),b.LF&&Ux(b,n))};t.$a=function(){Kx.m.$a.call(this);Uc(this.re,this.hg,this.qb,this.$j)};
t.Ur=function(b){var c=b.Ar==this.re?this.Ya:this.Dd,d;"vertical"==this.Ab?(d=this.h().clientHeight-c.offsetHeight,d=(d-b.top)/d*(this.Zc()-this.Kc())+this.Kc()):d=b.left/(this.h().clientWidth-c.offsetWidth)*(this.Zc()-this.Kc())+this.Kc();d=b.Ar==this.re?Math.min(Math.max(d,this.Kc()),this.X()+this.fi()):Math.min(Math.max(d,this.X()),this.Zc());Vx(this,c,d)};
t.bs=function(b){var c="start"==b.type;D.enable(this.h(),"goog-slider-dragging",c);D.enable(b.target.handle,"goog-slider-thumb-dragging",c);b=b.Ar==this.re;c?(this.dispatchEvent(Px),this.dispatchEvent(b?Lx:Nx)):(this.dispatchEvent(Qx),this.dispatchEvent(b?Mx:Ox))};
t.tf=function(b){var c=j;switch(b.keyCode){case 36:Wx(this,this.Kc());break;case 35:Wx(this,this.Zc());break;case 33:Xx(this,this.Wf);break;case 34:Xx(this,-this.Wf);break;case 37:var d=this.Zd&&this.Id()?1:-1;Xx(this,b.shiftKey?d*this.Wf:d*this.dq);break;case 40:Xx(this,b.shiftKey?-this.Wf:-this.dq);break;case 39:d=this.Zd&&this.Id()?-1:1;Xx(this,b.shiftKey?d*this.Wf:d*this.dq);break;case 38:Xx(this,b.shiftKey?this.Wf:this.dq);break;default:c=n}c&&b.preventDefault()};
t.zj=function(b){this.h().focus&&this.h().focus();var c=b.target;!uc(this.Ya,c)&&!uc(this.Dd,c)&&(this.wR?Wx(this,Yx(this,b)):(this.YA(b),this.bf=Zx(this,Yx(this,b)),this.rF="vertical"==this.Ab?this.Js<this.bf.offsetTop:this.Js>$x(this,this.bf)+this.bf.offsetWidth,b=Tb(this.h()),this.g().c(b,"mouseup",this.VA,j).c(this.h(),"mousemove",this.YA),this.ki||(this.ki=new Jd(200),this.g().c(this.ki,Kd,this.YE)),this.YE(),this.ki.start()))};t.PE=function(b){Xx(this,(0<b.detail?-1:1)*this.dq);b.preventDefault()};
t.YE=function(){var b;if("vertical"==this.Ab){var c=this.Js,d=this.bf.offsetTop;this.rF?c<d&&(b=ay(this,this.bf)+this.Wf):c>d+this.bf.offsetHeight&&(b=ay(this,this.bf)-this.Wf)}else c=this.Js,d=$x(this,this.bf),this.rF?c>d+this.bf.offsetWidth&&(b=ay(this,this.bf)+this.Wf):c<d&&(b=ay(this,this.bf)-this.Wf);la(b)&&Vx(this,this.bf,b)};t.VA=function(){this.ki&&this.ki.stop();var b=Tb(this.h());this.g().wa(b,"mouseup",this.VA,j).wa(this.h(),"mousemove",this.YA)};
a.by=function(b,c){var d=jg(c,b.h());return"vertical"==b.Ab?d.y:b.Zd&&b.Id()?b.h().clientWidth-d.x:d.x};t.YA=function(b){this.Js=by(this,b)};
a.Yx=function(b,c){var d=b.Kc(),e=b.Zc();if("vertical"==b.Ab){var g=b.Ya.offsetHeight,h=b.h().clientHeight-g,g=by(b,c)-g/2;return(e-d)*(h-g)/h+d}g=b.Ya.offsetWidth;h=b.h().clientWidth-g;g=by(b,c)-g/2;return(e-d)*g/h+d},a.ay=function(b,c){if(c==b.Ya)return b.Va.X();if(c==b.Dd)return b.Va.X()+b.Va.fi();f(Error("Illegal thumb element. Neither minThumb nor maxThumb"))},a.Xx=function(b,c){var d=ay(b,b.Ya)+c,e=ay(b,b.Dd)+c,d=Dt(d,b.Kc(),b.Zc()-b.Vo),e=Dt(e,b.Kc()+b.Vo,b.Zc());cy(b,d,e-d)},a.Vx=function(b,
c,d){var e=k;c==b.Dd&&(d<=b.Va.Zc()&&d>=b.Va.X()+b.Vo)&&(e=d-b.Va.X());var g=e||b.Va.fi();c==b.Ya&&(d>=b.Kc()&&d<=b.Va.X()+g-b.Vo)&&(c=g-(d-b.Va.X()),Jx(b.Va,d)+Jx(b.Va,c)==Jx(b.Va,d+c)&&(cy(b,d,c),e=k));e!=k&&b.Va.Ep(e)},a.cy=function(b,c,d){b.Kc()<=c&&(c<=b.Zc()-d&&b.Vo<=d&&d<=b.Zc()-c)&&!(c==b.X()&&d==b.fi())&&(b.Va.Zs=j,b.Va.Ep(0),b.Va.ua(c),b.Va.Ep(d),b.Va.Zs=n,b.TE())};t.Kc=function(){return this.Va.Kc()};t.Zc=function(){return this.Va.Zc()};
a.Zx=function(b,c){return c<=b.Va.X()+b.Va.fi()/2?b.Ya:b.Dd};t.TE=function(){Tx(this);Rx(this);this.dispatchEvent("change")};
a.Tx=function(b){if(b.Ya&&!b.ys){var c=dy(b,ay(b,b.Ya)),d=dy(b,ay(b,b.Dd));if("vertical"==b.Ab)b.Ya.style.top=c.y+"px",b.Dd.style.top=d.y+"px",b.Rb&&(c=ey(d.y,c.y,b.Ya.offsetHeight),b.Rb.style.top=c.offset+"px",b.Rb.style.height=c.size+"px");else{var e=b.Zd&&b.Id()?"right":"left";b.Ya.style[e]=c.x+"px";b.Dd.style[e]=d.x+"px";b.Rb&&(c=ey(c.x,d.x,b.Ya.offsetWidth),b.Rb.style[e]=c.offset+"px",b.Rb.style.width=c.size+"px")}}},a.ey=function(b,c,d){var e=Math.ceil(d/2);return{offset:b+e,size:Math.max(c-
b+d-2*e,0)}},a.dy=function(b,c){var d=new Ob;if(b.Ya){var e=b.Kc(),g=b.Zc(),g=c==e&&e==g?0:(c-e)/(g-e);"vertical"==b.Ab?(e=b.h().clientHeight-b.Ya.offsetHeight,g=Math.round(g*e),d.x=$x(b,b.Ya),d.y=e-g):(e=Math.round(g*(b.h().clientWidth-b.Ya.offsetWidth)),d.x=e,d.y=b.Ya.offsetTop)}return d},a.Wx=function(b,c){c=Dt(c,b.Kc(),b.Zc());b.ys&&b.nr.stop(j);var d=new $m,e,g=Zx(b,c),h=b.X(),l=b.fi(),m=ay(b,g),p=dy(b,m);e=b.kx();Math.abs(c-m)<e&&(c=Dt(m+(c>m?e:-e),b.Kc(),b.Zc()));Vx(b,g,c);m=dy(b,ay(b,g));
e="vertical"==b.Ab?[$x(b,g),m.y]:[m.x,g.offsetTop];p=new ut(g,[p.x,p.y],e,100);p.cg(b.Zd);d.add(p);if(b.Rb){var p=dy(b,h),r=dy(b,h+l),l=p;e=r;g==b.Ya?l=m:e=m;"vertical"==b.Ab?(g=ey(r.y,p.y,b.Ya.offsetHeight),l=ey(e.y,l.y,b.Ya.offsetHeight),m=new ut(b.Rb,[$x(b,b.Rb),g.offset],[$x(b,b.Rb),l.offset],100),g=new st(b.Rb,g.size,l.size,100)):(g=ey(p.x,r.x,b.Ya.offsetWidth),l=ey(l.x,e.x,b.Ya.offsetWidth),m=new ut(b.Rb,[g.offset,b.Rb.offsetTop],[l.offset,b.Rb.offsetTop],100),g=new tt(b.Rb,g.size,l.size,100));
m.cg(b.Zd);g.cg(b.Zd);d.add(m);d.add(g)}b.kC&&(h=b.kC.zZ(h,c,100),z.forEach(h,function(b){d.add(b)}));b.nr=d;b.g().c(d,"end",b.sN);b.ys=j;d.play(n)};t.sN=function(){this.ys=n};t.Hp=function(b){if(this.Ab!=b){var c=this.O(this.Ab),d=this.O(b);this.Ab=b;this.h()&&(D.tV(this.h(),c,d),b=this.Zd&&this.Id()?"right":"left",this.Ya.style[b]=this.Ya.style.top="",this.Dd.style[b]=this.Dd.style.top="",this.Rb&&(this.Rb.style[b]=this.Rb.style.top="",this.Rb.style.width=this.Rb.style.height=""),Tx(this))}};
t.p=function(){Kx.m.p.call(this);this.ki&&this.ki.G();delete this.ki;this.nr&&this.nr.G();delete this.nr;delete this.Ya;delete this.Dd;this.Rb&&delete this.Rb;this.Va.G();delete this.Va;this.qb&&(this.qb.G(),delete this.qb);this.$j&&(this.$j.G(),delete this.$j);this.re&&(this.re.G(),delete this.re);this.hg&&(this.hg.G(),delete this.hg)};t.dq=1;t.kx=function(){return this.Va.kx()};t.X=function(){return this.Va.X()};t.ua=function(b){Vx(this,this.Ya,b)};t.fi=function(){return this.Va.fi()};
t.Ep=function(b){Vx(this,this.Dd,this.Va.X()+b)};t.z=function(b){R(this.h(),b);b&&Tx(this)};a.Rx=function(b){var c=b.h();if(c){var d=b.Kc();Pc(c,Wc.GK,d);d=b.Zc();Pc(c,Wc.FK,d);b=b.X();Pc(c,Wc.HK,b)}},a.Ux=function(b,c){c?(b.$j||(b.$j=new Fx(b.h())),b.g().c(b.$j,"mousewheel",b.PE)):b.g().wa(b.$j,"mousewheel",b.PE)};t.eb=function(b){if(this.jc!=b&&this.dispatchEvent(b?"enable":"disable"))this.jc=b,Sx(this,b),b||this.VA(),D.enable(this.h(),"goog-slider-disabled",!b)};t.isEnabled=q("jc");
a.$x=function(b,c){return b.Zd?Xg(c):c.offsetLeft};a.fy=function(b){Kx.call(this,b);this.Va.Ep(0)};y(fy,Kx);fy.prototype.O=function(b){return"vertical"==b?"goog-slider-vertical":"goog-slider-horizontal"};a.gy=function(b){this.options=$.extend({},this.R,b)};y(gy,T);t=gy.prototype;t.R={gD:310,hD:310,Gg:250,Hg:250,kR:2,opacity:0.25,s0:"#eee"};t.$=function(b){gy.m.$.call(this,b);this.src=this.e.src;this.options.src=this.src;this.options.dn=(this.options.gD-this.options.Gg)/2;this.options.cn=(this.options.hD-this.options.Hg)/2;this.kr()};
t.kr=function(){var b=this.options;this.DB=$(Pk('            <div class="avatar-editor-container" style="width:<%=containerWidth%>px">              <div class="avatar-editor-container-inner" style="height:<%=containerHeight%>px;">                <div class="avatar-editor-window" style="height:<%=windowHeight%>px;width:<%=windowWidth%>px;margin:<%=windowMarginTop%>px <%=windowMarginLeft%>px;">                  <div class="avatar-editor-window-shadow" style="height:<%=windowHeight%>px;width:<%=windowWidth%>px;"></div>                  <div class="avatar-editor-window-inner" style="width:<%=containerWidth%>px; height:<%=containerHeight%>px;margin:-<%=windowMarginTop%>px 0 0 -<%=windowMarginLeft%>px;">                    <img class="inner" title="拖动相片"/>                  </div>                </div>                <img class="outer" style="opacity:<%=opacity%>;"/>              </div>              <div class="goog-slider-wrap">                  <i class="zg-icon image-minus"></i>                  <i class="zg-icon image-plus"></i>                  <div class="goog-slider">                      <div class="line"></div>                      <div class="goog-slider-thumb"></div>                  </div>              </div>            </div>',{containerWidth:b.hD,
containerHeight:b.gD,windowHeight:b.Gg,windowWidth:b.Hg,windowMarginTop:b.dn,windowMarginLeft:b.cn,src:b.src,opacity:b.opacity}));this.Kb=this.DB[0];this.DB.insertBefore(this.e);R(this.e,n);this.GM=J("avatar-editor-container-inner",this.Kb);this.ns=J("outer",this.Kb);this.Wx=J("inner",this.Kb);this.gn=$(this.ns);this.Cu=$(this.Wx);this.nF=0;this.gn.load(v(this.iJ,this));this.Cu.load(v(this.iJ,this));this.Wx.src=this.ns.src=this.options.src;this.eV=J("goog-slider",this.Kb)};
t.B=function(){this.OA=new fy;this.OA.n(this.eV);this.g().c(this.GM,["mousedown","touchstart"],function(b){var c=new Yg(this.Kb);c.addEventListener("drag",v(function(b){var c=this.zoom;this.Ue={lq:this.options.Hg/c,mo:this.options.Gg/c,x:(this.options.cn-(this.AF.left+(b.clientX-this.Zt)))/c,y:(this.options.dn-(this.AF.top+(b.clientY-this.$t)))/c};hy(this)},this));c.addEventListener("end",v(function(){c.G()},this));c.Xm(b);this.Xm(b)});this.g().c(this.Kb,["touchmove"],function(b){b.stopPropagation();
b.preventDefault()});this.g().c(this.OA,"change",function(){var b=this.OA.X(),c=this.IJ;iy(this,(this.DW-c)*b/100+c)})};a.iy=function(b,c){b.q_=b.zoom;b.zoom=c;jy(b,b.Ue.lq/2+b.Ue.x,b.Ue.mo/2+b.Ue.y)},a.jy=function(b,c,d){var e=b.zoom;b.Ue={lq:b.options.Hg/e,mo:b.options.Gg/e,x:c-b.options.Hg/e/2,y:d-b.options.Gg/e/2};hy(b)};t.iJ=function(){this.fQ||(this.Wx.complete&&this.ns.complete?this.w():(this.nF++,2<=this.nF&&this.w()))};
t.w=function(){this.ms=this.gn.width();this.ls=this.gn.height();var b=this.options.Hg/this.ms,c=this.options.Gg/this.ls;this.IJ=b=c>b?c:b;this.DW=this.IJ*this.options.kR;this.Ue={mo:this.options.Hg/b,lq:this.options.Gg/b,x:0,y:0};iy(this,b);jy(this,this.ms/2,this.ls/2);this.fQ=j};t.Xm=function(b){this.Zt=b.clientX;this.$t=b.clientY;this.AF=this.Cu.position();this.K_=this.gn.position()};
a.hy=function(b){var c=b.zoom,d=Dt(b.options.cn-b.Ue.x*c,b.options.Hg+b.options.cn-b.ms*c,b.options.cn),e=Dt(b.options.dn-b.Ue.y*c,b.options.Gg+b.options.dn-b.ls*c,b.options.dn),g={width:c*b.ms,height:c*b.ls,left:d,top:e};b.gn.css(g);b.Cu.css(g);b.Ue.x=(b.options.cn-d)/c;b.Ue.y=(b.options.dn-e)/c};t.support=function(){return"getContext"in document.createElement("canvas")&&n};a.ly=function(b,c,d){T.call(this);this.Nq=b||ky;this.uN=c;this.mU=d||"l"};y(ly,T);a.ky=1;t=ly.prototype;t.$=function(b){this.e=b;S.Ia()&&(S.ye||this.Nq===ky)?this.o():$(b).click($.proxy(this.lR,this))};
t.o=function(){this.Uk=$(Pk('            <form target="av_up_frame" style="display:none;" method="post" enctype="multipart/form-data" action="<%=uploadAction%>">                <label for="avt_file"></label>                <input type="file" accept="image/*" name="picture" id="avt_file" />                <input type="hidden" name="handle_mode" value="server1" />            </form>',{uploadAction:"/upload"}));this.LJ=$('<iframe id="av_up_frame" src="about:_blank" name="av_up_frame" style="position: absolute; height: 0px; width: 0px; left: -9000px;"></iframe>');
this.LJ.appendTo(document.body);this.input=this.Uk.find("input[type=file]")[0];A?(this.Uk.find("label").html($(this.e).html()),this.e.innerHTML="",$(this.e).append(this.Uk),this.Uk.addClass("avatar-editor-form-ie")):(this.Uk.insertAfter(this.e),$(this.e).click($.proxy(function(){this.input.click()},this)));this.g().c(this.input,"change",this.Ve)};t.lR=function(){return S.Ia()&&!S.ye&&this.Nq!==ky?(zl.F().z(j),n):!S.Ia()?(Jk.F().z(j),n):j};
t.Ve=function(b){b=this.input=b.target;this.cm=this.Vx=this.Hj="";if(this.hf)this.hf.oa();else{this.hf=new yi(k,n);this.hf.fb("修改图片");var c=Mh.RJ,d=Mh.JK,e=new Eh;e.set(c,"取消",n,j).set(d,"确定",j);Ih(this.hf,e);this.g().c(this.hf,Jh,function(b){if(b.key===d){if(this.On.support()){var c=this.On,b=$("<canvas>",{width:c.options.Hg,height:c.options.Gg}),e=b[0];$(document.body).append(e);var m=b[0].getContext("2d"),p=c.Ue;m.drawImage(c.ns,p.x,p.y,p.lq,p.mo,0,0,c.options.Hg,c.options.Gg);c=e.toDataURL("image/png");
b.remove();b=c}else b=this.On.Ue;this.Hj=b;my(this);this.hf.z(n);return n}})}e=this.hf.ba();c=$("<div class='new-avatar-editor-loading'><div><span></span></div><div>正在上传...</div></div>");e=$(e);e.html("");e.append(c);this.hf.z(j);D.add(this.hf.e,"avatar-edit-dialog");window.FileReader&&(b.files&&b.files[0])&&(this.file=b=b.files[0],c=new window.FileReader,c.onload=v(function(b){this.cm=b.target.result;this.jp()},this),c.readAsDataURL(b));this.g().c(Y,"iframe_data",function(b){(b=b.nb)&&!b.r?(this.cm=
b.data.pic_url,this.Vx=b.data.hashval,window.FileReader||this.jp(),my(this)):U(b.msg)});this.Uk[0].submit();b=this.input.cloneNode();oc(b,this.input);this.input=b;this.g().c(this.input,"change",this.Ve)};t.jp=function(){var b=this.hf.ba();this.Ux=new Image;this.Ux.src=this.cm;b=$(b);b.html("");b.append(this.Ux);this.On=new gy;this.On.n(this.Ux)};
a.my=function(b){if(b.Vx&&b.Hj){b.dispatchEvent("beforepost");var c={type:b.Nq,dest_id:b.Nq===ky?S[3]:b.uN,return_size:b.mU},c=b.On.support()?$.extend(c,{handle_mode:"client",pic_body:b.Hj.replace(/data\:image\/\w{3,4};base64,/,""),fileName:b.file.name}):$.extend(c,{handle_mode:"server2",x:Math.round(b.Hj.x),y:Math.round(b.Hj.y),height:Math.round(b.Hj.mo),width:Math.round(b.Hj.lq),hashval:b.Vx});$.post("/upload",c,$.proxy(function(b){b&&!b.r?this.data=b.msg:U(b.msg);this.dispatchEvent({type:"success",
src:this.data});this.hf.z(n)},b),"json")}};t.getData=function(){return!this.data?k:/(\w*)_\w/.exec(this.data)[1]};a.ny=function(){T.call(this)};y(ny,T);ny.prototype.$=function(b){ny.m.$.call(this,b);this.g().c(Y,"sina_callback",this.qm);this.g().c(Y,"qq_callback",this.qm);this.g().c(Y,"qqconn_callback",this.qm);this.g().c(H("zh-setting-page-bind-sina-unbindbtn"),"click",this.uz);this.g().c(H("zh-setting-page-bind-qq-unbindbtn"),"click",this.uz);this.g().c(H("zh-setting-page-bind-qqconn-unbindbtn"),"click",this.uz)};
ny.prototype.qm=function(b){if("qq_callback"===b.type){var c=Tg.name=b.nb.name,b=Tg.id=b.nb.id;H("zh-setting-page-bind-qqname").innerHTML='<a href="http://t.qq.com/'+b+'" target="_blank">@'+c+"</a>";oy(j)}else"sina_callback"===b.type?(c=Sg.name=b.nb.name,b=Sg.id=b.nb.id,H("zh-setting-page-bind-sinaname").innerHTML='<a href="http://weibo.com/'+b+'" target="_blank">@'+c+"</a>",py(j)):"qqconn_callback"===b.type&&(H("zh-setting-page-bind-qqconnname").innerHTML=b.nb.name,qy(j))};
ny.prototype.uz=function(b){var c=b.target.getAttribute("data-weibotype");if(window.confirm("你确定要解除与"+{sina:"新浪微博",qq:"腾讯微博",qqconn:" QQ "}[c]+"的绑定吗？")){var d=new V(j);P(this.g(),d,"success",function(){var b=Ie(d);b&&!b.r?"sina"===c?py():"qq"===c?oy():"qqconn"===c&&qy():U(b.msg)});d.ajax("/oauth/unbind/"+c)}};
a.py=function(b){R(H("zh-setting-page-bind-sina-binded-wrap"),!!b);R(H("zh-setting-page-bind-sina-tobind-wrap"),!b)},a.oy=function(b){R(H("zh-setting-page-bind-qq-binded-wrap"),!!b);R(H("zh-setting-page-bind-qq-tobind-wrap"),!b)},a.qy=function(b){R(H("zh-setting-page-bind-qqconn-binded-wrap"),!!b);R(H("zh-setting-page-bind-qqconn-tobind-wrap"),!b)};a.ry=function(){T.call(this)};y(ry,T);t=ry.prototype;
t.$=function(b){ry.m.$.call(this,b);if(b=J("profile-edit-avatar-btn"))this.un=new ly,this.un.n(b),this.g().c(this.un,"beforepost",function(){$(".zm-avatar-editor-preview").parent().append($("<div class='avatar-edit-preview-loading'><span></span></div>"))}),this.g().c(this.un,"success",function(b){$("img.zm-avatar-editor-preview").attr("src",b.src);$(".avatar-edit-preview-loading").remove()});this.M=[];var c=this;$(".editable-group",this.e).each(function(){var b=new Im;c.M.push(b);b.n(this)});b=H("zm-profile-edit-submit");
this.g().c(b,"click",this.sz);(new ny).n(this.e);$(this.e).on("change","input, textarea, select",function(){c.Vd()})};
t.B=function(){ry.m.B.call(this);var b=H("zm-profile-progress-anim"),c=new sy;c.addEventListener("update",function(){var d=100*c.X()|0;10>d&&(d=10);b.style.width=b.innerHTML=d+"%"});z.forEach(this.M,function(b,d){c.watch({name:"name"+d,target:b,$h:["add","remove"],Uh:function(){return!!b.yd.children().length}})},this);var d=this.e,e=H("zm-profile-edit-male"),g=H("zm-profile-edit-female"),h=H("zm-profile-edit-description"),l=$(".business-selection select")[0],m=H("zm-profile-edit-expert-disable");
c.watch({name:"expert_progress",target:H("zm-profile-edit-expert-enable"),$h:["change"],Uh:function(){return k!==Ex(d,"enable_expert")}}).watch({name:"expert_progress",target:m,$h:["change"],Uh:function(){return k!==Ex(d,"enable_expert")}}).watch({name:"gender_progress",target:e,$h:["change"],Uh:function(){return k!==Ex(d,"gender")}}).watch({name:"gender_progress",target:g,$h:["change"],Uh:function(){return k!==Ex(d,"gender")}}).watch({name:"desc_progress",target:h,$h:["blur"],Uh:function(){return!!La(h.value)}}).watch({name:"business_progress",
target:h,$h:["blur"],Uh:function(){return!!La(h.value)}}).watch({name:"headline_progress",target:l,$h:["blur"],Uh:function(){return!!La(l.value)}})};t.Vd=function(){$(window).on("beforeunload.profileedit",v(s("你的更改还未保存，确认离开该页面吗？"),this))};t.Ie=function(){$(window).off("beforeunload.profileedit")};
t.sz=function(){function b(b){U(ma(b)?b[0][1]:b)}var c=$("#zm-profile-edit-male").is(":checked")?1:0,d=$("#zm-profile-edit-headline").val(),e=$("#zm-profile-edit-description").val(),g=$(".business-selection select").val(),h=[];$("#zm-profile-edit-loc-container").children().each(function(){h.push($(this).data("title"))});var l=[];$("#zm-profile-edit-co-container").children().each(function(){var b=$(this);l.push([b.data("title"),b.data("sub-title")||""])});var m=[];$("#zm-profile-edit-edu-container").children().each(function(){var b=
$(this);m.push([b.data("title"),b.data("sub-title")||""])});var p=$("#zm-profile-edit-weibo-enable").is(":checked")?1:0,r=$("#zm-profile-edit-expert-enable").is(":checked")?1:0,c=E.filter({avatar_path:this.un?this.un.getData():k,gender:c,headline:d,description:e,location:h,business:g,employment:l,education:m,enable_weibo:p,enable_expert:r},is),x=v(function(){this.Ie();window.location.href="/people/"+S[1]+"/about"},this),d=new V(j);d.addEventListener("complete",function(){var c;try{c=Ie(this)}catch(d){}c&&
!c.r&&qa(x)?x.call(this,c):qa(b)&&b.call(this,c.msg)});d.ajax("/people/edit","data="+encodeURIComponent(ad(c)))};a.sy=function(){this.Hz={}};y(sy,Hd);sy.prototype.update=function(b,c){this.Hz[b]=c;this.dispatchEvent({type:"update"});return this};sy.prototype.watch=function(b){var c=v(function(){this.update(b.name,b.Uh())},this);N(b.target,b.$h,c);c();return this};sy.prototype.X=function(){var b=E.Ka(this.Hz);return b.length&&z.filter(b,Boolean).length/b.length};a.ty=function(){this.nj="editing";T.call(this)};y(ty,T);ty.prototype.$=function(b){ty.m.$.call(this,b);this.L=$(b);this.L.on("click",'a[href^="javascript"]',$.proxy(this.ha,this));this.L.on("click",'a[href^="javascript"], input',n);this.L.on("click",".item",$.proxy(this.bT,this))};a.uy=function(b,c,d){if(!Dg.Oc||navigator.userAgent.match(/iPad/i)!=k)b=$(".item",b.L).index(c),c.siblings().eq(b-b%2).height(d?"auto":c.height())};
ty.prototype.bT=function(b){var c=$(b.currentTarget),d=c.data("href"),b=b.metaKey||b.ctrlKey;d&&!c.hasClass(this.nj)&&(b?window.open(d):location.href=d)};
ty.prototype.ha=function(b){var c=$(b.currentTarget),d=c.closest(".item"),b=c.attr("name");if("edit"===b)c.closest(".description").hide().siblings(".description-edit").show().find("input").focus().closest(".item").addClass(this.nj).closest(".skilled-topics").addClass(this.nj),uy(this,d);else if("cancel"===b)c.closest(".description-edit").hide().siblings(".description").show().closest(".item").removeClass(this.nj).closest(".skilled-topics").removeClass(this.nj),uy(this,d,j);else if("save"===b){var e=
new V(j);this.g().c(e,"success",function(){var b=Ie(e);b.r?U(b.msg):(c.closest(".description-edit").hide().siblings(".description").show().children(".des").text(b.msg).siblings(".edit").addClass("zu-edit-button").children(".edit-msg").html("修改").closest(".item").removeClass(this.nj).closest(".skilled-topics").removeClass(this.nj),uy(this,d,j))});e.ajax("/topic/bio/update","tid="+c.closest(".item").data("id")+"&bio="+c.parent().siblings("input").val(),"POST")}};a.vy=function(){T.call(this)};y(vy,T);
vy.prototype.$=function(b){vy.m.$.call(this);if(b&&(this.L=$(b),$(".editable-group",this.L).each(function(){(new wy).n(this)}),(b=H("profile-header-description-input"))&&new Po(b),(b=J("zm-profile-header-avatar-container"))&&D.has(b,"self"))){var c=new ly(ky);c.n(b);this.g().c(c,"beforepost",function(){$(".zm-avatar-editor-preview").parent().append($("<div class='avatar-edit-preview-loading'><span></span></div>"))});this.g().c(c,"success",function(b){b.src&&(J("zm-avatar-editor-preview").src=b.src,
nt("ProfileHeaderV2","save",{data:{avatar_path:c.getData()}},function(){$(".avatar-edit-preview-loading").remove()}))})}};a.wy=function(){T.call(this)};y(wy,T);t=wy.prototype;t.$=function(b){wy.m.$.call(this);this.L=$(b);this.ue=$(".info-wrap",this.L);this.Pd=$(".edit-wrap",this.L);this.GW=$(".title",this.ue);this.FW=$("input",this.Pd)};
t.B=function(){wy.m.B.call(this);this.L.on("click","[name='edit']",$.proxy(function(){this.L.addClass("editing");var b=this.Pd.find("input").get(0);b?b.focus():(b=this.Pd.find("textarea").get(0))&&b.focus()},this));var b=this;this.Aq=[];$("input[type=text]",this.L).each(function(){var c=new Jm("/topic/autocomplete",this,$(this).parents(".topic-input-wrap")[0]);b.Aq.push(c)});this.Pd.on("keydown","input",function(b){13===b.keyCode&&setTimeout(function(){var c=$(b.target),g=c.parents(".edit-wrap").children().index(c.parent()),
h=c.parents(".edit-wrap").find("input, select").get(g+1),g=c.parents(".edit-wrap").find("input, select").get(g-1);c.val()&&(h?h.focus():g&&!$(g).val()&&g.focus())})});this.Pd.on("click","[name='cancel'], [name='save']",$.proxy(function(b){b=b.target.name;"cancel"===b?this.cancel():"save"===b&&this.save()},this));var c=$(".fold-wrap");c.click(function(b){"fold"===b.target.name?c.addClass("fold"):"unfold"===b.target.name&&c.removeClass("fold")})};
t.save=function(){var b=this.L.data("name");if("location"===b){var b=this.Pd.find("input.location"),c=this.Pd.find("select"),d=this.Pd.find("input.male").is(":checked")?1:0;nt("ProfileHeaderV2","save",{data:{location:[b.val()],business:c.val(),gender:d}},function(b){b=b.msg;b.location[0].html||(b.location[0].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写居住地</a>");b.business.html||(b.business.html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写行业</a>");
this.ue.find("span.location").attr("title",b.location[0].text).html(b.location[0].html);this.ue.find("span.business").attr("title",b.business.text).html(b.business.html);this.ue.find("i.gender").removeClass("male female").addClass(1===parseInt(b.gender,10)?"male":"female");this.cancel()},this.ui,this)}else"employment"===b?(c=this.Pd.find("input.employment"),b=this.Pd.find("input.position"),c=c.val(),b=b.val(),nt("ProfileHeaderV2","save",{data:{employment:[[c,b]]}},function(b){b=b.msg;!b.employment[0][0].text&&
!b.employment[0][1].text?this.L.addClass("empty"):this.L.removeClass("empty");b.employment[0][0].html||(b.employment[0][0].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写公司信息</a>");b.employment[0][1].html||(b.employment[0][1].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写职位</a>");this.ue.find(".employment").attr("title",b.employment[0][0].text).html(b.employment[0][0].html);this.ue.find(".position").attr("title",b.employment[0][1].text).html(b.employment[0][1].html);
this.cancel()},this.ui,this)):"education"===b?(c=[this.Pd.find("input.education"),this.Pd.find("input.education-extra")],b=c[0].val(),c=c[1].val(),nt("ProfileHeaderV2","save",{data:{education:[[b,c]]}},function(b){b=b.msg;!b.education[0][0].text&&!b.education[0][1].text?this.L.addClass("empty"):this.L.removeClass("empty");b.education[0][0].html||(b.education[0][0].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写学校信息</a>");b.education[0][1].html||(b.education[0][1].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写专业</a>");
this.ue.find(".education").attr("title",b.education[0][0].text).html(b.education[0][0].html);this.ue.find(".education-extra").attr("title",b.education[0][1].text).html(b.education[0][1].html);this.cancel()},this.ui,this)):"description"===b&&(b=this.Pd.find("textarea.description"),nt("ProfileHeaderV2","save",{data:{description:b.val()}},function(b){b=b.msg;b.description.text?this.L.removeClass("empty"):(b.description.fold_html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写个人简介</a>",
b.description.unfold_html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写个人简介</a>",this.L.addClass("empty"));this.ue.find(".fold-item .content").empty().html(b.description.fold_html);this.ue.find(".unfold-item .content").html(b.description.unfold_html);b.description.shortened?this.ue.removeClass("disable-fold"):this.ue.addClass("disable-fold");this.cancel()},this.ui,this))};t.ui=function(b){U(b.msg)};t.cancel=function(){this.L.removeClass("editing")};a.xy=function(){M.call(this);this.gh="zm-item";this.nZ="zm-item-top-btn";this.vU=j};y(xy,el);t=xy.prototype;t.w=function(b){this.Kb=b;this.g().c(b,"click",this.ha);this.refresh()};t.If=ca("gh");
t.ha=function(b){if(b.target){var c=Gk(this.Kb,b.target);c&&(this.type=c.getAttribute("data-type"),this.id=c.getAttribute("data-id"),this.action=c.name,this.item=Kc(b.target,k,this.gh),this.type&&(this.id&&this.action&&this.item)&&(this.HJ||(this.HJ=j,this.xhr=new V(j),this.g().c(this.xhr,"complete",this.Af),this.xhr.ajax("/people/"+("top"===this.action?"pin":"unpin")+"_"+this.type,this.type+"_id="+this.id,"POST")),this.lZ=c))}};
t.Af=function(){if("cancel-top"===this.action)vk(this.item,j);else if("top"===this.action){var b=Xb(this.gh,this.Kb);this.P_=dg(this.item).y;b&&2<=b.length&&lc(L(this.item),J(this.gh,this.Kb));this.scroll();Ck(this.item);R(J("zm-item-top-btn-top",this.item),n);R(J("zm-item-top-btn-cancel",this.item),j);this.refresh()}this.HJ=n};t.scroll=function(){if(this.vU){var b=J("zm-profile-section-wrap"),c=Nc(Ub((fa||window).document)).y;b&&0>dg(b).y-c&&b.scrollIntoView()}};
t.refresh=function(){var b=Xb(this.gh,this.Kb);b&&0<b.length&&z.forEach(b,function(b,d){if(0!==d){var e=J("zm-item-top-btn-top",b);e&&R(e,j)}},this)};a.yy=function(b,c){b.g().c(c,"next",b.refresh)};a.zy=function(){this.Qw=["zg-btn-follow","zg-btn-unfollow"];this.Rw="people"};y(zy,T);zy.prototype.B=function(){this.g().c(this.e,"click",this.ha)};zy.prototype.ha=function(b){var c=Gk(this.e,b.target);this.Sh&&this.Sh(c);c&&(c.name&&"focus"===c.name)&&Kk(c,this.Rw,function(){c.getAttribute("data-focusme")&&(D.has(c,"zg-btn-follow")?c.setAttribute("data-tip","s$b$对方已关注你"):c.setAttribute("data-tip","s$b$已互相关注"))},this.Qw,{QZ:"question"===this.Rw?"关注问题":k})};zy.prototype.Om=ca("Sh");a.By=function(b,c,d,e){M.call(this);this.Ud=b;this.Yh=c;this.tg=d;this.PD=e||Ay;b.maxLength=d;this.Oj=new wu(b);N(this.Oj,"input",this.cp,n,this);this.aj()};y(By,Hd);a.Ay=0;By.prototype.cp=function(){this.aj()};By.prototype.aj=function(){var b=this.Ud.value.length;if(b>this.tg){var c=this.Ud.scrollTop,d=this.Ud.scrollLeft;this.Ud.value=this.Ud.value.substring(0,this.tg);b=this.tg;this.Ud.scrollTop=c;this.Ud.scrollLeft=d}this.Yh&&zc(this.Yh,1==this.PD?b:this.tg-b)};
By.prototype.p=function(){By.m.p.call(this);delete this.Ud;this.Oj.G();this.Oj=k};a.Cy=function(b){M.call(this);this.U=k;this.Y=b;this.Jt=0;this.HH=""},a.Dy=void 0;y(Cy,el);t=Cy.prototype;t.w=function(){this.li||(this.li=j,this.o(),this.Ea())};t.Ea=function(){A||(new gp("搜索问题")).n(this.zc);this.M=new go("/redirect-question/autocomplete",this.zc,k,k,H("zh-question-redirect-diag-content"),n);this.M.sn=n;this.M.Kf(j);this.g().c(this.M,Zl.Ih.Si,Uk);this.g().c(this.M,"select",this.GS).c(this.VL,"click",function(){this.U.z(n)})};
t.GS=function(){var b=this.M.lg();this.zc.value="";var c=b[3],b=b[1];this.U.z(n);this.zc.value="";this.xhr=new V(j);P(this.g(),this.xhr,"complete",this.jL);this.xhr.ajax("/question/redirect","qid="+this.Y+"&rqid="+c);this.Jt=c;this.HH=b};t.jL=function(){var b=Ie(this.xhr);b&&(b.r?U(b.msg):this.Sa?(this.Sa.innerHTML="已经重定向",this.Sa.setAttribute("data-disabled",1)):this.dispatchEvent("change"))};
t.o=function(){this.e=K("div",{id:"zh-question-redirect-diag"},["将问题跳转至",K("div",{id:"zh-question-redirect-diag-content"},this.zc=K("input",{type:"text","class":"zg-form-text-input"})),K("div","zm-command",this.VL=K("a",{href:"javascript:;","class":"zm-command-cancel",name:"cancel"},"放弃操作"))]);this.U=new yi(k,n);this.U.fb("问题重定向");Ih(this.U,k);this.U.ba().appendChild(this.e)};t.show=function(){this.w();this.U.z(j)};a.Ey={},a.Ey=function(){M.call(this)};y(Ey,el);Ey.Ou=[["需要详细阐述","答案过于简短或表述不清晰，请完善答案。"],["答非所问","没有正面或直接回答问题，请修改答案。"],["应作为问题的评论","该内容是对问题本身的评论而不是回答，请改为发布到评论。"],["应作为答案的评论","该内容是对另外一个答案的评论或回应，而不是回答问题，请改为发布到评论。"],["内容重复","与已有答案重复，请修改答案。"],["内容已过期","答案的时效性已过，请更新答案。"],["需要注明关联利益","有广告、推销嫌疑，请注明作者与利益方的关系。"]];Ey.Pj=k;Ey.F=function(){Ey.Pj||(Ey.Pj=new Ey,Ey.Pj.w());return Ey.Pj};t=Ey.prototype;t.w=function(){this.e||(this.o(),this.Ea(),this.dy())};t.Ea=function(){this.g().c(this.e,"click",this.ES)};
t.ES=function(b){"A"===b.target.tagName&&(b=b.target.getAttribute("data-index"),this.OM.PZ(b),this.Kz.z(n))};t.dy=function(){var b=new kn(this.e);sh(b);b.fF=j;b.Cp(j);b.z(n);b.Lz=0;b.S()&&b.oa();bs(b,new Of(13,0,0,-22));this.Kz=b};
t.o=function(){var b=K("div",{id:"zh-answer-flag-popup","class":"zg-r5px zu-hovercard-wrap"},[K("div","zg-r5px zu-hovercard-inner",[K("div",{id:"zh-answer-flag-popup-header"},[K("a",{"class":"zg-right",href:"http://www.zhihu.com/question/19867017",target:"_blank"},"这是什么？"),"选择一个理由："]),this.pH=K("div",{id:"zh-answer-flog-options-wrap"})]),K("div","zu-hovercard-spin-top")]);z.forEach(Ey.Ou,function(b,d){var e=K("a",{href:"javascript:;","class":"zm-menu-item-link"},b[0]);e.setAttribute("data-index",
d);this.pH.appendChild(e)},this);document.body.appendChild(b);this.e=b};t.show=function(b,c){this.Kz.ed(new hn(b,1));var d=c.WZ(),e=Xb("zm-menu-item-link",this.pH);z.forEach(e,function(b,c){R(b,!z.contains(d,c))},this);this.Kz.z(j);this.OM=c};a.Fy=function(){M.call(this)},a.Gy=void 0;y(Fy,el);
Fy.prototype.w=function(){this.o();this.g().c(this.Il,"change",function(){var b=this.Il.value;this.ph.value="no"===b?"":Ey.Ou[+b][1]}).c(this.bj,"click",function(b){"cancel"===b.target.name?this.U.z(n):this.ph.value&&"no"!==this.Il.value&&(this.Mw=new V(j),this.g().c(this.Mw,"complete",function(){var b=Ie(this.Mw);b&&!b.r?(this.Sa.innerHTML="已经标记",this.U.z(n)):U(b.msg)}),b=xk(this.ph.value),this.Mw.ajax("/answer/flag","answer_id="+this.LK+"&flag="+this.Il.value+"&reason="+encodeURIComponent(b)))})};
Fy.prototype.o=function(){this.e=K("div",k,[K("div","zg-section",[K("div",k,"标记："),this.Il=K("select")]),K("div",k,[K("div",k,"原因"),this.ph=K("textarea",{style:"width:96%;border:solid 1px #666;height:66px;padding:5px"})]),this.bj=K("div","zm-command",[K("a",{"class":"zg-mr10",href:"javascript:void(0);",name:"cancel"},"取消"),K("a",{"class":"zg-btn-blue",href:"javascript:void(0);",name:"confirm"},"确定")])]);this.Il.appendChild(K("option",{value:"no"},"选择标记原因"));z.forEach(Ey.Ou,function(b,c){this.Il.appendChild(K("option",
{value:c},b[0]))},this);this.U=new yi(k,n);this.U.fb("标记答案");Ih(this.U,k);this.U.ba().appendChild(this.e)};Fy.prototype.show=function(){this.U.z(j)};a.Hy=function(b){var c=b&&b.name;if(c)switch(c){case "adminflag":Gy||(Gy=new Fy,Gy.w());c=Gy;c.Sa=b;c.LK=b.id.split("-")[1];c.show();break;case "redirect":case "cancel_redirect":if(!b.getAttribute("data-disabled")){var d;Dy||(Dy=new Cy,Dy.w());d=Dy;d.Sa=b;d.Y=b.id.split("-")[1];"redirect"===c?d.show():(Ei("/question/unredirect",k,"POST","qid="+d.Y+"&rqid="+d.Jt),d.Sa.innerHTML="重定向已撤销",d.Sa.setAttribute("data-disabled",1))}break;case "revert":var e=Ci("撤销",'<div class="zg-form-text-input"><textarea class="zg-editor-input content" title="请输入撤销原因" placeholder="请输入撤销原因"></textarea></div>',
function(c){if(c){var c=g.value,d=b.getAttribute("id").split("-")[1],c=(new fj).add("revision",d).add("reason",c),m=new V(j);m.on("success",function(){var b=Ie(m);b.r?U(b.msg):(e.z(n),b.msg?window.location.href=b.msg:location.reload())});m.ajax("/revert",c.toString());return n}}),g=J("content",e.ba());new El(g);new Po(g,48);new By(g,k,200)}},a.Iy=function(b){$(b).on("click",'a[name="revert"]',function(){Hy(this)})};a.Jy=function(){T.call(this)};y(Jy,T);t=Jy.prototype;t.w=function(){yl.J(this);this.n(document.body)};
t.B=function(){Jy.m.B.call(this);var b=J("zm-profile-header-operation");b&&(new zy).n(b);(b=J("zm-profile-header"))&&(new vy).n(b);(b=H("zh-profile-activity-wrap"))&&this.g().c(b,"click",function(b){if((b=b.target)&&"focus"===b.name){var c=b.getAttribute("data-type");Kk(b,c,k,["zm-profile-follow-link-gray","zm-profile-unfollow-link-gray"])}});(this.Sw=b=H("zh-profile-page-force-to-rename"))&&this.g().c(b,"click",this.OV);this.ey();if(b=H("zh-profile-activity-page-list"))b=new Bx(b,"/people/"+Hg[1]+
"/activities",j),this.J(b),this.g().c(b,"click!",function(b){"comment"===b.namespace&&b.Dc.fill("category","profile").fill("label","profile_feed")}),b.If("zm-profile-section-item"),b.ru=n,b.ou=n,b.w();(b=J("zm-profile-fav-wrap"))&&this.g().c(b,"click",this.zN);(b=H("zm-profile-details-editform"))&&(new ry).n(b);if(b=J("zm-profile-answer-sort"))this.Nh=new ou,this.Nh.Fa(this.yL=new lu("按时间排序")),this.Nh.Fa(this.zL=new lu("按投票排序")),this.Nh.Fa(this.xL=new lu("问"+S[0]+"的问题")),this.Nh.Z(b),this.Nh.z(n),
this.g().c(b,"click",function(b){this.Nh.z(j);b.stopPropagation();P(this.g(),document,"click",function(){this.Nh.z(n)})}),this.g().c(this.Nh,"action",this.kP);(b=H("zh-profile-edit-expert"))&&(new Ky).n(b);var c=J("profile-expert-tip");c&&this.g().c(c,"click",function(b){var d=b.target;("enable"===d.name||"close"===d.name)&&nt("ProfileExpertTopicsV2",d.name,k,function(){"enable"===d.name?location.reload():vk(c,j)})});$(".zm-profile-section-wrap.skilled-topics").each(function(){(new ty).n(this)});
$(".zm-profile-module.skilled-topics").each(function(){(new ty).n(this)});$(".zm-profile-module.active-topics").each(function(){(new ty).n(this)});var d=H("zh-profile-ask-list");if(d&&(b=new Wt({Pa:["autoload","locationSource"]}),this.J(b),b.n(d),d=J("zm-profile-section-list"))){var e=new xy;e.If("zm-profile-section-item");yy(e,b);e.w(d)}if(d=$("#zh-profile-answer-list").children().get(0))if(b=new Wt,this.J(b),b.Pa("nodeSource").Pa("childConstructor",{Tg:zx}),b.n(d),this.g().c(b,"click!",function(b){"comment"===
b.namespace&&b.Dc.fill("category","profile").fill("label","profile_answers_list")}),d=J("zm-profile-section-list"))e=new xy,yy(e,b),e.w(d);if(b=$("#zh-profile-log-list").get(0))d=new Wt,d.Pa("locationSource",{kt:j}),this.J(d),d.n(b),Iy(b);if(d=H("zh-profile-topic-list"))if(b=new Wt({Pa:["autoload","locationSource"]}),this.J(b),this.g().c(b,"itemcreated",function(b){var b=b.item,c=b.getAttribute("data-tid").split("-")[1];if(S[3]===Hg[3]){var d=new kr(j,"/topic/bio/update","bio");d.qu=j;d.rd=["tid="+
c];d.Bb='<a href="javascript:;" name="edit">添加你在该话题的经验</a>';d.n(b)}}),b.n(d),d=J("zm-profile-section-list"))e=new xy,e.If("zm-profile-section-item"),yy(e,b),e.w(d);if(b=$("#zh-profile-column-list > .zh-general-list").get(0))d=new Wt({Pa:["autoload","nodeSource"]}),this.J(d),d.n(b);if(b=$("#zh-profile-follows-list > .zh-general-list").get(0))d=new Wt({Pa:["autoload","nodeSource"]}),this.J(d),d.n(b);if(b=$("#zh-profile-follows-list-old").get(0))d=new Wt({Pa:["autoload","locationSource"]}),this.J(d),
d.n(b);if(b=$("#zh-profile-fav-list > .zh-general-list").get(0))d=new Wt({Pa:["autoload","nodeSource"]}),this.J(d),d.n(b);this.zo();-1<location.search.indexOf("clean-followers-noti=1")&&(new V(j)).ajax("/notification/clear","no_refresh_content=true&type=follow");$("#__signin").click(function(){var b=Jk.F();Xm(b,n);b.z(j)})};t.OV=function(){Ci("确定","确定要强制此用户改名吗？",function(b){b&&(H("realname_form").submit(),this.Sw.innerHTML="已发送",D.add(this.Sw,"zg-gray"),Cd(this.Sw))},this)};
t.zo=function(){this.Nj();var b=H("zm-profile-header-pm-btn");b&&N(b,"click",function(c){c.preventDefault();if(S.Ia()){c=new Gt(k,j);c.show();Kt(c,Hg[3],Hg[0]);var e=b.href;c.a_=e;c.Rf.innerHTML+='<a class="zm-profile-email-history-link" href="'+e+'">私信记录  »</a>';c.Ob.focus()}else c=Jk.F(),Xm(c,n),c.z(j)});var c=H("zh-profile-cancel-block");c&&this.g().c(c,"click",this.UG);(c=H("zh-report-people"))&&this.g().c(c,"click",this.$H);(c=H("zh-profile-search-query-mirro"))&&new El(c,c.getAttribute("placeholder"))};
t.UG=function(){Ci("确定取消屏蔽？","取消屏蔽后，对方将可以关注你、向你发私信、评论你的回答、使用「@」提及你，邀请你回答问题。",function(b){b&&Ly(this,n)},this)};t.hl=function(){P(this.g(),document,"click",function(){this.jb.z(n)})};t.Nj=function(){var b=H("profile-side-op");b&&this.g().c(b,"click",this.Cj)};t.kP=function(b){var c="";b.target===this.yL?c="time":b.target===this.zL?c="vote":b.target===this.xL&&(c="ask");location.href="/people/"+S[1]+"/answers?sort="+c};
t.Cj=function(b){b=b.target.name;"block"===b?Ci("确定要屏蔽该用户？","屏蔽用户后，对方将不能关注你、向你发私信、评论你的实名回答、使用「@」提及你，邀请你回答问题，但仍然可以查看你的公开信息。",function(b){b&&Ly(this,j)},this):"report"===b?this.$H():"cancel-block"===b&&this.UG()};t.$H=function(){bu.Gm("member",Hg[3])};a.Ly=function(b,c){var d=new V(j);P(b.g(),d,"complete",function(){window.location.reload()});d.ajax("/people/"+Hg[1]+"/block","action="+(c?"add":"cancel"))};
t.zN=function(b){if(b&&b.target&&(b=Gk(this.e,b.target))){var c=J("zm-profile-fav-item-title",b),d=J("zm-profile-fav-item-des",b);c&&d&&"fav-edit"===b.name&&(c=c.innerHTML,d=d.innerHTML||"",b=[Number(b.getAttribute("data-id")),Number(b.getAttribute("data-public"))],gv(av(),c,d,b))}};
t.ey=function(){if(this.iA=H("zh-profile-search-form")){var b=H("zh-profile-search-type");b&&this.g().c(b,"click",this.CS);this.vk=this.iA.getAttribute("data_type");this.g().c(this.iA,"submit",this.search);N(window,"popstate",function(b){var b=b.state,c;b&&b.GH&&(c=H("zh-profile-search-query"),c.value=decodeURIComponent(b.GH),My(this,b.type),this.search(i,n),c.focus())},n,this);var b=(new vf(location)).Lc().get("pq"),c=(new vf(location)).Lc().get("type");c||(c="all");if(b&&c){var d=H("zh-profile-search-info");
d&&R(d,j);My(this,c);H("zh-profile-search-query").value=b;this.search(i,i,n)}}};t.CS=function(b){if((b=b.target)&&b.name)My(this,b.name),this.search()};a.My=function(b,c){var d=Xb("zm-profile-search-type-item");if(d)for(var e=0;e<d.length;e++)D.remove(d[e],"current"),d[e].name===c&&D.add(d[e],"current");b.vk=c};
t.search=function(b,c,d){this.Xe=H("zh-profile-search-query").value;this.Km="/people/"+H("zh-profile-search-form").getAttribute("data_url")+"/search";if(this.Xe){c===i&&(c=j);d===i&&(d=j);if(window.history.pushState){if(this.jA)return;b&&b.preventDefault();this.Lm=new V(j);this.jA=j;this.g().c(this.Lm,"complete",this.GJ);c&&window.history.pushState({GH:encodeURIComponent(this.Xe),type:this.vk},"","?pq="+encodeURIComponent(this.Xe)+"&type="+this.vk);this.Lm.ajax(this.Km,"type="+this.vk+"&pq="+encodeURIComponent(this.Xe),
"","POST")}else b||(d?(this.Xe=H("zh-profile-search-query").value,this.Km="/people/"+H("zh-profile-search-form").getAttribute("data_url")+"/search",window.location.href=this.Km+"?type="+this.vk+"&pq="+encodeURIComponent(this.Xe)):(this.Lm=new V(j),this.jA=j,this.g().c(this.Lm,"success",this.GJ),this.Xe=H("zh-profile-search-query").value,this.Km="/people/"+H("zh-profile-search-form").getAttribute("data_url")+"/search",this.Lm.ajax(this.Km,"type="+this.vk+"&pq="+encodeURIComponent(this.Xe),"","POST")));
(b=H("zh-profile-search-info"))&&R(b,j)}else b&&b.preventDefault()};
t.GJ=function(){this.jA=n;zc(H("zh-profile-search-word"),this.Xe);var b=Ie(this.Lm);if(b&&!b.r){var c=H("zh-profile-search-list");if(c)if(0===b.msg[0])H("zh-profile-list-container").innerHTML='<div id="'+c.id+'"><div style="margin: 20px;color: #999;text-align: center;">抱歉，没有找到任何结果</div></div>';else{var d;d=""+('<div id="'+c.id+'">');d+=b.msg[1]+"</div>";H("zh-profile-list-container").innerHTML=d+'<a href="javascript:;" id="zh-load-more" class="zg-btn-white zu-button-more" style="">更多</a>';if((b=Xb("zm-item",
c))&&b.length)this.Gi=b[b.length-1].id.split("-")[1];this.bb=k;this.bb=new Bx(H(c.id),k,j);this.bb.w();this.bb.Gi=this.Gi;this.bb.url=this.Km;this.bb.rd.pq=this.Xe;this.bb.rd.type=this.vk;H("zh-profile-search-query").focus()}}};a.Ky=function(){T.call(this)};y(Ky,T);
Ky.prototype.$=function(b){this.e=b;this.Qa=new Os;this.Qa.n(this.e);this.form=H("zm-profile-expert-editform");this.g().c(this.form,"submit",this.sz);this.g().c(this.Qa,["add","remove","sort"],function(){this.Vd()});$(".enable").on("change","input",$.proxy(function(){this.Vd()},this));var c=H("zh-profile-expert-warning");c&&this.g().c(c,"click",function(b){"close"===b.target.name&&vk(c)});$(".enable input[type='radio']").click(function(b){R(H("zh-profile-expert-reopen-tip"),!Number($(b.target).val()))})};
Ky.prototype.Vd=function(){$(window).on("beforeunload.profile",v(s("你的更改还未保存，确认离开该页面吗？"),this))};Ky.prototype.Ie=function(){$(window).off("beforeunload.profile")};
Ky.prototype.sz=function(){var b=[];z.forEach(this.Qa.data,function(c){b.push(c[3])});var c=$(this.form).serializeArray()[0].value,d=$("#zh-expert-topics .item").map(function(){return $(this).data("url-token")}).get();nt("ProfileEditExpertTopicsV2","save",{settings:{enable_expert:c,expert_topic:d}},function(){this.Ie();window.location.href="/people/"+S[1]},k,this)};a.Ny=function(b,c,d,e,g){pu.call(this,b,c,g);this.Ow=d||"people";this.GN=e||["zg-follow","zg-unfollow"]};y(Ny,pu);Ny.prototype.w=function(b){Ny.m.w.call(this,b);this.Ea(this.e)};Ny.prototype.yB=ca("yB");Ny.prototype.Ea=function(b){if(this.yB){var c=new zy,d=this.GN;c.Rw=this.Ow;c.Qw=d||c.Qw;this.Sh&&c.Om(this.Sh);c.n(b)}};Ny.prototype.Om=ca("Sh");a.Oy=function(){};t=Oy.prototype;t.XB={"lock-question":"block","unlock-question":"unblock","mute-question":"mute","unmute-question":"unmute","remove-question":"delete","collapse-answer":"collapse","uncollapse-answer":"uncollapse","remove-answer":"delete"};t.dx=ba();t.ex=function(b){var c=new fj(b),d=this.dx();if(!d)return Mk("OP META DATA ELEMENT DOES NOT PROVIDED");z.forEach(["question_id","task_id","answer_id","none_queue"],function(b){var g=d.getAttribute("data-"+b);g&&c.add(b,g)});return c};
a.Py=function(b,c){var d=qv[c];if(d){var e;e=[];(e=Ac(b,function(b){return 3===b.nodeType&&La(b.nodeValue)},e,j)?e[0]:i)&&zc(e,b.getAttribute("data-label")||d.label);b.setAttribute("data-op",c)}else Mk("NO SUCH OP NAME")};t.nz=ba();t.QN=tk(function(){var b=ov.F();b.on("cancel",this.nz,n,this);return b});a.Qy=function(b,c,d,e){var g=c.getAttribute("data-op");if(g){Py(c,g);var h=b.QN(),e=b.ex(e).add("action",b.XB[g]);vv(h,c,v(d||ha,b),"",e.toString());h.z(j)}};a.Ry=function(b){this.je=10;this.ad="搜索用户";this.path=b||"/people/autocomplete"};y(Ry,el);t=Ry.prototype;t.o=function(){var b=K("div","zg-section zm-tag-editor-command-buttons-wrap",[this.Ra=K("input","zg-form-text-input zg-mr15"),this.oI=K("span","zg-mr15"),this.EM=K("a",{"class":"zg-mr15 zg-btn-blue",href:"javascript:;",name:"add"},"移交")]);this.e.appendChild(b);this.ad&&((new gp(this.ad)).n(this.Ra),this.Ra.title=this.ad);this.vf(b);this.g().c(this.EM,"click",this.lp)};
t.vf=function(b){this.M=new go(this.path,this.Ra,k,k,b,j);this.M.Kf(j);this.M.pi=this.je;this.g().c(this.M,"select",this.yS)};t.lp=function(){this.mA&&this.dispatchEvent("select")};t.yS=function(){var b=this.M.lg().slice(1);this.mA=[b[3],b[0]];this.oI.innerHTML=b[0]};t.h=q("e");t.n=function(b){this.e=b;this.o()};t.hide=function(){R(this.e,n);this.mA=k;this.oI.innerHTML=""};a.Sy=function(b,c,d,e,g,h){nr.call(this,e,c,d,h);this.Y=b;this.fm=this.sk=n;this.fT=g};y(Sy,nr);a.Ty=[{value:"精简文字描述",label:"精简文字描述"},{value:"补充必要的信息",label:"补充必要的信息"},{value:"改进标点或格式",label:"改进标点或格式"},{value:"other",label:"其他"}];t=Sy.prototype;t.n=function(b){Sy.m.n.call(this,b);this.g().c(Ki,"anon_change",this.yj)};t.yj=function(b){this.fm||D.enable(this.e,"zm-editable-disabled",b.mb)};
t.dj=function(){Sy.m.dj.call(this);var b=K("a",{"class":"zg-right zg-link-litblue",href:"http://www.zhihu.com/question/19550238/answer/12202028",target:"_blank"},"为什么问题可以被公共编辑？"),c=K("select",{style:"1px solid #999 "}),d=K("option",{value:"none"},"请选择一个修改理由...");c.appendChild(d);z.forEach(Ty,function(b,d){var e=K("option",{value:b.value},d+1+". "+b.label);c.appendChild(e)});this.Sz=K("div",{"class":"zm-editable-require-reason-wrap",style:"padding:10px 0 0 0"},[b,this.T_=c,this.wG=K("span"),this.MT=
K("div",{"class":"zg-form-text-input",style:"height:22px;margin:10px 0 0 0;display:none"},this.LT=K("textarea",{style:"width:100%;height:22px !important;min-height:22px !important;"}))]);lc(this.Sz,this.Ad);this.sk&&this.Ci(" * 必选","zg-gray-normal");var e=Wb("select",k,this.Sz)[0];this.g().c(e,"change",function(){R(this.MT,"other"===e.value);this.Ci(" * 必选","zg-gray-normal")})};
t.Bf=function(b){var c=Wb("select",k,this.Sz)[0],d=c.value;if(this.sk){if("none"===d){this.Ci("请选择一个修改理由");return}if("other"===c.value&&(d=xk(this.LT.value),!d)){this.Ci("请填写修改理由");return}}"title"===this.qr&&-1===b.indexOf("?")&&-1===b.indexOf("？")?this.Ci("还没有输入问号"):("none"===d&&(d=""),this.rd=["id="+this.Y+"&reason="+encodeURIComponent(d)+"&question_id="+this.Y],this.dispatchEvent("change"),Sy.m.Bf.call(this,b),this.Ci("* 必选","zg-gray-normal"),this.sk=j)};
t.Ci=function(b,c){this.wG.innerHTML=b;D.set(this.wG,c||"zg-error-text")};t.kg=function(){return this.Ed&&this.fT?yk(Ia(this.Na.value)):Sy.m.kg.call(this)};t.Vd=function(){$(window).on("beforeunload.EditorWithReason",v(s("你对问题的修改还未保存，确认离开该页面吗？"),this))};t.Ie=function(){$(window).off("beforeunload.EditorWithReason")};t.vh=function(){Sy.m.vh.call(this);this.Ie()};t.vd=function(){Sy.m.vd.call(this);this.Vd()};a.Uy=function(){M.call(this);this.N_=[];this.Hy=0;this.nB=this.O_=k;this.ED=5;this.CP="/reviewq/handover"};y(Uy,el);ya(Uy.prototype,Oy.prototype);t=Uy.prototype;t.dx=q("fa");t.ex=function(b){return Oy.prototype.ex.call(this,b).add("queue_id",this.Lb).add("is_realm",this.ge)};t.nz=function(){this.locked=n};
t.w=function(b){this.e=b;this.Lb=(b=H("queue_id"))?b.value:0;this.ge=(b=H("is_realm"))?b.value:0;this.o();this.Ea();zt.As||(b=new Jd(1E3*this.ED),b.start(),this.g().c(b,Kd,this.dW));H("zh-load-more")&&(new Ny(this.e,window.location.href,"queue",["zg-btn-follow","zg-btn-unfollow"],j)).w();this.g().c(this.e,"click",this.ha)};t.ha=function(b){this.sx(b.target)};
t.dW=function(){var b=Xb("zm-review-queue-deadline");b&&b.length&&z.forEach(b,function(b){var d=b.getAttribute("data-lefttime");if(d)if(d=+d,2E3<d&&(d-=Math.floor(+new Date/1E3)),0>=d&&-1E3<d)b.innerHTML="已流通";else{60>d&&D.add(b,"zm-review-queue-time-warning");var e=Math.floor(d/60),g=d%60;b.setAttribute("data-lefttime",d-this.ED+"");b.innerHTML=(0<e?e+"分":"")+(g+"秒")}},this)};t.YK=function(){Vy(this,["删除话题","已删除"],["delete_topic",""]);Wy(this);zt.As||this.fa.setAttribute("data-lockdown")};t.ox=u(53);
t.DS=function(){this.lI=this.ek.mA;this.xhr=new V(j);this.pb&&P(this.g(),this.xhr,"success",this.Ee);this.xhr.ajax(this.CP+"?queue_id="+this.Lb+"&is_realm="+this.ge,"action=assign&assigned_to="+this.lI[0]+"&task_id="+this.fa.getAttribute("data-task_id")+"&none_queue="+this.fa.getAttribute("data-none_queue"))};t.o=function(){this.Lj=H("zh-queue-new-info");var b=K("div",{style:"display:none"},this.hc=K("div","zu-review-queue-topic-editor",K("div","zm-tag-editor-labels")));mc(b,this.e)};
t.Ea=function(){zt.As||this.zk()};t.zk=function(){this.Ck=new V(n);P(this.g(),this.Ck,"success",this.Gx);this.Ck.ajax("/reviewq/sidebar?queue_id="+this.Lb,k,"GET")};t.Gx=function(){var b=Ie(this.Ck);if(!b||!b.r){var c=b.msg,b=Xb("zm-review-queue-live-udatable-num");z.forEach(b,function(b){var e=b.getAttribute("data-key");e&&(e=c[e],e||(b.innerHTML=e))});setTimeout(v(this.zk,this),1E4)}};t.dL=function(){Xy(this,this.Sa,"已流通")};
a.Xy=function(b,c,d){c=c||b.Sa;d=d||"已处理";D.remove(c,"zg-btn-white");"pass"===c.name&&(c.innerHTML=d,zt.As||(c.name=""));b.fa=Kc(c,k,"zm-item");Wy(b);(b=J("zm-review-queue-deadline",b.fa))&&R(b,n)};t.ZK=function(){Vy(this,["移交","已经移交给："+this.lI[1]],["handover",""]);this.ek.hide();Wy(this);R(this.fa,n)};
a.Vy=function(b,c,d){var e=0;b.Sa.name===d[0]&&(e=1);b.Sa.name=d[e];var d="",g=b.Sa.innerHTML.indexOf("</span>");-1<g&&(d=b.Sa.innerHTML.substring(0,g+7));b.Sa.innerHTML=d+c[e]},a.Wy=function(b){D.remove(b.fa,"zm-item-unread");b.locked=n};
t.sx=function(b){if(this.locked)this.UF&&Mk(this.UF,"last action");else{this.locked=j;var c=b.name;this.UF=c;var d=Kc(b,k,"zm-item");this.Sa=b;this.fa=d;if(d.getAttribute("data-lockdown"))this.locked=n;else{var e=b.getAttribute("data-op");if(e)switch(e){case "lock-question":case "unlock-question":Qy(this,b,function(){Py(b,"lock-question"===e?"unlock-question":"lock-question");Wy(this)});break;case "mute-question":case "unmute-question":Qy(this,b,function(){Py(b,"mute-question"===e?"unmute-question":
"mute-question");Wy(this)});break;case "remove-question":Qy(this,b,function(){L(d);this.locked=n});break;case "collapse-answer":case "uncollapse-answer":Qy(this,b,function(){Py(b,"collapse-answer"===e?"uncollapse-answer":"collapse-answer");Wy(this)});break;case "remove-answer":Qy(this,b,function(){L(d);this.locked=n})}else{switch(c){case "edit_title":var c=d.getAttribute("data-question_id"),g=d.getAttribute("data-task_id"),c=new Sy(c,"/reviewq/question?queue_id="+this.Lb+"&action=edit_title&task_id="+
g,"title",n,j);c.wr=j;c.Ed=j;c.n(b.parentNode);c.sk=j;c.w();c.vd();this.l0=c;L(b);this.locked=n;break;case "bind_topic":this.locked=n;this.nB||(c=new Ss(this.Lb),c.n(this.hc),this.nB=c);c=this.nB;g=J("zm-review-queue-tags-wrap",d);if(!c.locked){c.locked=j;c.Y=d.getAttribute("data-question_id");var h=d.getAttribute("data-task_id");c.iC=c.HC+h+"&question_id="+c.Y+"&action=bind_topic";c.VH=c.HC+h+"&question_id="+c.Y+"&action=unbind_topic";c.Hs&&(h=J("zm-tag-editor-labels",c.Hs),np(c),h.innerHTML=c.af.innerHTML,
D.remove(c.Hs,"zm-review-queue-editing"));c.rD=d;c.Hs=d;D.add(c.rD,"zm-review-queue-editing");mc(c.e,g);R(c.af,n);c.oB=new V(j);c.g().c(c.oB,"complete",c.QS);c.oB.ajax("/reviewq/fetch_topic","question_id="+c.Y)}break;case "delete_topic":this.pb=this.YK;this.xhr=new V(j);this.pb&&P(this.g(),this.xhr,"success",this.Ee);this.xhr.ajax("/reviewq/topic?queue_id="+this.Lb+"&is_realm="+this.ge,"action=delete&topic_id="+this.fa.getAttribute("data-topicid")+"&task_id="+this.fa.getAttribute("data-task_id")+
"&none_queue="+this.fa.getAttribute("data-none_queue"));break;case "handover":this.locked=n;this.pb=this.ZK;this.ek?R(this.ek.h(),j):(c=new Ry("/reviewq/auto"),g=K("div",{id:"zh-review-queue-people-selector"}),this.e.appendChild(g),c.n(g),this.ek=c,this.g().c(this.ek,"select",this.DS));c=+d.getAttribute("data-hotype");this.ek.M.pi=c;c=Kc(b,"DIV");mc(this.ek.h(),c);break;case "pass":case "unpass":this.pb=this.dL;this.xhr=new V(j);this.pb&&P(this.g(),this.xhr,"success",this.Ee);this.xhr.ajax("/reviewq/pass",
"queue_id="+this.Lb+"&is_realm="+this.ge+"&action="+c+"&task_id="+this.fa.getAttribute("data-task_id")+"&none_queue="+this.fa.getAttribute("data-none_queue"));break;case "unflag":break;case "add_question_comment":case "add_answer_comment":this.BM=c.split("_")[1];this.locked=n;(c=Yy(this))?R(c,j):(g=K("div"),g.innerHTML=H("zh-review-queue-comment-form-template").innerHTML,mc(g,J("zm-item-comment-el",this.fa)));$(".zm-command",c).show();break;case "delete_comment":this.locked=n;break;case "addnew":this.locked=
n;c=Wb("TEXTAREA",k,this.fa);c=c[c.length-1].value;if(!c)return;this.pb=this.VK;this.px(c);break;case "closeform":this.locked=n;R(Yy(this),n);break;case "unbind_topic":this.pb=this.lL;c=this.fa.getAttribute("data-question_id");g=this.fa.getAttribute("data-topicid");h=this.fa.getAttribute("data-task_id");this.xhr=new V(j);this.pb&&P(this.g(),this.xhr,"success",this.Ee);this.xhr.ajax("/reviewq/question?queue_id="+this.Lb+"&is_realm="+this.ge+"&task_id="+h,"action=unbind_topic&question_id="+c+"&topic_id="+
g+"&none_queue="+this.fa.getAttribute("data-none_queue"));break;case "rebind_topic":this.pb=this.eL;c=this.fa.getAttribute("data-question_id");g=this.fa.getAttribute("data-topicid");h=this.fa.getAttribute("data-task_id");this.xhr=new V(j);this.pb&&P(this.g(),this.xhr,"success",this.Ee);this.xhr.ajax("/reviewq/question?queue_id="+this.Lb+"&is_realm="+this.ge+"&task_id="+h,"action=bind_topic&question_id="+c+"&topic_id="+g+"&none_queue="+this.fa.getAttribute("data-none_queue"));break;case "cancel_nohelp":this.pb=
this.WK;c=this.fa.getAttribute("data-answer_id");g=this.fa.getAttribute("data-task_id");this.xhr=new V(j);this.pb&&P(this.g(),this.xhr,"success",this.Ee);this.xhr.ajax("/reviewq/answer?queue_id="+this.Lb+"&is_realm="+this.ge+"&task_id="+g,"action=cancel_nohelp&answer_id="+c+"&none_queue="+this.fa.getAttribute("data-none_queue"));break;case "nohelp":this.pb=this.cL;c=this.fa.getAttribute("data-answer_id");g=this.fa.getAttribute("data-task_id");this.xhr=new V(j);this.pb&&P(this.g(),this.xhr,"success",
this.Ee);this.xhr.ajax("/reviewq/answer?queue_id="+this.Lb+"&is_realm="+this.ge+"&task_id="+g,"action=nohelp&answer_id="+c+"&none_queue="+this.fa.getAttribute("data-none_queue"));break;case "edit_detail":c=d.getAttribute("data-question_id");g=d.getAttribute("data-task_id");c=new Sy(c,"/reviewq/question?queue_id="+this.Lb+"&action=edit_detail&task_id="+g,"detail_text",j,n);c.Bb='<div style="font-weight:bold"><a href="javascript:;" name="edit">添加补充说明</a></div>';c.wr=j;c.n(b.parentNode);c.sk=j;c.w();
c.vd();this.FZ=c;L(b);this.locked=n;break;case "voteup":case "votedown":c="voteup"===c?"vote_up":"vote_down";this.pb=this.mL;g=this.fa.getAttribute("data-answer_id");h=this.fa.getAttribute("data-task_id");this.xhr=new V(j);this.pb&&P(this.g(),this.xhr,"success",this.Ee);this.xhr.ajax("/reviewq/answer?queue_id="+this.Lb+"&is_realm="+this.ge+"&task_id="+h,"action="+c+"&answer_id="+g+"&none_queue="+this.fa.getAttribute("data-none_queue"));break;case "thanks":this.pb=this.kL;c=this.fa.getAttribute("data-answer_id");
g=this.fa.getAttribute("data-task_id");this.xhr=new V(j);this.pb&&P(this.g(),this.xhr,"success",this.Ee);this.xhr.ajax("/reviewq/answer?queue_id="+this.Lb+"&is_realm="+this.ge+"&task_id="+g,"action=thanks&answer_id="+c+"&none_queue="+this.fa.getAttribute("data-none_queue"));break;default:this.locked=n}return n}}}};t.kL=function(){this.Sa.name="";var b=$(this.Sa),c=$("i",b);b.html(c).append("感谢已发出");Xy(this,Zy(this),"已流通")};
t.mL=function(){var b=Ie(this.xhr),c=J("vote-bar-hook",this.fa);D.set(c,"zm-item-vote-bar");"up"===b.msg?(D.add(c,"zm-item-vote-up-active"),Xy(this,Zy(this),"已流通")):"down"===b.msg?D.add(c,"zm-item-vote-down-active"):(D.remove(c,"zm-item-vote-up-active"),D.remove(c,"zm-item-vote-down-active"));this.locked=n};a.Zy=function(b){return J("zg-btn-white",b.fa)};
t.Ee=function(){var b=Ie(this.xhr);if(b&&b.r){if("deleted"===b.msg){if(this.fa&&(D.add(this.fa,"zm-queue-disabled"),this.fa.setAttribute("data-lockdown"),b=Wb("A",k,this.fa),z.forEach(b,function(b){if("delete_question"===b.name||"delete_answer"===b.name)b.style.color="red !important",b.innerHTML="已删除"}),b=J("zm-review-queue-deadline",this.fa)))b.setAttribute("data-lefttime",-9E3),b.innerHTML=""}else U(b.msg);this.locked=n}else this.pb()};
t.cL=function(){this.Sa.name="cancel_nohelp";var b=$(this.Sa),c=$("i",b);b.html(c).append("撤销没有帮助");this.locked=n;Xy(this,Zy(this))};t.WK=function(){this.Sa.name="nohelp";var b=$(this.Sa),c=$("i",b);b.html(c).append("没有帮助");this.locked=n;Xy(this,Zy(this))};t.eL=function(){this.Sa.name="unbind_topic";this.Sa.innerHTML="解除绑定";this.locked=n};t.lL=function(){this.Sa.name="rebind_topic";this.Sa.innerHTML="重新绑定";this.locked=n};
t.VK=function(){var b=Yy(this),c=K("div","zm-comment-list");c.innerHTML='<div class="zm-comment-content">已评论</div>';mc(c,b);Ck(c);setTimeout(function(){L(c)},2500);var d=Wb("TEXTAREA",k,this.fa);d.length&&(d[d.length-1].value="");R(b,n)};
t.px=function(b){this.xhr=new V(j);this.pb&&P(this.g(),this.xhr,"success",this.Ee);var c=this.fa.getAttribute("data-question_id"),c=c?"&question_id="+c:"&question_id=0",d=this.fa.getAttribute("data-answer_id");this.xhr.ajax("/reviewq/"+this.BM,"queue_id="+this.Lb+"&is_realm="+this.ge+"&action=add_comment&task_id="+this.fa.getAttribute("data-task_id")+c+(d?"&answer_id="+d:"&answer_id=0")+"&comment="+encodeURIComponent(b)+"&none_queue="+this.fa.getAttribute("data-none_queue"))};
a.Yy=function(b){return J("zm-comment-form",b.fa)};a.$y=function(b){this.aR=this.locked=n;this.url=b||"/reviewq/image"};y($y,el);ya($y.prototype,Oy.prototype);t=$y.prototype;t.dx=q("e");t.XB={"remove-question":"delete_question","collapse-answer":"collapse","uncollapse-answer":"uncollapse","remove-answer":"delete_answer","remove-image":"delete_image","remove-video":"delete_video"};t.nz=function(){this.locked=n};
t.n=function(b){this.e=b;var b=J("zm-item-rich-text",this.e),c=K("div","zm-item-answer-summary"),d=b.innerHTML.replace(/<br>/g," "),e;e=d.replace(/<p class="video-info">(.+?)<\/p>/g,"");e=e.replace(/<(\/)?b>/g,"").replace(/<(\/)?i>/g,"").replace(/<(\/)?u>/g,"");d=e.replace(/<[^>]+>/g," ").replace(/\s+/g," ");e=-1<b.innerHTML.indexOf("<img")||-1<b.innerHTML.indexOf("<IMG");var g=-1<b.innerHTML.indexOf("video-box"),h=Lk(d),l="",m=e||g;150<h?(m=j,l=d.substring(0,100)+"… "):3<b.innerHTML.split("br").length?
(m=j,l=d):l=m?d:b.innerHTML;d=g?' <span class="zg-content-video-icon"></span>':' <span class="zg-content-img-icon"></span>';if(e||g)l+=d;m&&(l+='<a href="javascript:;" class="zg-inline-block" name="expand">显示全部 »</a>');c.innerHTML=l;mc(c,b);this.Ez();this.Ea()};t.Ez=function(){this.vL=this.e.getAttribute("data-answer_id");this.S_=this.e.getAttribute("data-question_id");this.NQ=this.e.getAttribute("data-task_id")};t.Ea=function(){this.g().c(this.e,"click",this.Wl)};
t.Wl=function(b){if(!b.target.name||this.aR)return j;this.ha(b.target.name,b.target)};a.az=function(b){D.has(b.e,"zm-item-unread")&&(b.locked=j,D.remove(b.e,"zm-item-unread"),Ei(b.url,v(function(){this.locked=n},b),"POST","task_id="+b.NQ));if(b=J("zm-image-queue-button-pass",b.e))b.innerHTML="已处理",D.Ui(b,"zm-image-queue-button-pass","zg-link-gray-normal zg-right")};
t.ha=function(b,c){if(!this.locked){this.DZ=c;var d=j,e=c.getAttribute("data-op");if(e)switch(e){case "collapse-answer":case "uncollapse-answer":Qy(this,c,function(){Py(c,"collapse-answer"===e?"uncollapse-answer":"collapse-answer");az(this)});break;case "remove-answer":Qy(this,c,function(){L(this.e);az(this)});break;case "remove-question":Qy(this,c,function(){L(this.e);az(this)});break;case "remove-image":case "remove-video":var g=tc(c),h,d=g.getAttribute("data-imageid"),l=g.getAttribute("data-videoid");
d?h="image_hash="+d:l&&(h="video_id="+l);Qy(this,c,function(){var b=Kc(g,"li");R(b,n);this.locked=n},h)}else{switch(b){case "pass":az(this);R(this.e,n);break;case "expand":D.remove(this.e,"zm-item-collap");break;default:d=n}if(!d)return j}}};a.bz=function(b,c,d){M.call(this);this.m0=d;this.DK=b;this.PV=c;this.eB=n};y(bz,el);bz.prototype.w=function(){this.g().c(this.DK,"click",this.cO)};bz.prototype.cO=function(){this.eB=!this.eB;R(this.PV,this.eB)};a.cz=function(){M.call(this);this.wt=0;this.$k=[];this.Hy=0};y(cz,el);t=cz.prototype;t.Hf=function(b){var c=b.id.split("-")[1],d=new V(j),e=0,g=Kc(b,k,"zm-item");g&&(-1<b.innerHTML.indexOf("取消")?(Tf(g,"background","#fff"),b.innerHTML="折叠",D.Ui(b,"zg-unfollow","zg-follow"),e=0):(Tf(g,"background","#ddd"),b.innerHTML="取消折叠",D.Ui(b,"zg-follow","zg-unfollow"),e=1));d.ajax("/review/api/collapse_answer","is_collasped="+e+"&answer_id="+c)};
t.zk=function(){this.Ck=new V(n);P(this.g(),this.Ck,"success",this.Gx);this.Ck.ajax("/reviewq/sidebar?queue_id="+this.Lb,k,"GET")};t.Gx=function(){var b=Ie(this.Ck);if(!b||!b.r){var c=b.msg,b=Xb("zm-review-queue-live-udatable-num");z.forEach(b,function(b){var e=b.getAttribute("data-key");e&&(e=c[e],e!=k&&(b.innerHTML=e))});setTimeout(v(this.zk,this),1E4)}};
t.w=function(){var b=H("zh-queue-wrap");if(b){var c=new Ny(b,window.location.href,"queue",["zg-btn-follow","zg-btn-unfollow"],j);this.g().c(b,"click",this.VG);c.w()}(b=H("zh-review-queue-online-reviewers"))&&(new Ny(b,window.location.href,k,k,j)).w();if(b=H("zh-queue-content-list"))this.dV=b,this.g().c(Y,dt.rY,this.YO),b=new Ny(b,window.location.href,"queue",["zg-btn-follow","zg-btn-unfollow"],j),b.Om(Hy),b.w(),this.g().c(H("zh-queue-outer-wrap"),"click",this.VG);(b=H("zh-queue-content-list-v2"))&&
(new Uy).w(b);if(b=H("zh-image-queue-list-wrap"))this.Lb=(c=H("queue_id"))?c.value:0,this.zk(),b=Xb("zm-item",b),z.forEach(b,function(b){(new $y).n(b)});if(b=H("zh-video-queue-list-wrap"))this.Lb=(c=H("queue_id"))?c.value:0,this.zk(),b=Xb("zm-item",b),z.forEach(b,function(b){(new $y("/reviewq/video")).n(b)});if(b=H("zh-inferiority-queue-list-wrap"))this.Lb=(c=H("queue_id"))?c.value:0,this.zk(),b=Xb("zm-item",b),z.forEach(b,function(b){(new $y("/reviewq/inferiority")).n(b)});if(Lg){b=Lg;this.wt=b[0];
var d=[];z.forEach(b[1],function(b){d.push(b)});this.$k=d}if(b=H("zh-queue-create-wrap"))this.ci=b,this.g().c(this.ci,"click",this.ha),(b=H("zh-queue-delete"))&&this.g().c(b,"click",this.dN),(new bz(H("add-desc"),H("add-desc-toggle-wrap"))).w(),(new bz(H("zh-queue-add-admin"),H("zh-queue-add-admin-toggle-wrap"))).w(),this.fI=H("zh-queue-rules-wrap"),this.IV=H("zh-queue-name-input"),this.fN=H("zh-queue-desc-input"),this.Dw=H("zh-queue-error-message"),this.SK=H("zh-queue-admin-selector"),this.mC=H("zh-queue-admin-members-wrap"),
this.M=new go("/people/autocomplete",this.SK,k,k,H("zh-queue-add-admin-toogle-wrap"),j),this.M.Kf(j),this.g().c(this.M,"select",this.lp),this.rU=H("zh-queue-rule-template").innerHTML;if(b=H("zh-queue-delete"))this.bN=b,this.g().c(b,"click",this.Xl)};t.Xl=function(){Ei("/review/queues/delete",function(){window.location.href="/review"},"POST","queue_id="+this.bN.name)};
t.lp=function(){var b=z.slice(this.M.lg(),1),c=b[3],d=1;z.forEach(this.$k,function(b){b===c&&(d=n)});d&&this.$k.push(c);b=['<div class="zm-item" id="adm-',b[3],'"><a class="zg-right" name="remove_admin" href="javascript:;">删除</a><a class="zm-item-link-avatar" href="/people/',b[1],'" style="float:none"><img title="',b[0],'" src="',b[2],'" class="zm-item-img-avatar" /></a></div>'].join("");this.mC.innerHTML+=b};
t.ha=function(b){if((b=Gk(this.ci,b.target))&&b.name)switch(b.name){case "remove_rule":b=Kc(b,k,"zg-section");L(b);break;case "zh-queue-add-rule-button":b=K("div");b.innerHTML=this.rU;this.fI.appendChild(b);break;case "add_queue":this.xhr=new V(j);P(this.g(),this.xhr,"success",this.oC);b=new Hk(j);b.add("id",this.wt);b.add("title",this.IV.value);b.add("bio",this.fN.value);var c=[],d=Wb("SELECT",k,this.fI);d&&d.length&&z.forEach(d,function(b){(b=Dx(b))&&c.push(b)});b.add("subscrible",c.join(","));
b.add("maintainer",this.$k.join(","));this.wt?this.xhr.ajax("/review/queues/update",b.Lc()):this.xhr.ajax("/review/queues/new",b.Lc());break;case "remove_admin":var b=Kc(b,k,"zm-item"),e=b.id.split("-")[1];L(b);var g=[];z.forEach(this.$k,function(b){b!==e&&g.push(b)});this.$k=g}};t.dN=function(){this.xhr=new V(j);P(this.g(),this.xhr,"success",this.oC);this.xhr.ajax("/review/queues/delete","id="+this.wt)};
t.oC=function(){var b=Ie(this.xhr);b&&!b.r?(R(this.Dw,n),b.msg&&(window.location.href=b.msg)):(b=b.msg,this.Dw.innerHTML=ma(b)?b.join("<br />"):b,R(this.Dw,j))};t.YO=function(b){this.Hy++;300<this.Hy&&window.location.reload();var b=b.nb,c=K("div");c.innerHTML=b;lc(c,sc(this.dV));Ck(c)};t.VG=function(b){if((b=Gk(H("zh-queue-outer-wrap"),b.target))&&b.name)switch(b.name){case "collapse":this.Hf(b,1);break;case "uncollapse":this.Hf(b,0)}};a.dz=function(){this.JV=$("#tmpl-feedback-form").text()};ia(dz);a.ez=Wi("Report"+S.Yj)||Xi("Report"+S.Yj);dz.prototype.R={title:"建议和反馈"};dz.prototype.rv=function(b){var c=$("#zh-feedback-form"),d=$("select",c),c=$("textarea",c);new Po(c[0]);d.toggle(!b.type);c.html(ez.get("content")||"");c.on("input change",function(){ez.set("content",this.value)})};
dz.prototype.create=function(b){var c=$.extend(this.R,b||{});Ci(c.title,this.JV,function(b){if(b){var e=$("#zh-feedback-form"),b=$(".zg-report-msg",e),g=$("textarea",e),e=$("select",e),e=c.type||e.val(),h=$.trim(g.val());h?(b.hide(),b=new V(j),g=new fj,b.on("success",function(){U("建议发送成功，我们会尽快处理，感谢您的帮助");ez.remove("content")}),g.add("type",e).add("content",h),b.ajax("/feedback/report",g.toString()),b=i):(b.html("请填写反馈内容").show(),g.focus(),b=n);return b}},this);this.rv(c)};$(function(){$("#js-feedback-button").click(function(){dz.F().create()})});a.fz=function(){M.call(this)};y(fz,el);
fz.prototype.w=function(){var b=H("zh-search-result-more");b&&this.g().c(b,"click",function(c){(c=Gk(b,c.target))&&c.name&&c.id&&"focus"===c.name&&Kk(c,c.id.split("-")[0])});var c=H("zm-search-result-topic-info");c&&this.g().c(c,"click",function(b){(b=Gk(c,b.target))&&b.name&&b.id&&"focus"===b.name&&Kk(b,"topic",k,["zg-btn-follow","zg-btn-unfollow"])});var d=H("zm-search-result-people-info");d&&this.g().c(d,"click",function(b){(b=Gk(d,b.target))&&b.name&&b.id&&"focus"===b.name&&Kk(b,"people",k,["zg-btn-follow",
"zg-btn-unfollow"])});var e=H("zm-search-result-answers");e&&(e=Xb("feed-item-hook",e),z.forEach(e,function(b){(new Cx).n(b)}));e=$("#zh-search3-list > .zh-general-list");e.length&&((new Wt({Pa:["nodeSource"],zA:20<=e.children().length})).n(e[0]),$(".search-debug-all-btn").click(function(){$("#zh-search3-list").toggleClass("debug")}));$("#zh-search-report").click(function(){dz.F().create({type:"search_suggest",title:"新搜索建议反馈"})});var g=this;$("#zh-search3-list").on("click",".zm-search3-item",function(b){b=
$(b.delegateTarget).find(".zm-search3-item").index(this)+1;Nf.set("s-q",encodeURIComponent(fs(new vf(location.href),"q")));Nf.set("s-i",b);Nf.set("sid",g.cV())})};fz.prototype.cV=Tr(function(){return(+new Date).toString(32).slice(-5)+Math.random().toString(32).slice(-3)});a.gz=function(){T.call(this);this.ea=k};y(gz,T);gz.prototype.B=function(){gz.m.B.call(this);this.g().c(this.e,"submit",function(b){b.preventDefault();this.save()})};gz.prototype.save=function(){this.update(hz(this))};gz.prototype.update=function(b){if(!(this.ea&&"pending"===this.ea.state())){var c=$(this.e).data("init"),b={method:"save",params:$.extend({},c.params||{},{settings:b})};this.ea=$.post("/node/"+c.nodename,b,v(this.Bf,this))}};
gz.prototype.Bf=function(b){b&&(b[0]?this.dispatchEvent({type:"success",data:b}):this.dispatchEvent({type:"error",data:b}))};a.hz=function(b){b=$(b.e);b=b.serializeArray().concat($("input:checkbox",b).map(function(){return{name:this.name,value:this.checked?this.value:0}}).get());return z.reduce(b,function(b,d){b[d.name]=d.value;return b},{})};a.iz=function(){T.call(this);this.RZ=[];this.Q_="/profile/validate";this.YV="/settings/unblockuser"};y(iz,T);
iz.prototype.w=function(){var b=this,c=$("#zh-settings-noti-form-wrapper>form")[0];if(c){var d=new gz;d.n(c);d.addEventListener(["success","error"],function(b){window.scrollTo(0,0);Kr(E.Ka(b.data),3E3)})}var e=$(".js-ajax-form");e.submit(function(b){var c=$(b.target),b=c.attr("action")||location.href;$.post(b,c.serialize()).done(function(b){Kr(E.Ka(b),5E3);c.hasClass("unsubscribe")&&(e.remove(),$(".settings-section").remove())});return n});$(".js-unsubscribe-other-reason").on("change",function(b){$(b.target).parent().siblings().find(".zg-form-text-input").toggle()});
$("#weibopageenable").on("change",function(b){b=$(b.target);$.post("/node/SettingsWeiboPageV2",{method:b.is(":checked")?"enable":"disable"}).done(function(b){b.r?U(b.msg):Kr([n,"保存成功"])});return n});c=$("#js-settings-account-form");if(c.length){var g=tk(function(){new El(H("password"))}),d=$("#url_token"),h=$("#js-url-preview .token");d.on("input change keyup",function(){h.text($.trim(this.value))});var l=$("#email"),m=function(){$("#js-email-confirm").show();l.off("focus",m);g()};l.one("focus",m);
$(function(){document.activeElement===l.get(0)&&m()});$(".resend-mail",c).click(function(){var b=$(this);Ki.dispatchEvent("/activation/resend-email");$.post("/reactive",function(c){c.r?U(c.msg):b.replaceWith("已发送")});return n});jz(c);var d=new Un,p=$(".rename-tab",c);d.n(p.get(0));var r=function(){$("input[placeholder]:visible",p).placeholder()};d.on("select",r);var x=$(".rename-button",c),c=function(){x.remove();p.show();r()};x.one("click",c);"#rename-section"===location.hash&&c()}c=$("#js-form-account-password");
c.length&&($("input[placeholder]",c).each(function(){new El(this)}),jz(c));(c=H("zh-topic-block-editor"))&&(new Qs(Jg)).n(c);(c=H("zh-setting-page-bind-wrap"))&&(new ny).n(c);if(c=$(".zh-general-list").get(0))d=new Wt({Pa:["autoload","nodeSource"]}),this.J(d),d.n(c),this.g().c(c,"click",this.QR);$(".zu-main-content-inner form").on("change","input, textarea, select",function(){b.vw("SettingsPage")}).on("submit",function(){b.ew("SettingsPage")})};
iz.prototype.vw=function(){$(window).on("beforeunload.SettingsPage",v(s("你的修改还未保存，确认离开该页面吗？"),this))};iz.prototype.ew=function(){$(window).off("beforeunload.SettingsPage")};a.jz=function(b){$(".zg-form-text-input",b).each(function(){function b(){this.value!==this.defaultValue&&(e.hide(),d.off("change input keyup",b))}var d=$(this),e=d.next(".validate-error");if(e.length)d.on("change input keyup",b)})};
iz.prototype.QR=function(b){var c=b.target;if(c&&c.name){var d=c.id.split("-")[1];Ci("取消黑名单","取消黑名单之后，对方将可以：关注你、给你发私信、向你提问、评论你的答案、邀请你回答问题。",function(b){if(b){var b=Kc(c,k,"zm-item"),g=xa(L,b),b=new V(j);P(this.g(),b,"success",function(){g&&g();var b=Xb("zm-item",H("zh-setting-page-black-list-wrap"));(!b||!b.length)&&window.location.reload()});b.ajax(this.YV,"uid="+d)}},this)}};a.kz=function(){M.call(this);this.U=k;this.Qj=0;this.$J="/oauth/friends/sina";this.nK="/invitation/sina";this.Bc=new Jd(200)};y(kz,el);t=kz.prototype;t.w=function(){this.li||(this.li=j,this.o(),this.Ea(),lz(this))};t.show=function(){this.w();this.U.z(j);var b=new Ob(this.U.h().offsetLeft,this.U.h().offsetTop);b.y=102;$f(this.U.h(),b)};t.o=function(){var b=H("zh-invitation-sina-diag");b&&(this.e=b,this.U=new yi(k,n),this.U.fb("邀请微博好友"),Ih(this.U,k),this.U.ba().appendChild(this.e))};
t.ha=function(b){if("cancel"===b.target.name)this.U.z(n);else if("invite"===b.target.name){var b=Xb("zm-item-checkbox-right",this.Uj),c=[];z.forEach(b,function(b){b.checked&&(c.push(b.value),b.checked="")},this);c&&c.length&&(this.Mz=new V(j),this.g().c(this.Mz,"complete",this.aL),this.Mz.ajax(this.nK,"sinaids="+c.join(",")))}};
a.mz=function(b,c){b.Qj=c?b.Qj+1:b.Qj-1;b.FF.innerHTML=b.Qj+""},a.lz=function(b,c){b.lG||(b.lG=j,b.xhr=new V(j),P(b.g(),b.xhr,"complete",b.Af),b.xhr.ajax(b.$J,c?"force=1":""))};t.Af=function(){this.lG=n;var b=Ie(this.xhr);b&&!b.r?this.setData(b):U(b.msg)};
t.setData=function(b){this.VM=j;this.uW.innerHTML=+b[0];this.Qj=+b[1];this.FF.innerHTML=this.Qj+"";this.data=b=b[3];var c=[];z.forEach(b,function(b){c.push(['<div class="zm-item zm-item-h50"><input type="checkbox" value="',b[0],'" class="zm-item-checkbox-right" /><img class="zm-list-avatar-medium" src="',b[2],'" /><div class="zm-list-content"><strong class="zg-gray-normal">',b[1],'</strong><div class="zg-gray-normal">',b[3],"</div></div></div>"].join(""))},this);this.Uj.innerHTML=c.join("")};
t.Ea=function(){this.Mt=J("zg-form-text-input",this.e);(new gp("搜索微博好友")).n(this.Mt);this.bj=J("zm-command",this.e);this.Uj=H("zh-invitation-sina-friends-list");this.PT=H("zh-invitation-sina-force-refresh");this.g().c(this.PT,"click",function(){this.Uj.innerHTML="列表刷新中，请稍侯...";lz(this,j)});this.g().c(this.Uj,"click",this.HR);var b=Wb("strong",k,this.e);this.uW=b[0];this.FF=b[1];this.g().c(this.Mt,"focus",this.SA).c(this.Mt,"blur",this.WA).c(this.Bc,Kd,this.MS);this.g().c(this.bj,"click",this.ha)};
t.HR=function(b){var c=Kc(b.target,k,"zm-item");if(c){var d=k,e=Wb("input",k,c)[0];if(D.has(c,"zm-item-active"))D.remove(c,"zm-item-active"),mz(this,j),d=n;else{var g;0>=this.Qj?(U("您的邀请码已经用完"),g=n):g=j;g?(D.add(c,"zm-item-active"),mz(this,n),d=j):"INPUT"===b.target.tagName&&b.preventDefault()}"INPUT"!==b.target.tagName&&(e.checked=d);b.stopPropagation()}};t.SA=function(){this.Bc.start()};t.WA=function(){this.Bc.stop()};
t.MS=function(){if(this.VM){this.items||(this.items=Xb("zm-item",this.Uj));var b=this.Mt.value;b==k||""===b?z.forEach(this.items,function(b){R(b,j)}):z.forEach(this.data,function(c,d){this.items[d]&&(b===c[0]||-1<c[1].indexOf(b)?R(this.items[d],j):R(this.items[d],n))},this)}};t.aL=function(){var b=Ie(this.Mz);b&&!b.r?(U("邀请发送完毕"),this.U.z(n)):U(b.msg)};a.nz=function(){M.call(this);this.SJ="/oauth/unbind/sina"};y(nz,el);nz.prototype.w=function(){var b=H("zh-invite-send-invite-sina");b&&this.g().c(b,"click",this.$U);(b=H("zh-invitation-cancel-bind-sina"))&&this.g().c(b,"click",this.SS)};nz.prototype.$U=function(){this.II||(this.II=new kz);this.II.show()};
nz.prototype.SS=function(){Ci("解除绑定","你确定要解除与新浪微博的绑定吗？",function(b){if(b){var c=new V(j);P(this.g(),c,"success",function(){var b=Ie(c);b&&!b.r?window.location.reload():U(b.msg)});c.ajax(this.SJ)}},this)};a.oz=function(b){M.call(this);this.url=b||"/topic"};y(oz,el);t=oz.prototype;t.n=function(b){this.element=b;var c=$("<ul>");this.eJ=$("<li>");c.append(this.eJ);$(b).append(c);this.fJ||(this.fJ=j,this.pB=new V(j),P(this.g(),this.pB,"success",this.cS),this.pB.ajax(this.url,k,"POST"))};t.cS=function(){var b=Ie(this.pB);b&&(b&&b.r?U(b.msg):(pz(this,this.eJ,b.msg),this.fJ=n,this.B()))};t.B=function(){this.g().c(this.element,"click",this.dp)};
t.dp=function(b){var c=(b=b.target)?b.name:"";if(c)switch(c){case "load":case "loadmore":if(!this.So){var c=b.getAttribute("data-token"),d=b.getAttribute("data-parent");this.So=j;this.Xj=new V(j);P(this.g(),this.Xj,"success",this.Fq);this.lA=b.parentNode;this.lA.innerHTML='<span class="zg-gray">加载中...</a>';this.Xj.ajax(this.url+"?child="+c+"&parent="+d,k,"POST")}break;case "topic":window.location.href=b.href}};
a.pz=function(b,c,d){var e=d[0],g="";"topic"!==e[0]&&e[3]&&(g='data-parent="'+e[3]+'"');c.html('<a href="'+("topic"===e[0]?"/topic/"+e[2]+"/organize/entire":"javascript:;")+'" data-token="'+e[2]+'" '+g+' name="'+e[0]+'">'+e[1]+"</a><ul class='zm-topic-organize-list'></ul>");"topic"!==d[0][0]&&c.addClass("zm-topic-organize-loadmore");c=$("ul",$(c));if(1<d.length){d=d[1];for(e=0;e<d.length;e++){var g=d[e],h=$("<li>").addClass("zm-topic-organize-item");c.append(h);pz(b,h,g)}}};
t.Fq=function(){var b=Ie(this.Xj);if(b)if(b&&b.r)U(b.msg);else if(b=b.msg,b[1]){$(this.lA).hide();for(var c=$(this.lA.parentNode),d=0;d<b[1].length;d++){var e=b[1][d],g=$("<li>").addClass("zm-topic-organize-item");"topic"!==e[0][0]&&g.addClass("zm-topic-organize-loadmore");c.append(g);pz(this,g,e)}this.So=n}};a.qz=function(b,c,d){kr.call(this,b,c,d)};y(qz,kr);qz.prototype.Bf=function(b){Gg[0][0]===b?this.vh():qz.m.Bf.apply(this,arguments)};qz.prototype.nC=function(b){if(b=Ie(b.target))b.r?U(b.msg):b.msg&&(window.location.href=b.msg)};a.rz=function(b){this.Ec=this.Eu=k;E.extend(this.D={},this.R,b||{})};y(rz,T);rz.prototype.R={options:{},WL:".zh-answers-filter",wT:".zh-answers-filter-popup"};
rz.prototype.B=function(){rz.m.B.call(this);var b=this,c=this.D,d=$(this.e),e=$(c.WL,d),g=$(c.wT,d);b.Eu=g;e&&(A&&e.add(g).css("line-height","25px"),e.attr("tabindex",0),this.Eu.html(sz(this)),e.add(g).hover(function(){g.show()},function(){g.hide()}),g.on("click",".selectable",function(){var c=$(this),d=c.text(),c=c.data("key");g.hide();$(".lbl",e).text(d);b.Ec=c;b.Eu.html(sz(b));b.dispatchEvent({type:"change",data:{key:c}});Y.V({type:"ga_click_sorter_item",target:b,data:{key:c}})}))};
rz.prototype.X=q("Ec");rz.prototype.ua=ca("Ec");a.sz=function(b){var c=b.Ec;return $.map(b.D.options,function(b,e){return'<div tabindex="0" class="'+(e===c?"active":"selectable")+'" data-key="'+e+'"><span class="lbl">'+b+'</span><i class="zg-icon zg-icon-double-arrow"></i></div>'}).sort(function(b){return 0<=b.indexOf("active")?-1:1}).join("")};a.tz=function(){T.call(this);var b=Gg;this.Of=b[0][3];this.mu=b[0];this.U_=b[1];this.l_=b[2];this.t_=b[3];this.An=b[4];this.Jo=b[5];this.oh="topic"};y(tz,T);t=tz.prototype;t.w=function(){yl.J(this);this.n(document.body)};
t.B=function(){function b(b){b&&b.msg&&U(b.msg)}tz.m.B.call(this);var c=H("zh-topic-side-head");if(c){var d=J("zu-entry-focus-button",c);(this.EN=d)&&this.g().c(d,"click",function(){Kk(d,"topic","",["zg-btn-green","zg-btn-white"])});(this.vg=H("zh-topic-operation-menu"))&&this.g().c(this.vg,"click",this.CA)}if(c=H("zh-current-topic-bio")){var e=new kr(j,"/topic/bio/update","bio");e.rd=["tid="+this.Of];e.Bb='<a href="javascript:;" name="edit">你在 '+this.mu[0]+" 话题中的经验</a>";e.wr=j;e.n(c)}(c=H("zh-topic-top-answerer"))&&
(new Tn(c,"people",["zg-follow","zg-unfollow"])).w();if(c=H("zh-topic-direct-question-list"))c=new Ny(c,k,"question",k,j),c.If("question-item"),c.w();if(c=H("zh-topic-log-list"))c=new Ny(c,k,k,k,j),c.Om(Hy),c.w();if(c=H("zh-topic-title"))this.Nd=new qz(n,"/topic/update","title"),this.Nd.rd=["tid="+this.Of],this.Nd.n(c),$(c).on("click",".js-pin",function(){var b=$(this),c=b.attr("data-action");$.post(c,{tid:Gg[0][3]}).done(function(c){c.r?U(c.msg):b.replaceWith(b.hasClass("pin")?'<a href="javascript:;" data-action="/pin-topic/remove" class="js-pin zg-gray unpin topic-hover-content"><i class="z-icon-unpin"></i>取消固定</a>':
'<a href="javascript:;" data-action="/pin-topic/add" class="js-pin zg-gray pin topic-hover-content"><i class="z-icon-pin"></i>固定话题</a>')})});if(c=H("zh-topic-desc"))e=$(c).find(".zm-editable-content").data("editable-maxlength"),this.Un=new nr(j,"/topic/update","description",e),this.Un.Bb='<a href="javascript:;" name="edit">添加话题描述</a></div>',this.Un.rd=["tid="+this.Of],this.Un.Xq=n,this.Un.qJ=n,this.Un.n(c);if(c=H("zh-topic-faq"))this.Jr=new nr(j,"/topic/"+encodeURIComponent(Gg[0][1])+"/faq","content",
400),this.Jr.Bb='<div class="zm-topic-faq-container"><div class="zg-gray-normal">常见问题是该话题下经常会提到的问题的整理，以便后来者查阅（<a href="http://www.zhihu.com/question/20388061" class="zg-link-litblue">如何创建？</a>）</div><a href="javascript:;" name="edit" class="zg-link-litblue"><span class="zg-blue-edit"></span>为「'+Gg[0][0]+"」添加常见问题</a></div>",this.Jr.o0=function(b){return!b?"":b.replace(/(<\/?(?!ul|li|a|br)[^>\/]*)\/?>/gi,"")},this.Jr.Xq=n,this.Jr.n(c);if(Og)$("div.topic-avatar").addClass("disabled");else if(c=J("zm-entry-head-avatar-edit-button")){var e=
new ly(2,Gg[0][3]),g=J("zm-avatar-editor-preview");e.n(c);N(e,"beforepost",function(){$("<div class='avatar-edit-preview-loading topic'><span></span></div>").appendTo(g.parentNode)});N(e,"success",function(b){g&&(g.src=b.src);$(".avatar-edit-preview-loading").remove()})}if(c=H("zh-topic-feed-list"))e=new Wt,this.J(e),e.Pa("locationSource",{Fy:0,offset:function(b){return z.Df(b).getAttribute("data-score")}}),e.Pa("childConstructor",{Tg:Cx}),e.n(c),this.g().c(e,"click!",function(b){"comment"===b.namespace&&
b.Dc.fill("category",this.oh).fill("label","topic_activity")});if(c=H("zh-topic-top-page-list"))e=new Wt({zA:n}),this.J(e),e.Pa("childConstructor",{Tg:Cx}),e.n(c),this.g().c(e,"click!",function(b){"comment"===b.namespace&&b.Dc.fill("category",this.oh).fill("label","topic_activity")});var h=this;h.bb&&h.g().c(h.bb,"afterload",function(b){Y.V({type:"ga_click_topic_more",data:b.data,target:h.bb.bc})});if(c=H("zh-topic-followers-list-wrap"))c=new Ny(c,["/topic",encodeURI(this.mu[1]),"followers"].join("/"),
k,["zg-btn-follow","zg-btn-unfollow"],j),c.If("zm-person-item"),c.w();if(H("zh-topic-organize-page-wrap")){if(c=H("zh-topic-organize-parent-editor"))e=new zs(k,this.Of,j),e.bt=j,e.n(c),e.qC=n,e.addEventListener("remove_tag",function(b){(b=b.data&&b.data.id)&&$("#wedge-"+b).remove()});if(c=H("zh-topic-organize-child-editor"))e=new zs(k,this.Of,n),e.bt=j,e.n(c),$("a.entire-link").insertAfter(e.Vn).show();$("#zm-topic-manage-relation").on("change",'[type="checkbox"]',function(){var b=$(this).closest("li").attr("id").split("-")[1];
$.post("/topic/update",{action:"set_topic_edge",parent_topic_id:b,topic_id:Gg[0][3],edge:this.checked^0}).done(function(b){b&&b.msg&&U(b.msg)})});this.ev=H("zh-topic-alias-input");new El(this.ev,"输入话题别名");this.fv=H("zh-topic-alias-list");this.g().c(H("zh-topic-alias-container"),"click",this.PS);if(c=H("zh-topic-merge"))this.Qa=new Rs,this.Qa.n(c);(c=H("zh-topic-merge-btn"))&&this.g().c(c,"click",this.rS)}(c=H("zh-topic-organize-page-children"))&&(new oz("/topic/"+encodeURIComponent(Gg[0][1])+"/organize/entire")).n(c);
if(c=H("zh-topic-side-related-topics"))this.ST=c,this.Vz=new V(n),this.g().c(this.Vz,"complete",this.BS),this.Vz.ajax("/topic/related?tid="+this.Of);H("zh-topic-admin-page-wrap")&&(c=H("zh-topic-del-btn"))&&this.g().c(c,"click",this.ZR);if(c=H("zh-topic-log-list-wrap"))c=new Ny(c,["/topic",encodeURI(this.mu[1]),"log"].join("/"),k,["zg-btn-follow","zg-btn-unfollow"],j),c.Om(Hy),c.w();this.ey();(c=J("zm-topic-search-input-new"))&&new El(c,"在话题中搜索");var l=$(c);Dg.Oc||l.focus(function(){l.addClass("stretch-to")}).blur(function(){l.removeClass("stretch-to")});
(c=J("zm-topic-ask-in-topic"))&&this.g().c(c,"click",this.Vt);(c=J("zm-topic-feed-container"))&&(new Tn(c,"question",["zg-follow","zg-unfollow"])).w();(c=H("zh-topic-side-children-list"))&&(new Tn(c,"topic",["zg-follow","zg-unfollow"])).w();(this.ss=H("zh-topic-info-add"))&&this.g().c(this.ss,"submit",this.mS);(this.sF=J("zm-topic-info-content-main",this.e))&&this.g().c(this.sF,"click",this.kS);$("#zh-topic-manage-info-form").on("change",'input[type="radio"]',function(){$.post("/topic/"+Gg[0][1]+
"/information/manage",{info:$(this).val(),action:"change"}).done(b)});$("#zh-topic-manage-relation-form").on("change",'input[type="radio"]',function(){$.post("/topic/update",{action:"set_topic_weaknode",topic_id:Gg[0][3],weak:$(this).val()}).done(b)});$("#zh-topic-manage-lock-form").on("change",'[type="checkbox"]',function(){$.post("/topic/lock",{url_token:Gg[0][1],lock_type:this.name,lock_value:$(this).is(":checked")?1:0}).done(b)});(c=H("zh-topic-info-add"))&&z.forEach(qc(c),function(b){var c;b&&
(b.getAttribute&&(c=b.getAttribute("data-placeholder")))&&new El(b,c)});S.ye||$(".js-may-disable").click(function(){zl.F().z(j);return n})};
t.rS=function(){this.or=this.Qa.xD;if(!this.vG&&this.or){this.vG=j;this.Uy=new V(j);P(this.g(),this.Uy,"success",this.bL);this.Uy.ajax("/topic/"+encodeURIComponent(Gg[0][1])+"/demand","action=merge&target_topic_id="+this.or[3]);var b=H("zh-topic-merged-msg");R(H("zh-topic-merge"),n);R(b,j);b=Wb("a",k,b)[0];b.href="/topic/"+this.or[1];b.innerHTML=this.or[0];this.Qa&&(this.Qa.Ra.value="")}};t.bL=function(){var b=Ie(this.Uy);b&&b.r?U(b.msg):this.vG=n};
t.ZR=function(){this.ID||(this.ID=j,this.aw=new V(j),P(this.g(),this.aw,"success",this.XK),this.aw.ajax("/topic/"+encodeURIComponent(Gg[0][1])+"/demand","action=remove"))};t.XK=function(){var b=Ie(this.aw);b&&b.r?U(b.msg):(b=H("zh-topic-del-msg"),R(H("zh-topic-del-btn"),n),R(b,j),this.Qa&&(this.Qa.Ra.value=""),this.ID=n)};
t.PS=function(b){if((b=b.target)&&b.name)if("add"===b.name){if(b=this.ev.value)this.gv=new V(j),P(this.g(),this.gv,"complete",this.UK),this.gv.ajax(window.location.href,"action=add_alias&alias="+encodeURIComponent(b))}else"remove"===b.name?(this.Wz=new V(j),b=b.parentNode.getAttribute("data-token"),P(this.g(),this.Wz,"complete",this.gL),this.Wz.ajax(window.location.href,"action=remove_alias&alias_token="+b)):"remove-merged"===b.name&&(this.Zz=new V(j),b=b.parentNode.getAttribute("data-token"),P(this.g(),
this.Zz,"complete",this.hL),this.Zz.ajax("/topic/"+encodeURIComponent(Gg[0][1]+"/demand"),"action=remove&target_topic_id="+b))};t.hL=function(){var b=Ie(this.Zz);b&&b.r?U(b.msg):uz(this,b.msg)};t.gL=function(){var b=Ie(this.Wz);b&&b.r?U(b.msg):uz(this,b.msg)};a.uz=function(b,c){var d=Wb("li",k,b.fv);z.forEach(d,function(b){b.getAttribute("data-token")===c[1]&&R(b,n)})};
t.UK=function(){var b=Ie(this.gv);if(b&&b.r)U(b.msg);else{var b=b.msg,c=K("li");c.setAttribute("data-token",b[1]);c.innerHTML=b[0]+' <a name="remove" href="javascript:;" class="zg-link-gray">移除</a>';this.fv.appendChild(c);this.ev.value="";R(this.fv.parentNode,j)}};t.CA=function(b){this.xz?this.jb.S()?this.jb.z(n):(this.jb.z(j),b.stopPropagation(),b.preventDefault(),this.hl()):(b.stopPropagation(),b.preventDefault(),this.Nj(),this.hl());this.xz=j};t.hl=function(){P(this.g(),document,"click",function(){this.jb.z(n)})};
t.Nj=function(){var b=H("zh-topic-side-head"),c=this.vg.getAttribute("data-auth");this.jb=new ou;this.Mx=j;"f-topic-manage"===c&&this.jb.Fa(this.WS=new lu("管理话题"));this.jb.Fa(this.XS=new lu("组织话题"));this.jb.Fa(this.VS=new lu("话题日志"));this.Mx&&(this.jb.Z(b),this.g().c(this.jb,"action",this.Cj))};t.Cj=function(b){var c="";b.target===this.WS?c="admin":b.target===this.XS?c="organize":b.target===this.VS&&(c="log");window.location.href=["/topic",this.mu[1],c].join("/")};
t.BS=function(){var b=Ie(this.Vz);if(b&&!b.r){var c=[];z.forEach(b,function(b){c.push(wk(b,k,j))});this.ST.innerHTML=c.join("")+'<div class="zg-clear"></div>';b.length&&R(H("zh-topic-side-related-topics-wrap"),j)}};t.ey=function(){var b=H("zh-topic-search-list");b&&(this.bb=new Bx(b,k,j),this.bb.If("zm-search-result-item"),this.bb.dt=function(b){if(b&&0!==b.length)return b[b.length-1].getAttribute("data-offset")},this.bb.w())};
t.kS=function(b){var c=b.target;c&&c.name&&"remove"===c.name&&(this.XP=c,this.tF||(this.tF=j,this.Yx=new V(j),this.g().c(this.Yx,"success",this.lS),b="token="+this.XP.parentNode.getAttribute("data-token")+"&action=remove&element="+encodeURIComponent($(b.target).prev("[data-element]").text()),this.Yx.ajax("/topic/"+Gg[0][1]+"/information/manage",b,"POST")))};t.lS=function(){this.tF=n;var b=Ie(this.Yx);b&&(b.r?U(b.msg):b.msg&&(b=b.msg,J("zm-topic-info-content-main",this.e).innerHTML=$(b).html()))};
t.mS=function(b){b.preventDefault();this.uF||(this.uF=j,this.$x=new V(j),this.g().c(this.$x,"success",this.jS),b=qc(this.ss),this.$x.ajax("/topic/"+Gg[0][1]+"/information/manage","title="+b[0].value+"&content="+b[1].value+"&url="+b[2].value+"&action=add","POST"))};t.jS=function(){this.uF=n;var b=Ie(this.$x);b&&(b.r?U(b.msg):b.msg&&(b=b.msg,J("zm-topic-info-content-main",this.e).innerHTML=$(b).html(),b=qc(this.ss),z.forEach(b,function(b,d){3>d&&(b.value="")})))};
t.Vt=function(){if(!Ln())if(S.ye){var b=qr.F();b.show();var c=J("zm-topic-search-input-new");c.value&&tr(b,c.value);b.Qa.data.length||b.Qa.xk(Gg[0])}else zl.F().z(j)};a.vz=function(b){T.call(this,b)};y(vz,T);vz.prototype.o=function(){this.e=this.K().o("FORM",{method:"POST",style:"display:none"})};vz.prototype.post=function(b,c,d){var e=this.h();e||(this.Z(),e=this.h());e.action=c||"";e.target=d||"";var c=e,g,h=new Yr;for(g in b)d=b[g],na(d)?z.forEach(d,v(this.yC,this,h,g)):this.yC(h,g,d);c.innerHTML=h.toString();e.submit()};vz.prototype.yC=function(b,c,d){b.append('<input type="hidden" name="',Ua(c),'" value="',Ua(d),'">')};a.wz=function(){M.call(this)};y(wz,el);wz.prototype.w=function(){var b=fs(new vf(window.location.href),"group_id");b&&(this.ak=new V(n),P(this.g(),this.ak,"success",this.Gz),b&&this.ak.ajax("/noti7/read","group_id="+b,"POST"))};wz.prototype.Gz=function(){var b=Ie(this.ak);if(b&&!b.r&&b.msg){var c=b.msg;if(c===j||"true"===c||"True"===c)return;this.DR=b.msg;this.dispatchEvent("change")}(b=en)&&fn(b)};a.xz=function(){T.call(this);var b=Ig||[0,0];this.Ms=b[0];this.visible=!!b[1];this.oh="collection"};y(xz,T);t=xz.prototype;t.w=function(){yl.J(this);this.n(document.body)};
t.B=function(){xz.m.B.call(this);var b=H("zh-list-side-head");if(b){var c=J("zu-entry-focus-button",b);(this.EN=c)&&this.g().c(c,"click",function(){Kk(c,"favlist","",["zg-btn-green","zg-btn-white"])});(this.vg=H("zh-list-operation-menu"))&&this.g().c(this.vg,"click",this.CA)}(b=H("zh-single-answer-author-info"))&&(new Tn(b)).w();(b=H("zh-list-create-new-list"))&&this.g().c(b,"click",this.TU);(b=H("zh-fav-list-side-bar-creator"))&&(new Tn(b)).w();(b=H("zh-fav-list-side-bar-report"))&&this.g().c(b,
"click",this.sm);(this.Pk=H("zh-favlist-webshare-container"))&&this.g().c(this.Pk,"click",this.FA);if(this.Qb=H("zh-list-meta-wrap"))this.g().c(this.Qb,"click",this.sm),this.tZ=H("zh-list-comment-num"),fs(new vf(location.href),"fc")&&yz(this);(b=H("zh-favlists-wrap"))&&(new Ny(b,k,"favlist",k,j)).w();if(b=H("zh-list-answer-wrap"))$(b).on("click","a[name=unfavo]",$.proxy(this.vP,this)),b=new Bx(b,k,j),this.J(b),this.g().c(b,"click!",function(b){"comment"===b.namespace&&b.Dc.fill("category",this.oh).fill("label",
"collection_answer")}),b.If("zm-item-fav"),b.w();(b=H("zh-favlist-log-list-wrap"))&&(new Ny(b,k,"favlist",k,j)).w();(b=H("zh-favlist-following-wrap"))&&(new Ny(b,k,"favlist",k,j)).w();if(b=H("zh-favlist-followers-wrap"))b=new Ny(b,k,"people",["zg-btn-follow","zg-btn-unfollow"],j),b.If("zm-profile-section-item"),b.yB(j),b.w();this.g().c(window,"hashchange",this.M_);this.$o=new wz;this.$o.w()};
t.vP=function(b){var b=b.target,c=b.id.split("-"),d=c[1],c=c[2];(new V(j)).ajax("/collection/remove","answer_id="+d+"&favlist_id="+c);if(c=Kc(b,"div","zm-item"))b=Xb("zm-item-answer",c),1===b.length?L(c):(b=z.find(b,function(b){return b.getAttribute("data-aid")===d}))&&L(b.parentNode)};t.FA=function(b){var b=Gk(this.Pk,b.target),c=location.pathname.match(/^\/collection\/(\w+)/);if(b&&b.name&&c){var c=c[1],d=Ig[0],e=Cu.F();e.yk("分享收藏夹","collection",c,{fid:d});e.show();Du(e,"tb-webshare-"+b.name)}};
t.TU=function(){av().show()};t.CA=function(b){this.xz?this.jb.S()?this.jb.z(n):(this.jb.z(j),b.stopPropagation(),b.preventDefault(),this.hl()):(b.stopPropagation(),b.preventDefault(),this.Nj(),this.hl());this.xz=j};t.hl=function(){P(this.g(),document,"click",function(){this.jb.z(n)})};t.Nj=function(){var b=H("zh-list-side-head");this.jb=new ou;this.Mx=j;this.visible||this.jb.Fa(this.ZS=new lu("设置为公开"));this.jb.Fa(this.US=new lu("删除此收藏夹"));this.Mx&&(this.jb.Z(b),this.g().c(this.jb,"action",this.Cj))};
t.sm=function(b){b=b.target;switch(b&&b.name){case "report-favlist":bu.Gm("favlist",this.Ms);break;case "edit":gv(av());break;case "addcomment":yz(this);this.na.pe();this.na.ac()&&this.na.Ki("view_comments",parseInt(Hc(b),10)||0);break;case "remove":zz(this)}};
t.Cj=function(b){b.target===this.ZS?Ci("确定设置收藏夹为公开？","收藏夹设置为公开后，将不能再设置为私密。",function(b){b&&(this.B_=!this.visible,this.nJ=new V(j),this.g().c(this.nJ,"complete",function(){window.location.reload()}),this.nJ.ajax("/collection/update","favlist_id="+this.Ms+"&is_public=1"))},this):b.target===this.US&&zz(this)};
a.zz=function(b){Ci("删除收藏夹","你确定要删除这个收藏夹吗？",function(b){b&&(b=new Hk,b.add("favlist_id",this.Ms),b.add("_xsrf",(new Kf(document)).get("_xsrf")),(new vz).post(ds(b),"/collection/delete"))},b)},a.yz=function(b){b.na||(b.na=new Qw(b.Ms,"favlist"),b.J(b.na),b.g().c(b.na,"click!",function(b){"comment"===b.namespace&&(b.Dc.fill("category",this.oh).fill("label","collection"),b.Dc.action=b.Dc.action.replace("favlist","collection"))}),Tw(b.na,b.Qb,$(".toggle-comment",b.Qb)[0]))};a.Az=function(b,c){T.call(this);this.ld=b;this.entryType=c;this.ao="zm-item-expanded"};y(Az,T);t=Az.prototype;t.bl=k;
t.B=function(){Az.m.B.call(this);this.ld=this.e.getAttribute("data-entry-id");this.bE=this.e.getAttribute("data-entry-token");E.forEach({'a[name="expand"]':function(b){this.La(j);this.fm&&(b.currentTarget.name="toggleExpanded")},'a[name="collapse"]':function(){this.La(n)},'a[name="toggleExpanded"]':this.pe,'a[name="toggle-comment"]':function(b){this.Ji();this.na.ac()&&(b=parseInt(Hc(b.currentTarget),10)||0,this.na.Ki("view_comments",b))},'a[name="share"]':this.de,'a[name="ignore"]':this.JO,".js-close":this.UE,
".js-unhide":this.wP,".js-hiderelated":this.eP},function(b,c){$(this.e).on("click",c,$.proxy(b,this))},this);var b=this.Xp=new nx;this.J(b);Tc(this,b);this.g().c(b,"expand",function(){this.La(j)});b.n(this.e);b.Yc()&&P(this.g(),b,"expand",this.Py);Vt(this.e,this.Qy,this);if(b=J("zm-votebar",this.e))this.sc=new kv(this.ld,this.entryType),Tc(this,this.sc),this.sc.n(b),(b=J("votenum-mobile",this.e))&&(new ox(this.sc)).n(b);if(b=J("zm-item-vote-info",this.e)){var c=this.r0=new nv(this.ld,this.entryType);
Tc(this,c);c.n(b);this.sc&&this.g().c(this.sc,"change",function(){c.nk()}).c(c,"change",function(){var b=J("zm-item-vote-count",this.e),e=$(".zm-votebar .count",this.e)[0];b&&uk(b,c.Wa());e&&uk(e,c.Wa())})}this.Mh()};t.Py=function(){Fu(this.entryType,this.bE,"read")};t.Qy=function(){Fu(this.entryType,this.bE,"touch")};t.ac=function(){return D.has(this.e,this.ao)};t.pe=function(){this.La(!this.ac())};
t.La=function(b){if(b===this.ac())return n;b&&At(this.e).height<$b().height&&1<$("a.collapse",this.e).length&&$("a.collapse",this.e).eq(0).remove();b||ft($(".entry-body",this.e)[0]);D.enable(this.e,this.ao,b);this.Xp&&this.Xp.La(b);this.dispatchEvent(b?"expand":"collapse");return j};
t.Mh=function(){var b=this.c0=sk.CB(this.e);rk(qk(b,"v",function(){this.sc&&this.sc.lB()},this),{group:"操作",name:"赞同"});rk(qk(b,"d",function(){this.sc&&this.sc.kB()},this),{group:"操作",name:"反对"});rk(qk(rk(qk(rk(qk(rk(qk(rk(qk(b,"o",this.pe,this),{group:"操作",name:"显示全部/收起"}),"c",this.Ji,this),{group:"操作",name:"打开评论"}),"f x",this.de,this),{group:"操作",name:"分享"}),"shift+c",this.Ax,this),{group:"操作",name:"定位到评论框"}),"shift+o",this.$S,this),{group:"操作",name:"新窗口打开条目"})};
t.UE=function(){$(this.e).fadeOut(150,function(){$(this).remove()})};t.JO=function(){$(".feed-hide-options",this.e).show().siblings().hide();$.post(St("/%s/uninterest",this.entryType),{id:this.ld})};t.wP=function(){$(".feed-hide-options",this.e).hide().siblings().show();$.post(St("/%s/undo_uninterest",this.entryType),{id:this.ld})};
t.eP=function(b){var b=$(b.currentTarget),c=b.data();Ci(b.attr("title"),St("确定%s吗？",b.text()),function(b){b&&(this.UE(),$.post(St("/%s/uninterest",c.type),{id:c.id}))},this)};t.de=function(){var b=Cu.F();b.yk.apply(b,arguments);b.show();Du(b,"tb-webshare-sina")};t.Ji=function(){this.zw();this.na.pe()};t.Ax=function(){this.na?this.na.field.focus():this.Ji()};
t.zw=function(){if(!this.na){var b=$(".toggle-comment",this.e)[0];this.na=new Qw(this.ld,this.entryType);this.J(this.na);Tw(this.na,$(".zm-item-meta",this.e).get(0),b)}};a.Bz=function(){Az.call(this);this.entryType="post"};y(Bz,Az);t=Bz.prototype;t.de=function(){Bz.m.de.call(this,"分享文章","post",this.ld,{post_id:this.ld})};t.$S=function(){window.open($(".post-link",this.e).attr("href"))};t.La=function(b){Bz.m.La.call(this,b)&&this.vA(b)};t.vA=function(b){var c=this.Bo();c&&Uq(c,b)};
t.Bo=function(){if(this.kq)return this.kq;var b=!ub,c=J("zm-editable-content",this.e),d=this.sc&&this.sc.h();b&&(d&&$(d).is(":visible")&&c&&230<$(c).height())&&(b=this.kq=new Xq(k,c),this.J(b),b.Hi="votebar",b.Cz=50,b.n(d))};a.Cz=function(b,c,d){pu.call(this,b,c,d)};y(Cz,pu);Cz.prototype.Af=function(b){b&&!b.r&&(b=b.msg,b.length?(R(this.bc,0<b.length),this.offset+=b.length,this.mv(b),su(this,n),vu(this)):this.Vk.hide())};a.Dz={ROUNDTABLE_ADD_RELATED:"roundtable",ARTICLE_VOTE_UP:"post_vote",ARTICLE_CREATE:"post_create",RECOMMENDED:"feed_recommended",QUESTION_FOLLOW:"feed_question_follow",QUESTION_CREATE:"feed_question",ANSWER_VOTE_UP:"feed_answer_vote",ANSWER_CREATE:"feed_answer_answer"};
Cz.prototype.DP=function(b){var c=b.currentTarget.e.getAttribute("data-feedtype"),c=Dz[c];"comment"===b.namespace&&c&&b.Dc.fill("category","feed").fill("label",c)};Cz.prototype.ck=function(b){var c;c="p"===b.getAttribute("data-type")?new Bz:new Cx;this.J(c);this.g().c(c,"click!",this.DP);c.n(b);N(c,"ignore",v(function(b){this.dispatchEvent({type:"ignore",Y:b.Y})},this));return c};Cz.prototype.DH=function(b){return{params:b,method:"next"}};Cz.prototype.p=function(){Cz.m.p.call(this)};a.Ez=function(){this.interval=3E4};ia(Ez);a.Gz=function(b,c){if(!b.Bc||c)c&&clearInterval(b.Bc),b.Bc=setInterval(v(function(){Fz(this)},b),b.interval)},a.Fz=function(b,c){$(".feed-item-hook .time").each(function(){$(this).text(gt($(this).data("timestamp")))});c&&Gz(b,c)};a.Hz=function(){T.call(this);this.sy={};this.at=[];this.zQ="old"===$("#feed-ver").val()?j:n;this.QF=0<$("#is-topstory").length?j:n;this.gE=this.zQ?"zm-item":"feed-item-hook";window._gaq=window._gaq||[];this.QF?window._gaq.push(["_setCustomVar",5,"is_topstory",j,3]):window._gaq.push(["_setCustomVar",5,"is_topstory",n,3])};y(Hz,T);t=Hz.prototype;
t.B=function(){Hz.m.B.call(this);this.L=$(this.e);if(this.rf=H("zh-main-feed-fresh-button"))this.HB=$(this.rf),this.QF?(this.g().c(this.rf,"click",this.QT),this.g().c(Y,"topstory",this.uP)):(this.g().c(this.rf,"click",this.YU),this.g().c(Y,"homefeed",this.XO));this.bb=new Cz(this.e,k,j);this.getParent()&&this.getParent().J(this.bb);var b="/node/"+$(this.e).data("init").nodename;this.bb.url=b;this.bb.If("feed-item-hook");this.g().c(this.bb,"itemcreated",function(b){Iz(this,b.data.OQ)}).c(this.bb,"afterload",
function(b){Y.V({type:"ga_click_feed_more",data:b.data})}).c(this.bb,"ignore",function(b){var c=b.Y;E.forEach(this.sy,function(b){b.Y===c&&$(b.e).fadeOut(150)})});this.bb.w();this.L.on("click",".js-more-similar",function(){$(this).parent().slideUp("fast").nextUntil(":not(.hidden)").slideDown("fast")});var c=this;this.L.on("click",".js-change-some",function(){Nk("feed","intrests-change");var b=$(this),e=$(this).parent().parent();$.post("/node/HomeExtraFeedList",{method:"next",params:{}}).done(function(g){!g.r&&
g.msg&&(0<g.msg.length?(e.find(".feed-item-hook").remove(),e.append(g.msg).find(".feed-item-hook").each(function(){c.bb.ck(this)})):b.replaceWith('<span class="zg-right zg-gray">没有更多内容了</span>'))})})};t.QT=function(){this.HB.text("加载中…");this.Ym=0;var b=this;this.bb.offset=0;this.bb.Gi=0;uu(this.bb,j,function(){oh(b.bb,function(b){$(b.h()).remove()})}).done(function(){b.HB.hide();ru(b.bb)})};
t.YU=function(){var b=J("zm-home-question-list-devider",this.e);b&&D.remove(b,"zm-home-question-list-devider");var b=this.at.length,c=$("."+this.gE,this.e)[0];c&&5<=b&&($(".feed-separator-hook",this.e).next(".feed-item-hook").css("border-top","1px solid #eee").end().remove(),$(c).css("border-top","none").before('<div class="feed-item-hook feed-separator-hook feed-separator"><span>上次你看到这里</span></div>'));z.forEach(this.at,function(b){var c=$("."+this.gE,this.e)[0];c?lc(b,c):this.e.appendChild(b)},
this);this.at=[];R(this.rf,n);c=Ez.F();Fz(c,j);Y.V({type:"ga_click_feed_fresh",data:{count:b}})};
t.XO=function(b){var c=La(b.nb),b=this.at,d=b.length;if(c&&!(500<d)){var e=hc(c),c=this.sy;if(!E.Nr(c,function(b){return b.h().id===e.id})){var g=this.bb.ck(e);if(g.qa){if(E.Nr(c,function(b){return b.qa===g.qa}))return}else if(g.Y){if(E.Nr(c,function(b){return b.Y===g.Y}))return}else if(g.ld&&E.Nr(c,function(b){return b.ld===g.ld}))return;Iz(this,g);b.push(e);d+=1;this.rf&&(this.rf.innerHTML=(99<d?"99+":d)+" 条新动态",R(this.rf,j))}}};
t.uP=function(b){this.Ym=this.Ym||0;this.Ym+=+b.nb;this.rf&&(this.rf.innerHTML=(99<this.Ym?"99+":this.Ym)+" 条新动态",R(this.rf,j))};a.Iz=function(b,c){var d=ih(hh.F());b.sy[d]=c;$(c.e).attr("data-fid",d)};a.Jz=function(){};y(Jz,T);t=Jz.prototype;t.B=function(){Jz.m.B.call(this);var b=H("zh-invite-select");b&&this.g().c(b,"change",this.qz);(b=J("zm-invite-list"))&&this.g().c(b,"click",this.ha);(this.Sx=H("zh-invite-ignore-all-btn"))&&this.g().c(this.Sx,"click",this.TP)};
t.ha=function(b){if((b=b.target)&&b.name){if("ignore"===b.name){this.d_=b;this.e_=j;D.add(b,"zg-btn-disabled");this.UP=new V(n);var c="qid="+b.getAttribute("data-qid")+"&uid="+S[3]+"&op=pass";this.UP.ajax("/question/askpeople",c,"POST");(c=b.parentNode)&&vk(c,j)}"recover"===b.name&&!this.RH&&(this.PH=b,this.RH=j,D.add(b,"zg-btn-disabled"),b.innerHTML="...",this.QH=new V(n),this.g().c(this.QH,"success",this.fL),b="qid="+b.getAttribute("data-qid")+"&uid="+S[3]+"&op=recover",this.QH.ajax("/question/askpeople",
b,"POST"))}};t.qz=function(b){var c=fs(new vf(location.href),"filter_by");if((b=b.target)&&b.value)b=b.value,b!==c&&(window.location.href="/question/invited?filter_by="+b)};t.fL=function(){this.RH=n;this.cc(this.PH,"ignore");this.PH.name="ignore"};
t.cc=function(b,c){var d=b.parentNode,e=J("zm-invite-item-info-label",d);"ignore"===c?(D.remove(b,"zg-btn-disabled"),D.remove(b,"recover"),D.add(b,"ignore"),D.add(d,"invite"),D.remove(d,"ignore"),e.innerHTML="新邀请",b.name="ignore",b.innerHTML="忽略"):(D.remove(b,"zg-btn-disabled"),D.remove(b,"ignore"),D.add(b,"recover"),D.remove(d,"invite"),D.remove(d,"draft"),D.add(d,"ignore"),e.innerHTML="已忽略",b.name="recover",b.innerHTML="恢复")};
t.TP=function(){this.Tx||(this.Tx=j,this.mF=new V(n),this.g().c(this.mF,"success",this.$K),this.mF.ajax("/question/askpeople","uid="+S[3]+"&op=ignore_all","POST"))};t.$K=function(){this.Tx=n;R(this.Sx);this.Tx=n;z.forEach(Xb("zm-invite-item-control"),v(function(b){this.cc(b,"recover")},this))};a.Kz=function(){T.call(this)};y(Kz,T);Kz.prototype.B=function(){Kz.m.B.call(this);this.Ql();this.g().c(this.e,"click",this.ha)};Kz.prototype.ha=function(b){b=b.target;if(b.name)switch(b.name){case "fold":$(b).parent().hide().prev().animate({height:"show"},200);break;case "fold-follow":$(b).parent().hide().prev().show();break;case "unfold-item":$(b).parent(".author-list").hide().siblings(".hidden").show()}};
Kz.prototype.Ql=function(){this.So||(this.So=j,this.Xj=new V(n),this.g().c(this.Xj,"success",this.mz),this.Xj.ajax("/noti7/calendar","","GET"))};Kz.prototype.mz=function(){this.So=n;var b=He(this.Xj);if(b){var c=H("zh-noti7-list-inner");/category/.test(b)?(c.innerHTML=b,c&&(b=new pu(c,"/noti7/calendar",j),b.mv=function(b){var c=K("div","zm-item-more-wrap");c.innerHTML=b;lc(c,this.bc)},b.ds=function(b){this.Gi=this.bc.getAttribute("data-next");return!b||b.msg[0]&&b.msg[1]},b.w())):c.innerHTML='<div class="empty"><span class="zg-gray-normal">您收到的消息会显示在这里</span></div>'}};a.Lz=function(){M.call(this);this.Qx=[];this.DD=[]};y(Lz,el);Lz.prototype.w=function(){var b=H("home-suggest-block");b&&(this.e=b,b=H("home-suggest-close-button"),P(this.g(),b,"click",function(){(new V(j)).ajax("/option","key=no_show_lookup&value=1");R(this.e,n)}),b=H("home-suggest-refresh-button"),this.g().c(b,"click",this.AS),this.Qs=H("home-suggest-list"),Mz(this))};Lz.prototype.AS=function(){Nz(this);return j};
a.Nz=function(b){for(var c=[],d=0;3>d;d++){var e=b.DD.shift();e&&c.push(e)}3===c.length?(b.Qs.innerHTML=c.join(""),c=Xb("suggest-item",b.Qs),z.forEach(c,function(b){this.Qx.push(b.id.split("-")[1])},b)):Mz(b)},a.Mz=function(b){b.Qs.innerHTML='<img class="bubble-loading" src="/static/img/noti-loading.gif">';$.post("/lookup/suggest_member",{ids:b.Qx.join(",")}).done(v(b.XR,b))};Lz.prototype.XR=function(b){b.r||((b=b.msg)&&ma(b)&&b.length?(this.Qx=[],this.DD=b,Nz(this)):this.Qs.innerHTML="下面没有了")};a.Oz=function(){T.call(this)};y(Oz,T);Oz.prototype.w=function(){yl.J(this);this.n(document.body)};
Oz.prototype.B=function(){Oz.m.B.call(this);var b=H("js-home-feed-list");if(b){var c=new Hz;this.J(c);c.n(b)}(b=J("zm-invite-container"))&&(new Jz).n(b);H("home-settings-page-wrap")&&(b=H("zh-topic-block-editor"))&&(new Qs(Jg)).n(b);(b=H("zh-noti7"))&&(new Kz).n(b);if(b=H("zh-plazza-topic-search-wrap"))c=H("zh-plazza-topic-search-input"),(new gp("搜索话题")).n(c),this.M=new go("/topic-reg/autocomplete",c,k,k,b,n),this.M.Kf(j),this.g().c(this.M,"select",function(){var b=z.slice(this.M.lg(),1);window.location.href=
"/topic/"+b[1]});if(c=H("zm-home-sidebar-domain-entry-link"))b=!!c.getAttribute("data-expanded"),c=new Ko(c,H("zm-home-sidebar-domain-entry-nav"),b),b&&xd(c,"toggle",function(){Ei("/notifeature?feature=4",k,"GET");return j});$(".zm-side-pinned-topics").on("click",".unpin",function(){var b=$(this).parent();$.post("/pin-topic/remove",{tid:$(this).attr("data-tid")}).done(function(c){c.r||b.fadeOut()})});if(b=$("#zh-virgin-answer-list > .zh-general-list").get(0))c=new Wt,this.J(c),c.Pa("nodeSource").Pa("childConstructor",
{Tg:Cx}),c.n(b),this.g().c(c,"click!",function(b){"comment"===b.namespace&&b.Dc.fill("category","debuts").fill("label","debuts")});(new Lz).w();var b=S[1],d=H("zu-welcome-once");d&&("welcome"===location.hash.slice(1)?(R(d,j),Nf.set("reg_noti_",b,86400)):b===Nf.get("reg_noti_")&&R(d,j),N(J("x-m",d),"click",function(){location.hash="";L(d);Nf.remove("reg_noti_")}));var e=$("#js-global-notify");if(e.length){var g=new Pq;g.n(e[0]);$r(g);$(".zu-global-notify-close",e).click(function(){var b=$(this).data("id");
$.post("/notice/read",{nid:b});g.G();e.remove()})}b=Ez.F();Gz(b);var h=$("#js-debuts-entry .tour");h.length&&$(".close-button",h).click(function(){var b=$(this).data("feature");$.get("/notifeature",{feature:b});h.fadeOut(100,function(){h.remove()})})};a.Pz=function(){wh.call(this,k,n);this.OC="zh-lightbox-showing";this.EV="zh-lightbox-thumb";this.wf()};y(Pz,wh);ia(Pz);t=Pz.prototype;t.wf=function(){this.g().c(document,"click",this.Wr)};
t.Wr=function(b){b=b.target;if("IMG"===b.tagName&&D.has(b,this.EV)){var c=b.getAttribute("data-original");if(c)if(ub)window.open(c);else if(!Kc(b,k,"editable")){this.Oa('<div class="zm-light-box-x1" id="zm-light-box-x1"><div class="zm-light-box-x2" id="zm-light-box-x2"><img src="'+c+'" class="zm-light-box-img-el" /><div class="zm-light-box-footer"><a class="zm-light-box-show-origin" href="'+c+'" target="_blank">查看原图</a></div></div></div>');this.z(j);D.add(this.h(),"zm-light-box-fullscreen-image");
var c=$b(),d=H("zm-light-box-x1"),e=H("zm-light-box-x2"),g=b.getAttribute("data-rawheight"),h=b.getAttribute("data-rawwidth"),h=h?+h:0;(g?+g:0)>c.height-80?e.style.marginTop="40px":d.style.lineHeight=c.height+"px";e.style.width=h>c.width-80?c.width-80+"px":h+"px";Y.V({type:"ga_click_enlarge_image",target:b})}}};t.oa=ha;t.focus=ha;t.Bx=function(){this.z(n);D.remove(document.body,this.OC)};t.vi=function(){Pz.m.vi.call(this);D.add(document.body,this.OC);P(this.g(),document,"click",this.Bx)};
t.o=function(){Pz.m.o.call(this);D.add(this.h(),"zm-light-box")};t.Ny=function(){this.Vc=this.K().o("div",this.Hc+"-bg zm-light-box-background");R(this.Vc,n)};Pz.F();a.Qz=function(b,c,d){lu.call(this,b,c,d);this.Ei(j)};y(Qz,lu);Qz.prototype.le=function(){return this.dispatchEvent("action")};po("goog-option",function(){return new Qz(k)});a.Rz=function(){};y(Rz,Qo);ia(Rz);Rz.prototype.o=function(b){return b.K().o("div",this.O()+" goog-inline-block"," ")};Rz.prototype.n=function(b,c){c=Rz.m.n.call(this,b,c);D.add(c,"goog-inline-block");return c};Rz.prototype.O=s("goog-toolbar-separator");a.Sz=function(){};y(Sz,So);ia(Sz);Sz.prototype.wc=function(){return Xc.CK};Sz.prototype.jo=function(b){return"HR"==b.tagName?new Ro(Rz.F()):Sz.m.jo.call(this,b)};Sz.prototype.O=s("goog-toolbar");Sz.prototype.Yw=function(){return Uo};a.Tz=function(){};y(Tz,Ku);ia(Tz);Tz.prototype.O=s("goog-toolbar-button");a.Uz=function(b,c,d){yo.call(this,b,c||Tz.F(),d)};y(Uz,yo);po("goog-toolbar-button",function(){return new Uz(k)});a.Vz=function(){};y(Vz,Mu);ia(Vz);Vz.prototype.createCaption=function(b,c){return Vz.m.createCaption.call(this,Wz(b,c),c)};a.Wz=function(b,c){return c.o("div","goog-color-menu-button-indicator",b)};Vz.prototype.ua=function(b,c){b&&Xz(this.ba(b),c)};a.Xz=function(b,c){if(b&&b.firstChild){var d;d=c&&(qs.test("#"==c.charAt(0)?c:"#"+c)||Ds(c).length||Fs&&Fs[c.toLowerCase()])?vt(c).es:k;b.firstChild.style.borderBottomColor=d||(A?"":"transparent")}};
Vz.prototype.Qe=function(b){this.ua(b.h(),b.X());D.add(b.h(),"goog-color-menu-button");Vz.m.Qe.call(this,b)};a.Yz=function(){};y(Yz,ho);ia(Yz);a.Zz=0;t=Yz.prototype;t.o=function(b){var c=this.sf(b);return b.K().o("div",c?c.join(" "):k,$z(this,b.ib(),b.Tl(),b.K()))};a.$z=function(b,c,d,e){for(var g=[],h=0,l=0;h<d.height;h++){for(var m=[],p=0;p<d.width;p++){var r=c&&c[l++];m.push(aA(b,r,e))}g.push(e.o("tr",b.O()+"-row",m))}return b.Rv(g,e)};t.Rv=function(b,c){var d=c.o("table",this.O()+"-table",c.o("tbody",this.O()+"-body",b));d.cellSpacing=0;d.cellPadding=0;Oc(d,"grid");return d};
a.aA=function(b,c,d){b=d.o("td",{"class":b.O()+"-cell",id:b.O()+"-cell-"+Zz++},c);Oc(b,"gridcell");return b};t.Wc=s(n);t.n=s(k);
t.Oa=function(b,c){if(b){var d=Wb("tbody",this.O()+"-body",b)[0];if(d){var e=0;z.forEach(d.rows,function(b){z.forEach(b.cells,function(b){kc(b);if(c){var d=c[e++];d&&b.appendChild(d)}})});if(e<c.length){for(var g=[],h=Ub(b),l=d.rows[0].cells.length;e<c.length;){var m=c[e++];g.push(aA(this,m,h));g.length==l&&(m=h.o("tr",this.O()+"-row",g),d.appendChild(m),g.length=0)}if(0<g.length){for(;g.length<l;)g.push(aA(this,"",h));m=h.o("tr",this.O()+"-row",g);d.appendChild(m)}}}tg(b,j,B)}};
a.bA=function(b,c,d){for(c=c.h();d&&1==d.nodeType&&d!=c;){if("TD"==d.tagName&&D.has(d,b.O()+"-cell"))return d.firstChild;d=d.parentNode}return k},a.cA=function(b,c,d,e){d&&(d=d.parentNode,D.enable(d,b.O()+"-cell-hover",e),Pc(c.h().firstChild,"activedescendent",d.id))};t.O=s("goog-palette");a.eA=function(b){M.call(this);this.Jd=[];dA(this,b)};y(eA,Hd);t=eA.prototype;t.Cg=k;t.Gf=k;t.Pl=function(){return this.Jd.length};t.gi=function(b){return this.Jd[b]||k};a.dA=function(b,c){c&&(z.forEach(c,function(b){this.Mm(b,n)},b),z.extend(b.Jd,c))};t.Fa=function(b){this.Ti(b,this.Pl())};t.Ti=function(b,c){b&&(this.Mm(b,n),z.Co(this.Jd,b,c))};t.removeItem=function(b){b&&z.remove(this.Jd,b)&&b==this.Cg&&(this.Cg=k,this.dispatchEvent("select"))};t.$g=q("Cg");t.Fb=function(){return z.clone(this.Jd)};
t.Jf=function(b){b!=this.Cg&&(this.Mm(this.Cg,n),this.Cg=b,this.Mm(b,j));this.dispatchEvent("select")};t.Sl=function(){return this.Cg?z.indexOf(this.Jd,this.Cg):-1};t.Lp=function(b){this.Jf(this.gi(b))};t.clear=function(){z.clear(this.Jd);this.Cg=k};t.p=function(){eA.m.p.call(this);delete this.Jd;this.Cg=k};t.Mm=function(b,c){b&&("function"==typeof this.Gf?this.Gf(b,c):"function"==typeof b.Rm&&b.Rm(c))};a.fA=function(b,c,d){ro.call(this,b,c||Yz.F(),d);this.Xi&=-89};y(fA,ro);t=fA.prototype;t.oc=k;t.tb=-1;t.pa=k;t.p=function(){fA.m.p.call(this);this.pa&&(this.pa.G(),this.pa=k);this.oc=k};t.Pm=function(b){fA.m.Pm.call(this,b);gA(this);this.pa?(this.pa.clear(),dA(this.pa,b)):(this.pa=new eA(b),b=v(this.Mm,this),this.pa.Gf=b,this.g().c(this.pa,"select",this.Dj));this.tb=-1};t.Yg=s("");t.Nm=ba();
t.od=function(b){fA.m.od.call(this,b);var c=bA(this.N,this,b.target);(!c||!b.relatedTarget||!uc(c,b.relatedTarget))&&c!=hA(this)&&iA(this,c)};t.ii=function(b){fA.m.ii.call(this,b);var c=bA(this.N,this,b.target);(!c||!b.relatedTarget||!uc(c,b.relatedTarget))&&c==hA(this)&&cA(this.N,this,c,n)};t.Ne=function(b){fA.m.Ne.call(this,b);this.Hb()&&(b=bA(this.N,this,b.target),b!=hA(this)&&iA(this,b))};t.le=function(b){var c=hA(this);return c?(this.Jf(c),fA.m.le.call(this,b)):n};
t.$b=function(b){var c=this.ib(),c=c?c.length:0,d=this.oc.width;if(0==c||!this.isEnabled())return n;if(13==b.keyCode||32==b.keyCode)return this.le(b);if(36==b.keyCode)return this.Tb(0),j;if(35==b.keyCode)return this.Tb(c-1),j;var e=0>this.tb?this.Sl():this.tb;switch(b.keyCode){case 37:-1==e&&(e=c);if(0<e)return this.Tb(e-1),b.preventDefault(),j;break;case 39:if(e<c-1)return this.Tb(e+1),b.preventDefault(),j;break;case 38:-1==e&&(e=c+d-1);if(e>=d)return this.Tb(e-d),b.preventDefault(),j;break;case 40:if(-1==
e&&(e=-d),e<c-d)return this.Tb(e+d),b.preventDefault(),j}return n};t.Dj=ba();t.Tl=q("oc");a.jA=function(b,c){b.h()&&f(Error("Component already rendered"));b.oc=pa(c)?new Qb(c,i):c;gA(b)},a.hA=function(b){var c=b.ib();return c&&c[b.tb]};t.Tb=function(b){b!=this.tb&&(kA(this,this.tb,n),this.tb=b,kA(this,b,j))};a.iA=function(b,c){var d=b.ib();b.Tb(d?z.indexOf(d,c):-1)};t.Sl=function(){return this.pa?this.pa.Sl():-1};t.$g=function(){return this.pa?this.pa.$g():k};t.Lp=function(b){this.pa&&this.pa.Lp(b)};
t.Jf=function(b){this.pa&&this.pa.Jf(b)};a.kA=function(b,c,d){if(b.h()){var e=b.ib();e&&(0<=c&&c<e.length)&&cA(b.N,b,e[c],d)}};t.Mm=function(b,c){this.h()&&b&&D.enable(b.parentNode,this.N.O()+"-cell-selected",c)};a.gA=function(b){var c=b.ib();if(c)if(b.oc&&b.oc.width){if(c=Math.ceil(c.length/b.oc.width),!pa(b.oc.height)||b.oc.height<c)b.oc.height=c}else c=Math.ceil(Math.sqrt(c.length)),b.oc=new Qb(c,c);else b.oc=new Qb(0,0)};a.lA=function(b,c,d){this.er=b||[];fA.call(this,k,c||Yz.F(),d);this.er=this.er;this.ct=k;this.Oa(z.map(this.er,function(b){var c=this.K().o("div",{"class":this.N.O()+"-colorswatch",style:"background-color:"+b});"#"==b.charAt(0)&&(b=Es(b),b="RGB ("+[parseInt(b.substr(1,2),16),parseInt(b.substr(3,2),16),parseInt(b.substr(5,2),16)].join(", ")+")");c.title=b;return c},this))};y(lA,fA);lA.prototype.ct=k;lA.prototype.ix=function(){var b=this.$g();return b?(b=Ct(b,"background-color"),mA(b)):k};
lA.prototype.Kp=function(b){b=mA(b);this.ct||(this.ct=z.map(this.er,function(b){return mA(b)}));this.Lp(b?z.indexOf(this.ct,b):-1)};a.mA=function(b){if(b)try{return vt(b).es}catch(c){}return k};a.nA=function(b,c,d,e){Ou.call(this,b,c,d||Vz.F(),e)};y(nA,Ou);
a.oA={sX:"#000 #444 #666 #999 #ccc #eee #f3f3f3 #fff".split(" "),CY:"#f00 #f90 #ff0 #0f0 #0ff #00f #90f #f0f".split(" "),fY:"#f4cccc #fce5cd #fff2cc #d9ead3 #d0e0e3 #cfe2f3 #d9d2e9 #ead1dc #ea9999 #f9cb9c #ffe599 #b6d7a8 #a2c4c9 #9fc5e8 #b4a7d6 #d5a6bd #e06666 #f6b26b #ffd966 #93c47d #76a5af #6fa8dc #8e7cc3 #c27ba0 #cc0000 #e69138 #f1c232 #6aa84f #45818e #3d85c6 #674ea7 #a64d79 #990000 #b45f06 #bf9000 #38761d #134f5c #0b5394 #351c75 #741b47 #660000 #783f04 #7f6000 #274e13 #0c343d #073763 #20124d #4c1130".split(" ")},a.pA=
function(b){var c=new ou(b);E.forEach(oA,function(d){d=new lA(d,k,b);jA(d,8);c.J(d,j)});return c};t=nA.prototype;t.ix=function(){return this.X()};t.Kp=function(b){this.ua(b)};t.ua=function(b){for(var c=0,d;d=this.gi(c);c++)"function"==typeof d.Kp&&d.Kp(b);nA.m.ua.call(this,b)};t.so=function(b){"function"==typeof b.target.ix?this.ua(b.target.ix()):"none"==b.target.X()&&this.ua(k);nA.m.so.call(this,b);b.stopPropagation();this.dispatchEvent("action")};
t.wb=function(b,c){b&&0==this.Pl()&&(this.th(pA(this.K())),this.ua(this.X()));nA.m.wb.call(this,b,c)};po("goog-color-menu-button",function(){return new nA(k)});a.qA=function(){};y(qA,Mu);ia(qA);qA.prototype.O=s("goog-toolbar-menu-button");a.rA=function(){};y(rA,qA);ia(rA);rA.prototype.createCaption=function(b,c){return Nu(Wz(b,c),this.O(),c)};rA.prototype.ua=function(b,c){b&&Xz(this.ba(b),c)};rA.prototype.Qe=function(b){this.ua(b.h(),b.X());D.add(b.h(),"goog-toolbar-color-menu-button");rA.m.Qe.call(this,b)};a.sA=function(b,c,d,e){nA.call(this,b,c,d||rA.F(),e)};y(sA,nA);po("goog-toolbar-color-menu-button",function(){return new sA(k)});a.tA=function(b,c,d,e){Ou.call(this,b,c,d||qA.F(),e)};y(tA,Ou);po("goog-toolbar-menu-button",function(){return new tA(k)});a.vA=function(b,c,d,e){Ou.call(this,b,c,d,e);uA(this,b);this.Ip(Xc.SB)};y(vA,Ou);t=vA.prototype;t.pa=k;t.$v=k;t.B=function(){vA.m.B.call(this);wA(this);xA(this);Pc(this.h(),Wc.Xk,"false")};t.$=function(b){vA.m.$.call(this,b);(b=this.Yg())?uA(this,b):this.Lp(0)};t.p=function(){vA.m.p.call(this);this.pa&&(this.pa.G(),this.pa=k);this.$v=k};t.so=function(b){this.Jf(b.target);vA.m.so.call(this,b);b.stopPropagation();this.dispatchEvent("action")};
t.Dj=function(){var b=this.$g();vA.m.ua.call(this,b&&b.X());wA(this)};t.th=function(b){var c=vA.m.th.call(this,b);b!=c&&(this.pa&&this.pa.clear(),b&&(this.pa?oh(b,function(b){yA(b);this.pa.Fa(b)},this):zA(this,b)));return c};a.uA=function(b,c){b.$v=c;wA(b)};t.Fa=function(b){yA(b);vA.m.Fa.call(this,b);this.pa?this.pa.Fa(b):zA(this,this.ab())};t.Ti=function(b,c){yA(b);vA.m.Ti.call(this,b,c);this.pa?this.pa.Ti(b,c):zA(this,this.ab())};t.removeItem=function(b){vA.m.removeItem.call(this,b);this.pa&&this.pa.removeItem(b)};
t.Jf=function(b){if(this.pa){var c=this.$g();this.pa.Jf(b);b!=c&&this.dispatchEvent("change")}};t.Lp=function(b){this.pa&&this.Jf(this.pa.gi(b))};t.ua=function(b){if(b!=k&&this.pa)for(var c=0,d;d=this.pa.gi(c);c++)if(d&&"function"==typeof d.X&&d.X()==b){this.Jf(d);return}this.Jf(k)};t.$g=function(){return this.pa?this.pa.$g():k};t.Sl=function(){return this.pa?this.pa.Sl():-1};
a.zA=function(b,c){b.pa=new eA;c&&oh(c,function(b){yA(b);this.pa.Fa(b)},b);xA(b)},a.xA=function(b){b.pa&&b.g().c(b.pa,"select",b.Dj)},a.wA=function(b){var c=b.$g();b.Oa(c?c.Yg():b.$v)},a.yA=function(b){b.Ip(b instanceof lu?Xc.WB:Xc.oK)};t.wb=function(b,c){vA.m.wb.call(this,b,c);this.ub()&&this.ab().Tb(this.Sl())};po("goog-select",function(){return new vA(k)});a.AA=function(b,c,d,e){vA.call(this,b,c,d||qA.F(),e)};y(AA,vA);po("goog-toolbar-select",function(){return new AA(k)});a.BA=function(b){var c=b.indexOf(",");a:{b=(-1!=c?b.substring(0,c):b).toLowerCase();for(c=0;2>c;c++){var d="\"'".charAt(c);if(b.charAt(0)==d&&b.charAt(b.length-1)==d){b=b.substring(1,b.length-1);break a}}}return b},a.CA=function(b,c){z.forEach(c,function(c){var e=c.caption,c=c.value,g=BA(c),e=new Qz(e,c,b.K());lh(e,g);b.Fa(e);e.ba().style.fontFamily=c})},a.DA=[10,10,13,16,18,24,32,48],a.FA=function(b,c,d,e,g,h){d=new Uz(EA(d,e,h),g,h);lh(d,b);d.Uc(c);return d},a.GA=function(b,c,d,e,g,h){b=FA(b,c,
d,e,g,h);uo(b,16,j);return b},a.HA=function(b,c,d,e,g,h){g=new AA(k,k,g,h);e&&z.forEach(e.split(/\s+/),g.Lh,g);g.Lh("goog-toolbar-select");uA(g,d);lh(g,b);g.Uc(c);return g},a.IA=function(b,c,d,e,g,h){d=new sA(EA(d,e,h),k,g,h);lh(d,b);d.Uc(c);return d},a.EA=function(b,c,d){if((!b||""==b)&&B&&!Gb("1.9a"))b=" ";return(d||Ub()).o("DIV",c?{"class":c}:k,b)};a.JA=w("Link");w("Edit Link");w("Text to display:");a.KA=w("Link to:");w("Web address");w("Link to a page or file somewhere else on the web");w("Test this link");
w("{$startBold}Not sure what to put in the box?{$endBold} First, find the page on the web that you want to link to. (A {$searchEngineLink}search engine{$endLink} might be useful.) Then, copy the web address from the box in your browser's address bar, and paste it into the box above.",{startBold:"<b>",endBold:"</b>",searchEngineLink:"<a href='http://www.google.com/' target='_new'>",endLink:"</a>"});w("To what URL should this link go?");w("Email address");w("Link to an email address");w("Invalid email address");
w("To what email address should this link?");w("{$preb}Be careful.{$postb} Remember that any time you include an email address on a web page, nasty spammers can find it too.",{preb:"<b>",postb:"</b>"});w("Open this link in a new window");w("Image");a.LA={},a.MA=w("Normal"),a.NA=w("Normal / serif"),a.OA=[{caption:MA,value:"arial,sans-serif"},{caption:NA,value:"times new roman,serif"},{caption:"Courier New",value:"courier new,monospace"},{caption:"Georgia",value:"georgia,serif"},{caption:"Trebuchet",value:"trebuchet ms,sans-serif"},{caption:"Verdana",value:"verdana,sans-serif"}],a.PA={ja:[{caption:"ＭＳ Ｐゴシック",value:"ms pgothic,sans-serif"},{caption:"ＭＳ Ｐ明朝",value:"ms pmincho,serif"},{caption:"ＭＳ ゴシック",value:"ms gothic,monospace"}],ko:[{caption:"굴림",
value:"gulim,sans-serif"},{caption:"바탕",value:"batang,serif"},{caption:"굴림체",value:"gulimche,monospace"}],"zh-tw":[{caption:"新細明體",value:"pmingliu,serif"},{caption:"細明體",value:"mingliu,serif"}],"zh-cn":[{caption:"宋体",value:"simsun,serif"},{caption:"黑体",value:"simhei,sans-serif"},{caption:"MS Song",value:"ms song,monospace"}]},a.QA=w("Small"),a.RA=w("Normal"),a.SA=w("Large"),a.TA=w("Huge"),a.UA=[{caption:QA,value:1},{caption:RA,value:2},{caption:SA,value:4},{caption:TA,value:6}],a.VA=w("Heading"),
a.WA=w("Subheading"),a.XA=w("Minor heading"),a.YA=w("Normal"),a.ZA=[{caption:VA,ya:"H2"},{caption:WA,ya:"H3"},{caption:XA,ya:"H4"},{caption:YA,ya:"P"}],a.$A=function(b,c,d,e,g,h){var l=FA(b,c,d,e,g,h);l.Ni=function(b){l.eb(b)};return l},a.aB=function(b,c){var d=c;try{if(A)var e="000000"+d.toString(16),g=e.substr(e.length-6,6),d="#"+g.substring(4,6)+g.substring(2,4)+g.substring(0,2);d!=b.X()&&b.ua(d)}catch(h){}},a.bB=w("Format"),a.cB=w("Format"),a.dB=w("Undo"),a.eB=w("Redo"),a.fB=w("Font"),a.gB=w("Font size"),
a.hB=w("Text color"),a.iB=w("Bold"),a.jB=w("Italic"),a.kB=w("Underline"),a.lB=w("Text background color"),a.mB=w("Add or remove link"),a.nB=w("Numbered list"),a.oB=w("Bullet list"),a.pB=w("Decrease indent"),a.qB=w("Increase indent"),a.rB=w("Align left"),a.sB=w("Align center"),a.tB=w("Align right"),a.uB=w("Justify"),a.vB=w("Remove formatting"),a.wB=w("Insert image"),a.xB=w("Strikethrough"),a.yB=w("Left-to-right"),a.zB=w("Right-to-left"),a.AB=w("Quote"),a.BB=w("Edit HTML source"),a.CB=w("Subscript"),
a.DB=w("Superscript"),a.EB=w("Edit HTML"),a.FB={};
LA.PB=[{ya:"+undo",T:dB,Ma:"tr-icon tr-undo",factory:$A,kb:j},{ya:"+redo",T:eB,Ma:"tr-icon tr-redo",factory:$A,kb:j},{ya:"+fontName",T:fB,Ma:"tr-fontName",factory:function(b,c,d,e,g,h){var l=HA(b,c,d,e,g,h),b="en-us".replace(/_/,"-").toLowerCase(),c=[];b in PA&&(c=PA[b]);c.length&&CA(l,c);CA(l,OA);uA(l,MA);D.add(l.ab().ba(),"goog-menu-noaccel");l.Ni=function(b){var c=k;b&&0<b.length&&(c=mh(l.ab(),BA(b)));c!=l.$g()&&l.Jf(c)};return l},kb:j},{ya:"+fontSize",T:gB,Ma:"tr-fontSize",factory:function(b,
c,d,e,g,h){var l=HA(b,c,d,e,g,h);z.forEach(UA,function(b){var c=b.value,b=new Qz(b.caption,c,l.K());l.Fa(b);b=b.ba();b.style.fontSize=(DA[c]||10)+"px";b.firstChild.style.height="1.1em"});uA(l,RA);D.add(l.ab().ba(),"goog-menu-noaccel");l.Ni=function(b){var c;if(c=oa(b))c=b.match(Is),c="px"==(c&&c[0]||k);c&&(b=z.lastIndexOf(DA,parseInt(b,10)));b=0<b?b:k;b!=l.X()&&l.ua(b)};return l},kb:j},{ya:"+bold",T:iB,Ma:"tr-icon tr-bold",kb:j},{ya:"+italic",T:jB,Ma:"tr-icon tr-italic",kb:j},{ya:"+underline",T:kB,
Ma:"tr-icon tr-underline",kb:j},{ya:"+foreColor",T:hB,Ma:"tr-icon tr-foreColor",factory:function(b,c,d,e,g,h){b=IA(b,c,d,e,g,h);b.Kp("#000");b.Ni=xa(aB,b);return b},kb:j},{ya:"+backColor",T:lB,Ma:"tr-icon tr-backColor",factory:function(b,c,d,e,g,h){b=IA(b,c,d,e,g,h);b.Kp("#FFF");b.Ni=xa(aB,b);return b},kb:j},{ya:"+link",T:mB,caption:JA,Ma:"tr-link",kb:j},{ya:"+insertOrderedList",T:nB,Ma:"tr-icon tr-insertOrderedList",kb:j},{ya:"+insertUnorderedList",T:oB,Ma:"tr-icon tr-insertUnorderedList",kb:j},
{ya:"+outdent",T:pB,Ma:"tr-icon tr-outdent",factory:FA},{ya:"+indent",T:qB,Ma:"tr-icon tr-indent",factory:FA},{ya:"+justifyLeft",T:rB,Ma:"tr-icon tr-justifyLeft",kb:j},{ya:"+justifyCenter",T:sB,Ma:"tr-icon tr-justifyCenter",kb:j},{ya:"+justifyRight",T:tB,Ma:"tr-icon tr-justifyRight",kb:j},{ya:"+justifyFull",T:uB,Ma:"tr-icon tr-justifyFull",kb:j},{ya:"+removeFormat",T:vB,Ma:"tr-icon tr-removeFormat",factory:FA},{ya:"image",T:wB,Ma:"tr-icon tr-image",factory:FA},{ya:"+strikeThrough",T:xB,Ma:"tr-icon tr-strikeThrough",
kb:j},{ya:"+subscript",T:CB,Ma:"tr-icon tr-subscript",kb:j},{ya:"+superscript",T:DB,Ma:"tr-icon tr-superscript",kb:j},{ya:"ltr",T:yB,Ma:"tr-icon tr-ltr",kb:j},{ya:"rtl",T:zB,Ma:"tr-icon tr-rtl",factory:function(b,c,d,e,g,h){var l=GA(b,c,d,e,g,h);l.Ni=function(b){b=!!b;D.enable(l.getParent().h(),"tr-rtl-mode",b);l.Sc(b)};return l},kb:j},{ya:"+BLOCKQUOTE",T:AB,Ma:"tr-icon tr-BLOCKQUOTE",kb:j},{ya:"+formatBlock",T:bB,caption:cB,Ma:"tr-formatBlock",factory:function(b,c,d,e,g,h){var l=HA(b,c,d,e,g,h);
z.forEach(ZA,function(b){var c=b.caption,b=b.ya,d=l.K(),c=new Qz(d.o("DIV",k,c),b,d);lh(c,b);l.Fa(c)});uA(l,YA);D.add(l.ab().ba(),"goog-menu-noaccel");l.Ni=function(b){b=b&&0<b.length?b:k;b!=l.X()&&l.ua(b)};return l},kb:j},{ya:"editHtml",T:BB,caption:EB,Ma:"tr-editHtml",factory:FA}];for(var GB=0,HB;HB=LA.PB[GB];GB++)FB[HB.ya]=HB;delete LA.PB;a.IB={};IB.WV=Nk;a.JB=function(b){wv.call(this);this.ia=new me(this);this.hF=K("div",{style:"display:none"});this.e=this.vc=k;this.D={};E.extend(this.D,this.R,b||{})};y(JB,wv);ya(JB.prototype,IB);JB.prototype.R={Lk:k,title:"Distraction Free Mode",LL:"back",tU:"publish",Tw:"zu-editing-distraction-free",nV:"sticky-goog-scrollfloater",RV:"goog-scrollfloater"};JB.prototype.nd=lf("FullScreenPlugin");FB.toggleFullScreen={ya:"toggleFullScreen",T:"写作模式",Ma:"tr-icon tr-max",factory:FA};t=JB.prototype;
t.Se=xa(E.Og,{NY:"toggleFullScreen",iX:"enterFullScreen",jX:"exitFullScreen"});t.p=function(){this.ia.G();L(this.e);this.D=this.$p=this.vc=this.xb=this.e=k;JB.m.p.call(this)};
t.zv=function(){var b=this.D,c=document.createElement("div");c.id="zu-distraction-free-editor";c.innerHTML='<div class="header"><div class="wrapper"><h1 class="title">'+b.title+'</h1><a href="#" class="'+b.LL+'" name="return">返回</a><a href="#" class="'+b.tU+'" name="save">发布</a></div></div><div class="toolbar"><div class="tools"></div></div><div class="content" class="grid"></div>';document.body.appendChild(c);this.ia.c(J("back",c),"click",function(b){b.preventDefault();KB(this)},n,this);this.ia.c(J("publish",
c),"click",function(b){b.preventDefault();this.dispatchEvent("save")&&KB(this)},n,this);this.e=c;this.vc=J("content",c);this.$p=K("div",{className:"toolbar-info"});this.D.Lk||(this.D.Lk=this.C.field)};t.of=function(b){this.e||this.zv();switch(b){case "enterFullScreen":LB(this);break;case "exitFullScreen":KB(this);break;case "toggleFullScreen":this.ny()?KB(this):LB(this)}};t.ny=function(){return D.has(document.body,this.D.Tw)};
a.LB=function(b){if(b.dispatchEvent("willEnterFullScreen")){b.aE||(b.OP=history.length);b.aE=j;MB(b,"writing");b.DJ=Nc(Ub((fa||window).document));oc(b.hF,b.D.Lk);b.vc.appendChild(b.D.Lk);D.add(document.body,b.D.Tw);b.xb=J(b.D.RV,b.e);b.xb.appendChild(b.$p);var c=b.e;c.scrollTop=0;var d=b.xb.getBoundingClientRect().top;c.onscroll=pf(v(b.wI,b),function(){return c.scrollTop>d});b.ia.c(document,"keydown",b.hp,n,b);La(Hc(b.C.field))||b.C.jg();b.dispatchEvent("enterFullScreen")}},a.KB=function(b){b.aE&&
b.OP!==history.length?history.back():MB(b,"");b.xb.removeChild(b.$p);b.wI(n);b.e.onscroll=k;b.ia.wa(document,"keydown",b.hp,n,b);oc(b.D.Lk,b.hF);D.remove(document.body,b.D.Tw);window.scrollTo(b.DJ.x,b.DJ.y);b.dispatchEvent("exitFullScreen")},a.MB=function(b,c){yd(window,"hashchange",b.$G,n,b);location.hash=c||"";setTimeout(v(function(){this.ia.c(window,"hashchange",this.$G,n,this)},b))};t.$G=function(){this.ny()?KB(this):"writing"===location.hash.slice(1)&&LB(this)};
t.hp=function(b){27===b.keyCode&&this.dispatchEvent("shouldExitFullScreenOnEscape")&&KB(this)};t.wI=function(b){D[b?"add":"remove"](this.xb,this.D.nV)};a.OB=function(b,c){M.call(this);this.HG=b;this.xA=c||NB;b.Xb||(this.show=ha)};y(OB,el);a.NB="加载中...";t=OB.prototype;
t.show=function(){mc(this.e=K("div","zg-mt10",[K("h3",{style:"margin:0 0 5px;"},"分享到微博"),K("div","zm-tab-content",[this.jZ=K("div",{className:"zg-section zg-clear",innerHTML:'<label><input data-bindurl="/oauth/auth/sina?next=/oauth/callback" class="sina-checkbox" type="checkbox"><i class="zg-ico-sina"></i> 新浪微博</label> <label><input data-bindurl="/oauth/auth/qq?next=/oauth/callback" class="qq-checkbox" type="checkbox"><i class="zg-ico-qq"></i> 腾讯微博</label>'}),K("div","zg-section",K("div","zg-form-text-input",
this.Mp=K("textarea",{style:"width:100%;height: 66px;"},"加载中..."))),K("div","zm-command",[K("div",["zm-item-meta","zg-left"],this.LU=K("span")),this.pV=K("a",{"class":"zg-btn-blue weibo-share-button",href:"javascript:;"},"分享到微博")])])]),H("zh-question-answer-form-wrap"));this.g().c(Y,"sina_callback",function(b){this.tA(b.nb.id,b.nb.name)}).c(Y,"qq_callback",function(b){this.sA(b.nb.id,b.nb.name)});this.pv();this.Cf();Mo.F().refresh();var b=this;this.xA===NB?Ei("/answer/"+b.HG.Xb+"/sharetext",function(c){if((c=
Ie(c.target))&&c.sina)b.xA=c.sina,b.Ea()},"GET"):this.Ea()};t.tA=function(b,c){Sg.name=c;this.JI=Sg.id=b;this.Ac.checked=j;this.Cf()};t.sA=function(b,c){Tg.name=c;this.IT=Tg.id=b;this.yc.checked=j;this.Cf()};t.Cf=function(){var b=J("weibo-share-button",this.e),c=this.Ac.checked||this.yc.checked;D.enable(b,"zg-btn-blue",c);D.enable(b,"zg-btn-disabled",!c)};t.Ea=function(){this.Mp.value=this.xA;this.MA=new Po(this.Mp);this.HI=new Bu(this.Mp,this.LU,140,zu);this.g().c(this.pV,"click",this.ha)};
t.pv=function(){this.Ac=J("sina-checkbox",this.e);this.g().c(this.Ac,"change",this.mp);this.yc=J("qq-checkbox",this.e);this.g().c(this.yc,"change",this.mp)};t.mp=function(b){var b=b.target,c=b.getAttribute("data-bindurl");b===this.Ac&&!this.JI||b===this.yc&&!this.IT?(window.open(c),b.checked=n):this.Cf()};
t.ha=function(b){if((b=b.target)&&D.has(b,"zg-btn-blue")&&this.Mp.value){b=new Hk(j);b.add("content",this.Mp.value);var c=[];this.Ac.checked&&c.push("sina");this.yc.checked&&c.push("qq");b.add("via",c.join(","));this.gk(b);Nk("share",this.h_?"answer_weibo":"question_weibo")}else U("请您选择或绑定微博后再进行分享！")};t.gk=function(b){b.add("aid",this.HG.qa);this.xhr=new V(j);P(this.g(),this.xhr,"complete",this.dv);this.xhr.ajax("/answer/share",b.Lc())};
t.dv=function(){var b=Ie(this.xhr);b&&b.r?U(b.msg):(U("分享发送完毕"),R(this.e,n))};a.xx=function(b,c,d){lu.call(this,b,c,d);this.Dp(j)};y(xx,lu);po("goog-checkbox-menuitem",function(){return new xx(k)});a.PB=function(b,c){M.call(this);this.Y=b;this.tc=c;this.data=Eg};y(PB,el);t=PB.prototype;
t.w=function(){this.Em=H("zh-question-redirect-info");this.Em.innerHTML&&(this.Lo=j);this.g().c(this.Em,"click",function(b){"cancel"===b.target.name&&QB(this)});var b=H("zh-question-side-header-wrap");if(Dg.Oc&&!Dg.RF&&b){var c=H("zh-question-filter-wrap");c?lc(b,c):b.style[A?"styleFloat":"cssFloat"]="none"}(this.vg=H("zh-question-operation-menu"))&&this.Nj();this.g().c(Ki,"anon_change",function(b){var c=H("zh-question-side-invitation-anon");c&&R(c,b.mb);(c=H("zh-question-side-invitation-notanon"))&&
R(c,!b.mb);this.um&&this.um.eb(lt(this.data.kk)||!b.mb)});(this.Pk=H("zh-question-webshare-container"))&&this.g().c(this.Pk,"click",this.FA)};
t.Nj=function(){this.jb=new ou;var b=this.data.rn,c=this.vg.getAttribute("data-auth"),c=c?c.split(","):[];if(b==k||0===b){this.jb.Fa(this.gt=RB("使用匿名身份",j));this.gt.Sc(this.data.mb);if((!Mg||!z.contains(Mg,"question_op_redirect"))&&"close"!==Eg.status)this.jb.Fa(this.um=RB(this.Lo?"撤消重定向":"问题重定向")),this.um.eb(lt(this.data.kk)||!this.data.mb);z.contains(c,"auth-f-manage")&&this.jb.Fa(this.YS=RB("更新话题页显示",n));this.g().c(this.jb,"action",this.Cj);this.gt&&this.g().c(Ki,"anon_change",function(b){this.gt.Sc(!!b.mb)});
this.tc&&z.contains(c,"auth-f-manage")&&(this.jb.Fa(this.wz=RB("优质回答",j)),this.wz.Sc(this.tc.BQ));b=new Ou("Settings",this.jb);b.tp=j;Qu(b);b.n(this.vg)}};a.RB=function(b,c){return!b?new nu:c?new xx(b):new lu(b)};
t.Cj=function(b){var c=this.gt;b.target===c?gs(c.ee()?1:0,function(b){b||c.Sc(!c.ee())}):b.target===this.um?(this.rp||(this.rp=new Cy(this.Y),this.g().c(this.rp,"change",this.eR)),this.jb.z(n),this.Lo?QB(this):this.rp.show()):b.target===this.TS?Ei("/question/"+this.data.Xb+(this.TS.ee()?"/unlock_summary":"/lock_summary"),function(){top!==window?top.location.href="/question/"+Eg.Xb:window.location.reload()},"POST"):b.target===this.YS?$.post("/refresh_topic_feeds",{q:Eg.Xb}).done(function(b){b.r||U("操作成功！")}):
b.target===this.wz&&$.post("/answer/"+this.tc.Xb+(this.wz.ee()?"/good_mark":"/good_unmark")).done(function(b){b.r||U("操作成功！")})};t.eR=function(){this.Em.innerHTML='<div class="zg-wrap"><div class="zu-global-nitify-inner"><span class="zu-global-notify-icon"></span>此问题将跳转至 <a href="/question/'+this.rp.Jt+'">'+this.rp.HH+'</a> （<a href="javascript:;" name="cancel">撤消重定向</a>）</div></div>';R(this.Em,j);this.Lo=j;this.um.Nm("撤消重定向")};
a.QB=function(b){b.Em.innerHTML="";R(b.Em,n);b.Lo=n;b.um.Nm("问题重定向");Ei("/question/unredirect",k,"POST","qid="+b.Y+"&rqid="+b.Jt)};t.FA=function(b){if((b=Gk(this.Pk,b.target))&&b.name){var c=Cu.F(),d=$("#zh-question-webshare-container").data();c.yk(d.title,d.type,d.urlToken,{answer:{aid:d.id},question:{qid:d.id}}[d.type]);c.show();Du(c,"tb-webshare-"+b.name);Y.V({type:"ga_click_share_question_box",target:b,data:{type:b.name}})}};a.SB=function(){T.call(this)};y(SB,T);SB.prototype.J=function(b,c){SB.m.J.call(this,b,c);this.g().c(b,"beforeexpand",this.sP)};SB.prototype.sP=function(b){var c=b.target;oh(this,function(b){c!==b&&b.ac()&&b.La(n)})};SB.prototype.G=function(){this.g().G();SB.m.G.call(this)};a.TB=function(b,c){T.call(this);this.HT=b;this.tt=c;this.tQ=this.ca=k;this.md=n;this.Eo=k;this.em=[];this.SI=[];this.zg=n;this.ZQ="loading";this.GF="zg-btn-white";this.uQ="invite-button"};y(TB,T);t=TB.prototype;t.o=function(){this.e=K("div",{style:"display:none",className:"question-invite-panel"})};t.Z=function(){this.zg=j;TB.m.Z.call(this)};
t.B=function(){TB.m.B.call(this);var b=this.e,c=this.g();if(!this.zg){c.c(Ki,"anon_change",this.reload);var d=J("cancel-anon",b);d&&c.c(d,"click",this.hO);if(!J("error-message")){var d=J("search-input",b),e=J("invite-title",b);this.iy=J("invite-status",b);c.c(this.iy,"click",this.iO);var g=J("suggest-persons",b);g&&(c.c(g,"click",this.Dx),this.RI=g);$(b).on("hover",".invited-shortlist",function(){$(".invited-hovercard",b).toggleClass("in")});this.ay(d,e);this.SI=$(this.RI).children().map(this.wH).get();
this.em=$(".invited-fulllist",this.iy).children().map(this.wH).get();var h=function(b){0>b||b>m-1||(x.find("li").hide().slice(4*b,4*(b+1)).show(),0===b?p.addClass("link-disabled"):p.removeClass("link-disabled"),b===m-1?r.addClass("link-disabled"):r.removeClass("link-disabled"),l=b)},c=this.e,l=0,m,p,r,x;x=$(".suggest-persons",c);m=x.find("li").length/4;p=$(".js-prev",c).on("click",function(){h(l-1)});r=$(".js-next",c).on("click",function(){h(l+1)});h(0);R(this.e,this.md)}}};
t.$a=function(){TB.m.$a.call(this);this.g().G()};t.ej=s('<i class="icon icon-spike"></i><div class="spinner">正在加载，请稍等 <i class="spinner-gray"></i></div>');t.reload=function(){this.ac()?this.nk():this.zg=j};t.nk=function(){var b=this,c=this.ZQ;this.$a();D.add(this.e,c);this.e.innerHTML=this.ej();return $.get("/node/QuestionInvitePanelV2",{params:{question_id:this.HT}}).done(function(d){b.zg=n;D.remove(b.e,c);d=hc(La(d));R(d,b.ac());oc(d,b.e);b.e=d;b.B()})};
t.p=function(){TB.m.p.call(this);this.tQ=k;this.ca.G()};t.ac=q("md");t.expand=function(){this.La(j)};t.collapse=function(){this.La(n)};t.La=function(b){if(b!==this.md){this.dispatchEvent(b?"beforeexpand":"beforecollapse");var c=v(function(){this.dispatchEvent(b?"expand":"collapse")},this);b&&this.zg?this.nk().done(c):c();this.md=b;R(this.e,b)}};t.pe=function(){this.La(!this.md)};
t.ay=function(b){var c=this,d=Pk('<img class="zm-item-img-avatar zg-left" src="<%=avatar%>"><span class="zu-autocomplete-row-name" title="<%-fullname%>"><%-fullname%></span><span class="zg-gray-normal zu-autocomplete-row-description"><%=headline%></span>');this.ca=new Xo(b,{je:8,source:"/people/autocomplete",qk:b.offsetParent,placeholder:"搜索你想邀请的人",dd:function(b,c,h){h.innerHTML=d(b.data)},filter:function(b){return z.filter(b,function(b){var d=b.id;return!z.find(c.em,function(b){return b.id===d})})},
select:function(b){UB(c,"ask_to_answer_search");pt(c.tt,b.id,"search").done(function(d){if(d.r)return U(d.msg);VB(c,b);WB(c,b.id,j)});return""}})};a.XB=function(b,c,d){b=b.GF;d?(D.add(c,b),zc(c,"收回邀请")):(D.remove(c,b),zc(c,"邀请回答"))};t.hO=function(){gs(0)};a.UB=function(b,c){var d=Eg;b.dispatchEvent(new Hw("click!invitation",{category:"invitation",action:"ask_to_answer",label:c,value:d.NF?k:d.Lq}))};
t.Dx=function(b){var c=b.target;if("BUTTON"===c.tagName||D.has(c,this.uQ)){this.Eo&&"pending"===this.Eo.state()&&this.Eo.abort();b="related"===c.getAttribute("data-type")?"recommended_relative_questions":"recommended_top_answerers";UB(this,b);var d=c.getAttribute("data-uid"),e=this.GF,g=v(function(b){b?(XB(this,c,j),b=z.find(this.SI,function(b){return b.id===d}),VB(this,b)):(XB(this,c,n),YB(this,d))},this);D.has(c,e)?(this.Eo=ot(this.tt,d),g(n)):(this.Eo=pt(this.tt,d,b).done(function(b){b.r&&(U(b.msg),
g(n))}),g(j))}};t.iO=function(b){b=b.target;"BUTTON"===b.tagName&&(b=b.getAttribute("data-uid"),ot(this.tt,b),WB(this,b,n),YB(this,b))};a.WB=function(b,c,d){var e=$(".invite-button",b.RI).filter(function(){return this.getAttribute("data-uid")===c}).get(0);e&&XB(b,e,d)};t.wH=function(){var b=$(this),c=$(".zm-item-link-avatar",b);return{id:String($("button",b).data("uid")),avatar:$("img",c).attr("src"),fullname:c.attr("title"),url_token:c.attr("href").split("/").slice(-1)[0]}};
a.VB=function(b,c){b.em.unshift(c);ZB(b);$(".ignore-invite-hint").css("display","none")},a.YB=function(b,c){b.em&&z.WT(b.em,function(b){return b.id===c})&&(ZB(b),$(".ignore-invite-hint").css("display","none"))};t.MU='您已邀请 <span class="invited-shortlist"><% helper.each(persons.slice(0, 2), function(person, i, sliced) { %><a href="/people/<%=person.url_token%>" class="zg-link-gray"><%=person.fullname%></a><%= i !== sliced.length - 1 ? "、" : ""%><% }); %><%=helper.fullList()%></span><% if (persons.length > 2) { %> 等 <%=persons.length%> 人 <% } %>';
t.ON='<div class="invited-hovercard"><i class="icon icon-spike"></i><ul class="invited-fulllist"><% helper.each(persons, function(person, i) { %><li><a title="<%-person.fullname%>" class="zm-item-link-avatar" href="/people/<%=person.url_token%>"><img src="<%=person.avatar%>" class="zm-item-img-avatar"></a><a href="/people/<%=person.url_token%>" class="zg-link-gray" title="<%-person.fullname%>"><%=person.fullname%></a><button class="cancel-button zg-link-btn zg-link-gray" data-uid="<%=person.id%>">收回邀请</button></li><% }) %></ul></div>';
a.ZB=function(b){var c=b.em,d={each:z.forEach,fullList:function(){return Pk(b.ON,{persons:c,helper:d})}};b.iy.innerHTML=c.length?Pk(b.MU,{persons:c,helper:d}):""};a.$B=function(b){this.data=b;this.na=k};y($B,T);t=$B.prototype;t.B=function(){$B.m.B.call(this);this.g().c(this.e,"click",this.sm);var b=J("panel-container",this.e);b&&(this.Zj=new SB,this.J(this.Zj),this.Zj.n(b),this.na=new Qw(this.data.Y,"question"),this.Zj.J(this.na),Tw(this.na,this.Zj.h(),$(".toggle-comment",this.e)[0]),aC(this));this.g().c(this,"click!",function(b){"comment"===b.namespace&&b.Dc.fill("label","question")})};
t.sm=function(b){var c=(b=Gk(this.e,b.target))&&b.name;if(c)switch(c){case "report-question":bu.Gm("question",this.data.Y);break;case "addcomment":if("添加评论"===$.trim($(b).text())&&this.ri(0,"question_add_comment_start"))break;this.na.pe();this.na.ac()&&this.na.Ki("view_comments",parseInt(Hc(b),10)||0);break;case "remove":Ci("删除问题","你确定要删除这个问题吗？相关的评论也将被删除。",function(b){if(b){var c=new V(j);N(c,"complete",function(){var b=Ie(c);b&&!b.r?window.location.href="/":U(b.msg)});c.ajax("/question/delete/"+
this.data.Y)}},this);break;case "admin":c=this.QK;c||(c=new Su,c.n(H("zh-question-admin-menu")),oh(c,function(b){b.ua(b.h().getAttribute("data-action"))}),this.g().c(c,"action",function(b){var b=this.eC=b.target,c=ov.F();c.Dl={id:this.data.Y,type:"question"};vv(c,b.h(),v(this.DM,this));c.z(j)}),this.QK=c);c.S()?c.z(n):Tu(c,new bt(b,1,j),0,new Of(5,0,5,0));break;case "share":Y.V({type:"ga_click_share_question_box",target:b});this.de();break;case "invite":this.Dx()}};
t.ri=function(b,c){return!S.Ia()?(Jk.F().Ha=c,Jk.F().z(j),Jk.F().Tc(),j):n};a.aC=function(b){if("normal"===Eg.status){var c=new TB(b.data.Y,b.data.Xb),d=H("question-invite-panel");d?(c.n(d),b.Zj.J(c),c.La(!b.na.ac()),b.dispatchEvent(new Hw("show!invitation",{category:"invitation",action:"ask_to_answer_card",label:""}))):(c.Z(b.Zj.h()),b.Zj.J(c));b.hy=c}};
t.Dx=function(){if(this.hy){this.hy.pe();var b=this.hy.ac();this.dispatchEvent(new Hw("click!invitation",{category:"invitation",action:(b?"show":"hide")+"_ask_to_answer_card",label:"?",value:this.data.Lq}))}else aC(this)};t.de=function(){if(S.Ia()){var b=Cu.F();b.yk("分享问题","question",this.data.Xb,{qid:this.data.Y});b.show();Du(b,"tb-webshare-sina")}else Jk.F().z(j),Jk.F().Tc("share","加入知乎，即可和朋友分享精彩内容","分享到新浪微博、腾讯微博或通过私信分享")};t.DM=function(b){this.eC.X(b.msg.action);this.eC.Nm(b.msg.caption)};a.bC=function(b,c,d){px.call(this,b,c,d)};y(bC,px);bC.prototype.n=function(b){bC.m.n.call(this,b);this.We&&this.Bp(this.RM.mb)};bC.prototype.S=function(){return $(this.e).is(":visible")};a.cC=function(){T.call(this);this.data=Eg||{};this.Y=this.data.Y;this.Lo=n;this.Vf={};this.dl=[];this.cl=[];this.qi=0;this.Kq=k};y(cC,T);a.dC={Ju:"vote",OJ:"added_time"};t=cC.prototype;t.bl="zm-item-answer";t.w=function(){yl.J(this);this.n(document.body)};
t.B=function(){cC.m.B.call(this);var b=H("zh-question-meta-wrap");b&&(this.KH=new $B(this.data),this.J(this.KH),this.KH.n(b));this.Ao();var c=this;$(".js-ignore-invite").click(function(){$(".question-invited-by").hide();$.post("/question/askpeople",{qid:c.data.Xb,uid:S.Yj,op:"pass"})});this.$o=new wz;this.g().c(this.$o,"change",this.Gz);this.$o.w();this.xI()};
t.xI=function(){this.lv=dC.Ju;this.data.Xb=Eg.Xb;eC(this,j);if(S.Ia()&&("close"!==Eg.status&&(this.Qa=new lp(this.data.$m,this.data.Y),this.Qa.Us=5,this.Qa.Xs=1,this.Qa.bt=j,this.Qa.n(J("zm-tag-editor",this.e)),this.g().c(this.Qa,["remove_tag","add_tag"],function(){Y.V("ga_edit_question_topic_changed")}),this.g().c(this.Qa,"start_editing",function(){Y.V("ga_question_topic_edit_finish_changed")})),"close"!==Eg.status)){this.Nd=new Sy(this.data.Y,"/question/title","content",n,j);this.Nd.wr=j;this.Nd.Ed=
j;this.Nd.sk=j;var b=lt(this.data.kk);this.Nd.fm=b;this.Nd.n(H("zh-question-title"));this.g().c(this.Nd,"change",function(){Ki.dispatchEvent("question_title_change");document.title=this.Nd.ib()+" - 知乎"});this.g().c(this.Nd,"click_edit",function(){Y.V("ga_question_title_edit_start")});this.g().c(this.Nd,"cancel_edit",function(){Y.V("ga_question_title_edit_cancel")});this.g().c(this.Nd,"save_changed",function(){Y.V("ga_question_title_edit_save_changed")});this.g().c(this.Nd,"save_unchanged",function(){Y.V("ga_question_title_edit_save_unchanged")})}this.wC=
H("zh-question-answer-num");this.qn=H("zh-question-answer-wrap");this.Th=H("zh-question-collapsed-link");this.Jn=H("zh-question-collapsed-wrap");this.uM=H("zh-question-collapsed-num");this.uL=H("zh-question-answer-form-wrap");this.Gk=H("zh-question-notification-summary");this.LI=H("zh-answers-filter");this.vt=H("zh-add-question-sug");this.Th&&this.g().c(this.Th,"click",this.uV);this.vt&&this.g().c(this.vt,"click",this.IE);P(this.g(),this,"answers_inited",this.LR);(this.Kv=H("zg-question-suggested-topics"))&&
this.g().c(this.Kv,"click",this.JR);this.zo();this.g().c(window,"hashchange",function(b){b=b.Zb;b.oldURL&&"writing"===b.oldURL.split("#")[1]||fC(this)});this.Kq=new T;this.J(this.Kq);this.Kq.n(this.qn);this.wF()};t.Ao=function(){Fu("question",this.data.Xb,"read");this.g().c(this,["click!","show!"],function(b){"comment"===b.namespace&&b.Dc.fill("category","question_answer").fill("label","question_answer");"invitation"===b.namespace&&b.Dc.fill("label","question_page")})};
t.LR=function(){var b=S[4];Fg&&Fg.length&&(b=Fg[0][1]);this.sb=new jw(this.data.mb,S,b);this.J(this.sb);this.sb.n(this.uL);Kg&&Kg.length?this.sb.Oa(Kg[0]):!Dg.Oc&&B&&this.sb.Oa("<p></p>");if(!this.data.Jo&&!this.qi)if(this.data.rn&&this.data.rn.length&&this.data.rn[3]!==S[3])this.sb.eb(n,"只有 "+it(this.data.rn)+" 能回答此问题");else if("normal"===Eg.status||Kg)S.kk||this.sb.vd();this.g().c(this.sb,"change",this.KR);this.g().c(this.sb,"cancel_delete_answer",this.UR);this.sb.ready(function(){var b=this.Qr();
b&&"writing"===location.hash.slice(1)&&b.execCommand("toggleFullScreen")});gC(this);fC(this,k);hC(this);this.g().c(Ki,"anon_change",function(b){this.data.mb=b.mb});if(b=$("#zh-question-filter-wrap")[0]){var c=this,d=new rz({options:{vote:"按票数排序",added_time:"按时间排序"}});d.ua("vote");d.n(b);c.g().c(d,"change",function(b){b=b.data.key;if(b!==c.lv){c.lv=b;var d=function(b,c){return b-c},h=function(b,c){return c-b};b===dC.Ju?z.KI(c.dl,"vote",h):b===dC.OJ&&z.KI(c.dl,"added_time",d);z.forEach(c.dl,function(b){b=
this.Vf[b.aid];b.fh||lc(b.h(),this.qn.firstChild)},c)}$(window).trigger("updatelazy")})}this.g().c(Ki,"answer_reorder",this.AP)};t.Gz=function(){this.FP=j;this.Gk=$(this.$o.DR)[0];mc(this.Gk,H("zh-question-redirect-info"));R(this.Gk,j);Dg.Oc||(this.tj=new Pq,this.tj.n(this.Gk),$r(this.tj));this.g().c(this.Gk,"click",this.IE);fC(this)};
a.eC=function(b,c){!S.Ia()||!c?(iC(b,"zh-question-detail",ha),iC(b,"zh-question-answer-summary",ha)):(iC(b,"zh-question-detail",b.aQ),iC(b,"zh-question-answer-summary",b.eQ))},a.iC=function(b,c,d){if(c=H(c)){var e=new nx;b.g().c(e,"expand",d).c(e,"invalid",d);e.n(c)}};
t.aQ=function(b){if("close"!==Eg.status){b=b.target.h();this.Mb=new Sy(this.data.Y,"/question/detail","content",j,k,600);var c=lt(this.data.kk);this.Mb.fm=c;this.Mb.rZ=Lk;J("zm-editable-content",b).innerHTML&&(this.Mb.sk=j);this.Mb.n(b);this.g().c(this.Mb,"click_edit",function(){Y.V("ga_question_supplement_edit_start")});this.g().c(this.Mb,"cancel_edit",function(){Y.V("ga_question_supplement_edit_cancel")});this.g().c(this.Mb,"save_changed",function(){Y.V("ga_question_supplement_edit_save_changed")});
this.g().c(this.Mb,"save_unchanged",function(){Y.V("ga_question_supplement_edit_save_unchanged")})}};t.eQ=function(b){var b=b.target.h(),c=H("zh-question-answer-summary-link"),d;if(b&&(Dg.HF||!this.data.rV))d=new nr(j,"/question/summary","content"),d.rd=["id="+this.data.Y],d.Xq=n,d.n(b);if(c){var e=H("zh-question-answer-summary-wrap");this.g().c(c,"click",function(){d&&(R(e,j),d.vd())}).c(e,"click",function(b){"cancel"===b.target.name&&(b=!d.kg(),R(e,!b))})}this.h0=d};
t.IE=function(b){if("close"===b.target.name){if(this.tj&&(Vq(this.tj),Uq(this.tj,n),history.replaceState)){var b=new vf(location.href),c=b.Lc();c.remove("q");c.remove("psq");history.replaceState({},"",b.yg+"?"+c.toString())}R(this.Gk,n);R(this.vt,n)}else if("A"===b.target.tagName&&"zh-question-suggest-reask"===b.target.id&&(R(this.vt,n),Y.fireEvent("query_string_change")),c="a"===$(b.target).prop("tagName").toLowerCase()?b.target:this.qf(b.target,"A"))b.preventDefault(),b.stopPropagation(),b=c.getAttribute("data-source")||
c.href,c=b.indexOf("#"),b=0>c?k:b.substr(c+1),fC(this,b&&decodeURIComponent(b))};a.hC=function(b){var c=0,d=0,e=0;z.forEach(b.cl,function(b){b=this.Vf[b];b.pg||(b.fh?d++:e++,c++)},b);b.data.cr=+b.uM.innerHTML;S.Ia()||(b.data.cr=0);b.data.Lq=e;R(b.Th,0<b.data.cr);b.wC&&zc(b.wC,e?e+" 个回答":"还没有回答");b.LI&&R(b.LI,1<b.data.Lq);R(b.Th,0<b.data.cr)};
t.wF=function(){this.$P||(this.xC=Xb(this.bl,this.qn),this.BL=this.xC.length,this.wL=200,this.qD=0);this.$P=j;for(var b=this.qD,c=this.wL,d=this.BL,e=b;e<d&&e<b+c;)jC(this,this.xC[e],e),e++;e<d?(this.qD=e,setTimeout(v(this.wF,this),30)):this.dispatchEvent("answers_inited")};
a.jC=function(b,c,d,e){e=new bC(b.Y,k,e);b.Kq.J(e);e.n(c);b.Vf[e.qa]=e;b.cl.push(e.qa);b.g().c(e,"change",b.hz);e.We&&(b.qi=e.qa,e.FL=S,b.g().c(e.Ae,"change",b.WO),b.Be=e);e.fh?e.We&&b.Jn.appendChild(e.h()):b.dl.push({added_time:e.Sv,vote:d,aid:e.qa});e.pg&&R(e.h(),n)};
t.WO=function(){var b=this.Be,c=b.h(),d=b.Ae.ib()[0];R(c,n);d=hc(La(d));lc(d,c);this.Vf[b.qa]=k;this.cl=z.filter(this.cl,function(c){return c!==b.qa},this);var e=999;this.dl=z.filter(this.dl,function(c){c.aid===b.qa&&(e=c.vote);return c.aid!==b.qa},this);L(c);b.G();jC(this,d,e,n)};t.AP=function(b){1>=this.cl.length||this.lv!==dC.Ju||Ck(this.Vf[b.vL].h())};
t.hz=function(b){b=b.target;if(b instanceof bC){var c=b.h();switch(b.Su){case "collap":this.Jn.appendChild(c);D.add(c,"zm-item-collapsed");hC(this);break;case "cancel_collap":this.qn.appendChild(c);D.remove(c,"zm-item-collapsed");kC(this,c);hC(this);break;case "set_delete":gC(this);hC(this);break;case "cancel_delete":kC(this,this.Vf[this.qi].h()),gC(this),hC(this)}}};
a.gC=function(b){var c=k,c=k,d={suggest:"建议修改",evaluate:"建议修改",close:"关闭"};!Kg&&"normal"!==Eg.status&&(c="被"+d[Eg.status]+'的问题不允许添加新的回答。<a data-tip="s$b$为什么部分问题会被「关闭」「建议修改」？" href="//www.zhihu.com/question/21290061 "><i class="zg-icon zg-icon-question-mark"></i></a>');b.qi&&(c=b.Vf[b.qi],c=c.pg?'你已经删除了对该问题的回答，如果需要修改，请先 <a href="javascript:;" name="cancel_delete">撤消删除</a>':'一个问题你只能回答一次，但你可以对 <a href="#answer-'+c.qa+'">现有的回答</a> 进行修改');S.kk&&!b.qi&&(c='添加回答：<a href="javascript:;" name="answer_my_question">回答自己的提问</a>');
b.data.Jo&&(c='该问题目前已经被锁定，无法添加新答案。<a href="http://www.zhihu.com/question/19604313" target="_blank">问题为什么会被锁定？</a>');c&&!b.sb.ag&&b.sb.eb(n,c)},a.lC=function(b,c){var d=H("zh-question-collapsed-switcher");c?(d.name="collap",b.bD=j,R(b.Jn,j),D.add(b.Th,"zu-question-collap-title-active")):(b.bD=n,d.name="expand",R(b.Jn,n),D.remove(b.Th,"zu-question-collap-title-active"))};
t.uV=function(b){if((b=Gk(this.Th,b.target))&&b.name)if("expand"===b.name){if(!this.wM){this.wM=j;var c=this,d=this.Jn,b=$.get("/node/QuestionCollapsedAnswerListV2",{params:{question_id:this.data.Y}});b.done(function(b){b=hc(b);lC(c,j);D.remove(d,"zm-question-collapsed-list-loading");d.appendChild(b);z.forEach(qc(d),function(b){b!==e&&jC(c,b,99999)});$("img.lazy",d).lazyload({data_attribute:"actualsrc",threshold:400})});var e=qc(d)[0];e&&(R(e,n),b.done(function(){R(e,j)}));R(d,j);D.add(d,"zm-question-collapsed-list-loading")}lC(this,
j)}else lC(this,n)};t.UR=function(){var b=this.Vf[this.qi];b.pg=n;b.status=0;yx(b);kC(this,b.h())};
t.KR=function(){var b=this.sb.Jq.checked,c={AG:j,title:"确认放弃匿名身份？",content:"你在该问题下的赞同和关注行为将以实名显示。"},d=v(function(){if(!this.xhr||!this.xhr.Hb()){var c=this.sb.kg();if(c){var d=new V(j),h=new fj,l=b?1:0;h.add("id",this.Y).add("content",c).add("anon",l);d.on("success",function(){Eg.mb!==l&&Ki.dispatchEvent(new Zr(l));var b=Ie(this.xhr);b&&!b.r?(b=hc(La(b.msg[0])),this.qn.appendChild(b),jC(this,b,this.cl.length,j),gC(this),Eg.mb||(this.xR=new OB(this.Vf[this.qi]),this.xR.show()),S.CN&&$("#answer-my-question-tip").insertAfter($("#zh-question-answer-form-wrap")).show(),
hC(this),this.sb.G()):U(b.msg)},n,this);d.ajax("/answer/add",h.toString());this.xhr=d}}},this);Eg.mb&&!b?Ci(c,function(b){b&&d()}):d()};t.qf=ba();t.JR=function(b){if((b=this.qf(b.target))&&b.name){var c=b.name;"close"===c?R(this.Kv,n):"addtag"===c&&(this.Qa.cf(b.id.split("-")[1],b.innerHTML),R(b,n))}};t.zo=function(){this.IA=new PB(this.Y);this.IA.w()};
a.fC=function(b,c){if(c=c||location.hash.slice(1)){var d=c.split("-"),e=d[1];"answer"===d[0]&&(d=b.Vf[e])&&(d.fh&&!b.bD?kC(b,b.Th):kC(b,d.h()))}},a.kC=function(b,c){if(c){var d=xg(document.body).top,e=b.FP?og(b.Gk).height:0,d={paddingTop:d+e};"number"===$.type(d)&&(d={offsetTop:d});d.yJ=Cs;Bs(c,d);Ck(c);b.tj&&b.tj.gq()}};a.mC=function(){cC.call(this);this.data=Eg;this.Y=this.data.Y};y(mC,cC);t=mC.prototype;t.xI=function(){(this.xr=H("zh-single-answer-disable-wrap"))&&this.g().c(this.xr,"click",this.oU);this.dm();this.zo();var b=$("#zh-question-answer-collestions");b.length&&$("a[name=focus]",b).click(function(){Kk(this,"favlist")});eC(this,n)};t.Ao=function(){this.g().c(this,["click!","show!"],function(b){"invitation"===b.namespace&&b.Dc.fill("label","answer_page")});mC.m.Ao.call(this)};
t.oU=function(b){b.target&&b.target.name&&(b=this.tc,b.pg=n,b.status=0,yx(b))};
t.dm=function(){var b=J("zm-item-answer",H("zh-question-answer-wrap"));if(b){this.tc=new bC(this.Y);this.J(this.tc);this.tc.n(b);b=this.g();b.c(this.tc,"change",this.hz);if(this.tc.CQ){b.c(Ki,"anon_change",function(b){var c=b.mb,b=$("#js-sidebar-author-info");if(!$("a[name=focus]",b).length){var g={"0":"fullname",1:"url_token",2:"avatar_path",3:"hash",4:"headline"},h=z.reduce(S,function(b,c,d){b[g[d]]=c;return b},{}),c=Pk(this.GL,{author:!c&&h});b.html(c)}});var c=this.tc.Ae;c&&b.c(c,"change",function(){var b=
La(c.ib()[0]),b=hc(b);oc(b,this.tc.e);this.dm(b)})}nC(this);tx(this.tc,{autofocus:n,gG:j})}};t.GL='<h3>关于作者</h3><% if (author) { %>    <a class="zm-list-avatar-link" href="/people/<%= author.url_token %>" tabindex="-1">        <img class="zm-list-avatar-medium" src="<%= author.avatar_path.replace("_s.","_m.") %>"/>    </a>    <div class="zm-list-content-medium">        <h2 class="zm-list-content-title">            <a href="/people/<%= author.url_token %>"><%= author.fullname %></a>        </h2>        <div class="zg-gray-normal"><%= author.headline || "" %></div>    </div><% } else { %>    <a class="zm-list-avatar-link" href="javascript:;">        <img class="zm-list-avatar-medium" src="http://img.zhihu.dev:4080/66/6b/666b0abfc_m.jpg"/>    </a>    <div class="zm-list-content-medium">        <h2 class="zm-list-content-title">匿名用户</h2>    </div><% } %>';
t.zo=function(){this.IA=new PB(this.Y,this.tc);this.IA.w();var b=H("js-sidebar-author-info");b&&(new Tn(b)).w()};t.hz=function(b){b=b.target;if(b instanceof bC)switch(b.Su){case "collap":D.add(b.h(),"zm-item-collapsed");break;case "cancel_collap":D.remove(b.h(),"zm-item-collapsed");break;case "set_delete":case "cancel_delete":nC(this),location.reload()}};
a.nC=function(b){b.tc?b.tc.pg?(b.xr.innerHTML=b.tc.We?'你已经删除了对该问题的回答，如果需要修改，请先 <a href="javascript:;" name="cancel_delete">撤消删除</a>':"此答案已经被作者删除",R(b.tc.h(),n)):R(b.tc.h(),j):b.xr.innerHTML="此答案已经被作者删除"};a.oC=function(){T.call(this);this.page=1};y(oC,T);oC.prototype.w=function(){var b=J("js-topic-feed-page");this.n(b)};
oC.prototype.B=function(){oC.m.B.call(this);var b=this;this.FB=$(".js-topic-feed-container",this.e);this.FB.find(".js-topic-item").each(function(){var c=new pC;b.J(c);c.n(this)});this.nt=new qC;this.nt.n($(".js-pinned-topics",this.element)[0]);(this.bc=H("js-load-more"))&&this.g().c(this.bc,"click",this.rz);$(".instruction .close-normal").click(function(){var b=new V(n);b.ajax("/notifeature?feature=6",k,"GET");xd(b,"success",function(){$(".instruction").fadeOut()})});this.g().c(this.nt,"change",function(b){$("#tf-"+
b.$I).find(".js-pin").replaceWith('<a href="javascript:;" data-action="pin-topic" class="zg-gray pin topic-hover-content" style=""><i class="z-icon-pin"></i>固定话题</a>')})};a.rC=function(b,c){zc(b,c?"加载中...":"更多")};oC.prototype.rz=function(){rC(this.bc,j);this.xhr=new V(j);P(this.g(),this.xhr,"complete",v(this.Af,this));var b=new Hk;b.add("page",++this.page);this.xhr.ajax(location.pathname,b.Lc())};
oC.prototype.Af=function(){var b=this,c=Ie(this.xhr);c&&!c.r&&(0<c.msg.length?($(c.msg).each(function(c,e){var g=new pC;b.J(g);g.n($(e)[0]);b.FB.append(g.h())}),rC(this.bc,n)):$(this.bc).hide())};a.pC=function(){T.call(this)};y(pC,T);pC.prototype.B=function(){pC.m.B.call(this);this.g().c(this.e,"click",v(this.fz,this))};
pC.prototype.fz=function(b){var c=b.target,b=$(c).attr("data-action"),d=$(this.e).find(".topic-avatar img"),e=d.clone(),g,h=$(this.e).data("id");if("pin-topic"===b)g=this.getParent().nt,$.post("/pin-topic/add",{tid:h},$.proxy(function(b){!b.r&&b.msg?($(this.e).append($(this.dU({topic:b.msg})).hide().fadeIn()),sC(this)):U(b.msg,2E3)},g)).done(function(b){if(!b.r&&b.msg){Ck(c);$(c).replaceWith('<a href="javascript:;" data-action="unpin-topic" class="zg-gray unpin topic-hover-content" style=""><i class="z-icon-unpin"></i>取消固定</a>');
var b=d.offset(),h=$(g.e).offset();1E3<b.top-h.top?(h=$(".top-nav-topic-selector.current a").offset(),h={top:h.top+20,left:h.left+15,width:"25px",height:"25px",opacity:0.1},e.css({position:"absolute","z-index":"999"}).css("top",b.top).css("left",b.left).appendTo("body").animate(h,300,function(){e.remove()})):e.css({position:"absolute","z-index":"999"}).appendTo("body").css("top",b.top).css("left",b.left).animate({top:h.top-63+$(g.e).height(),left:h.left,width:"-=50px",height:"-=50px",opacity:0.5},
300,function(){e.remove()})}});else if("unpin-topic"===b){var l=this.getParent().nt,m=function(){var b=$(c).replaceWith('<a href="javascript:;" data-action="pin-topic" class="zg-gray pin topic-hover-content" style=""><i class="z-icon-pin"></i>固定话题</a>')[0];Ck(b)},p=$(l.e).find("[data-topicid="+h+"]");p.fadeOut(function(){p.remove();l.du().done(function(){m&&m()});l.dispatchEvent({type:"change",$I:p.attr("data-topicid")})})}else if("follow"===b||"unfollow"===b)Kk(c,"topic",k,["follow","unfollow"]),
$(this.e).fadeOut()};a.qC=function(){T.call(this)};y(qC,T);qC.prototype.dU=Pk('<div class="side-topic-item js-pin-item  cursor-move" data-topicid="<%=topic.id%>" >    <a href="/topic/<%=topic.url_token%>" class="pin-topic-avatar-link">        <img src="<%=topic.avatar_path%>" alt="" title="拖动以排序" class="side-topic-avatar js-topic-avatar">    </a>    <div class="side-topic-content ellipsis">        <a href="/topic/<%=topic.url_token%>" class="topic-link side-topic-title"><%=topic.name%></a>        <div class="side-topic-meta">        <% if (topic.children_num > 0) { %>            <span class="zg-gray"><%=topic.children_num%> 个子话题</span>            <span class="bull">&bull;</span>        <% } %>            <span class="zg-gray"><%=topic.followers_num%> 人关注</span>        </div>        <% if (topic.feed_num > 0) { %>            <a class="side-topic-more" href="/topic/<%=topic.url_token%>"><%=topic.feed_num %> 条动态&nbsp;&raquo;</a>        <% }else{ %>            <a class="side-topic-more" href="/topic/<%=topic.url_token%>">进入话题 &raquo;</a>        <% } %>    </div>    <a href="javascript:;" data-action="up" class="up" data-tip="s$b$置顶"></a>    <a href="javascript:;" data-action="remove" class="delete"></a></div>');
qC.prototype.B=function(){qC.m.B.call(this);this.g().c(this.e,"click",v(this.fz,this));sC(this)};a.sC=function(b){b.bg&&b.bg.G();var c=new Jl;c.Br="pin-topic-moving";Kl(c,b.e,0);c.w();b.g().c(c,"dragend",v(b.du,b));b.bg=c;$("a",b.e).each(function(){b.g().c(this,"mousedown",function(b){b.stopPropagation()})})};
qC.prototype.fz=function(b){var c=this,d=b.target,e=$(d).attr("data-action");if(e){var g=$(d).parents(".js-pin-item");if("up"===e){var b=g.position(),h=g.clone();g.before(h).css({position:"absolute","z-index":"999"}).css("top",b.top).animate({top:$(c.e).position().top},200,function(){h.remove();g.css({position:"relative",top:0}).prependTo(c.e);c.du()});h.css("opacity",0)}else"remove"===e&&g.fadeOut(function(){g.remove();c.du();c.dispatchEvent({type:"change",$I:g.attr("data-topicid")})})}else b.stopPropagation()};
qC.prototype.du=function(){var b=[];$(this.e).find("div.js-pin-item").each(function(){b.push($(this).attr("data-topicid"))});return $.post("/pin-topic",{topic_ids:b.join(",")},ba())};a.tC=function(){T.call(this);this.cE="even";this.Pn="current"};y(tC,T);t=tC.prototype;t.w=function(){yl.J(this);this.n(document.body)};
t.B=function(){tC.m.B.call(this);this.Au=$("ul.zm-topic-cat-main").children();var b=this.yd=$("div.zh-general-list"),c=new Wt({Pa:["autoload","nodeSource"]});this.J(c);c.n(b.get(0));this.g().c(c,"next",this.Fq);this.bG=c;b.on("click","a.follow",function(){Kk(this,"topic",xa(Ck,this),k,{follow_text:"关注"})});N(window,"hashchange",this.aH,n,this);this.aH()||(b.show(),this.Fq())};
t.Fq=function(){var b=this.yd.show().children();if(!b.length)return this.yd.html('<p class="zg-gray-normal" style="text-align:center;line-height:4;">没有子话题。</p>');b.removeClass("no-border "+this.cE);b.filter(":odd").addClass(this.cE);b=b.last();b.index()%2?b.add(b.prev()).addClass("no-border"):b.addClass("no-border");var b=this.Tr(),c=b.params&&b.params.topic_id,b=this.Au.filter(function(){return $(this).attr("data-id")===String(c)});b.length&&b.addClass(this.Pn).siblings().removeClass(this.Pn)};
t.Tr=function(){return this.yd.data("init")};t.aH=function(){var b;a:{var c=decodeURIComponent(location.hash.slice(1));if(c&&(b=this.Au.filter(function(){return $(this).text()===c}),b.length&&this.Au.filter("."+this.Pn).text()!==c)){b.addClass(this.Pn).siblings().removeClass(this.Pn);b={params:{topic_id:b.data("id")}};var d=this.Tr();$.extend(j,d,b);this.yd.attr("data-init",JSON.stringify(d));this.yd.empty();this.bG.cj();this.bG.Jy();b=j;break a}b=i}return b};a.uC=function(){T.call(this)};y(uC,T);uC.prototype.w=function(){yl.J(this);this.n(document.body)};uC.prototype.B=function(){uC.m.B.call(this);vC(this,"zh-global-logs-wrap");vC(this,"zh-global-logs-questions-wrap");vC(this,"zh-question-log-list-wrap")};a.vC=function(b,c){var d=H(c);if(d){var e=new Wt;b.J(e);e.Pa("locationSource",{kt:j});e.n(d);Iy(d)}};a.wC=function(){T.call(this)};y(wC,T);wC.prototype.w=function(){yl.J(this);this.n(document.body)};wC.prototype.B=function(){wC.m.B.call(this);this.yo("zh-question-followers-list-wrap")};wC.prototype.yo=function(b){if(b=H(b)){var c=new Wt;this.J(c);c.Pa("locationSource");c.n(b)}};a.xC=function(){};xC.prototype.w=function(){var b=H("zh-invited-member-list");b&&(new Ny(b,"/invitation/more","people",["zg-btn-follow","zg-btn-unfollow"],j)).w();(b=H("zh-invited-sina-member-list"))&&(new Ny(b,k,"people",["zg-btn-follow","zg-btn-unfollow"],j)).w();H("zh-sina-invite")&&(new nz).w();new El(H("invite_friend"))};a.yC=function(b,c){var d=this.D={};E.extend(d,this.R,c||{});this.input=b;this.Kb=d.Kb;this.zh=this.oT();this.Av=[];this.Av.push({action:"remove",method:this.XT,LM:d.UT,T:"删除"});setTimeout(v(this.Kg,this))};y(yC,Hd);
ya(yC.prototype,{R:{source:"/topic/autocomplete",Kb:k,ZM:"",Zq:n,pJ:"/topic/%s",Ah:'<li data-id="<%=id%>"><a class="tag-link" href="<%=url%>"><%=name%></a></li>',parse:function(b){var c=$(b);return{Dt:j,id:c.data("id"),url:b.href,name:c.text()}},RU:nf,oN:"canedit",sw:"empty",En:"button",UT:"remove-button"},xV:function(b){return St(this.D.pJ,b.url_token)},has:function(b){return!!z.find(this.zh,function(c){return c.name===b.name||c.id===b.id})},jE:function(b){return z.find(this.zh,function(c){return c.name===
b})},MZ:function(b){return z.find(this.zh,function(c){return c.id===b})},Ve:function(){var b=!!qc(this.Kb).length;D.enable(this.Kb,this.D.sw,!b);this.dispatchEvent("change")},add:function(b,c){if(b&&(this.has(b)||this.zh.push(b),b.Dt=n,c||this.D.RU.call(this,b)))this.bU(b),b.Dt=j,this.dispatchEvent("add"),this.Ve()},remove:function(b){this.zh=z.filter(this.zh,function(c){return b!==c.id},this);this.dispatchEvent("remove");this.Ve()},ZN:function(){return z.filter(this.zh,function(b){return b.Dt!==
n})},lx:function(){return z.map(this.ZN(),function(b){return b.id})},bU:function(b){b=hc(this.YH(b));this.Kb.appendChild(b);this.ie(b)},YH:function(b){return Pk(this.D.Ah,b)},Z:function(){this.Kb.innerHTML=z.map(this.zh,this.YH,this).join("")},oT:function(){return z.map(this.DE(),this.D.parse)},DE:function(){return qc(this.Kb)},Kg:function(){var b=this,c=b.D,d=this.input,e={source:c.source,qk:Jc(b.input,function(b){return"static"!==$.css(b,"position")}),placeholder:this.input.getAttribute("placeholder"),
select:function(d){b.add({id:d.id,name:d.id?d.label:b.input.value,url:b.xV(d),avatar:d.avatar,url_token:d.url_token});return c.ZM},filter:function(d){return z.filter(d,function(d){return c.Zq&&!d.id?n:!z.find(b.zh,function(b){return b.Dt&&b.id===d.id})})}},g={dd:function(b,c,d){d.innerHTML=l(b.data)}};E.extend(g,e||{});var h=new Xo(d,g);N(h,"show",function(){1<h.cb.length&&!h.cb[0].id&&bm(h)});var l=Pk('<% if (data.avatar) { %><img class="zm-item-img-avatar zg-left" src="<%=avatar%>"><% } %><% if(data.type === "search_link" || !data.id){ %><span class="zu-autocomplete-row-name zu-autocomplete-row-name-info"><%=data.type === "search_link"?("添加 "+label+" 话题"):label%></span><% } else { %><span class="zu-autocomplete-row-name"><%=label%></span><% } %><span class="zg-gray-normal zu-autocomplete-row-description"><% if (data.alias && data.followers) { %><% if ( data.alias ) { %>又称 <%=alias%><% } %><% if ( data.alias && data.followers ){ %>，<% } %><% if ( data.followers ){ %><%=followers%> 人关注<% } %><% }else{ %>&nbsp;<% } %></span>');
this.ca=h;z.forEach(this.DE(),this.ie,this);N(this.input,"keypress",function(d){var e;if(13===d.keyCode&&!c.Zq&&(e=La(this.value))&&!b.ca.ub())b.add(b.jE(e)||{id:k,name:e,url:"/topic/"+e})});this.Ve()},XT:function(b){this.remove($(b).remove().data("id"))},rT:function(b,c){var d=z.find(this.Av,function(c){return c.action===b});d&&d.method&&d.method.call(this,c);this.input.focus()},ie:function(b){var c=this.D;D.add(b,c.oN);z.forEach(this.Av,function(d){var e=new yo(" ",Ho.F());e.Lh([c.En,d.LM].join(" "));
e.Z(b);e.eb(j);e.Uc(d.T);e.addEventListener("action",function(){this.rT(d.action,b)},n,this)},this)}});a.zC=function(){this.IB=this.JB=k};
zC.prototype.w=function(){function b(b,c){var g=K("li"),h=K("span","item-label",b);g.appendChild(h);var l=new yo("",Ho.F());l.Lh("zm-profile-tag-btn zm-profile-tag-btn-del");l.eb(j);l.Uc("移除动作");l.ua(c);l.addEventListener("action",function(){var b=l.X();e(b,n);L(g);X.At(j);d()});l.Z(g);Na.appendChild(g)}function c(){ka.z(X.Pl()!==z.filter(X.Fb(),function(b){return!!(b.da&8)}).length)}function d(){z.forEach(Q,function(b){b.selected||(b=new Qz(b.text,b.value),X.Fa(b))});c()}function e(b,c){var d=z.find(Q,
function(c){return c.value===b});d&&(d.selected=c)}function g(){var b=$.grep(m.get(0).options,function(b){return b.selected});$.map(b,function(b){return b.value})}function h(){p=I.lx();G.val(p.join(","))}var l=$("#rq-settings-ui"),m=$("select.select",l);$(".topics-num",l);$(".actions-num",l);var p=[];this.IB=$("#rq-info-block");l.on("click",".beginedit-button",function(b){b.preventDefault();l.addClass("expanded-view")}).on("click",".exitedit-button",function(b){b.preventDefault();l.removeClass("expanded-view")}).on("click",
".endedit-button",function(b){b.preventDefault();l.get(0).submit()});var r=$(".topic-editor",l),x=$("input.topic-input",r).get(0),F=$("ul.tag-list",r).get(0),I=new yC(x,{Zq:j,Kb:F}),G=$('input[name="topics"]',r);I.on("change",h);m.on("change",g);h();g();r=m.get(0);R(r,n);var Q=r.options,X=new ou;X.on("action",function(d){d=d.target;b(d.Yg(),d.X());e(d.X(),j);X.removeItem(d);c()});var ka=new Ou("添加动作",X);ka.Lh("menu-button");ka.Z(r.parentNode);ka.tp=j;Qu(ka);var Na=K("ul","display-list");d();z.forEach(Q,
function(c){c.selected&&b(c.text,c.value)});r.parentNode.insertBefore(Na,ka.h());var Ea=this,r=$("#rq3-item-list"),Va={CV:function(b){return $.post("/watch/thank",{id:b,rq_type:"thank"})},KT:function(b){return $.post("/watch/seen",{id:b,rq_type:"seen"})}};r.on("click",".read-button",function(){var b=$(this).closest(".rq-item"),c=b.data("id");Va.KT(c);c=ne.text()||0;0<c&&ne.text(c-1);var d=Ea.IB,e=Number(Ea.JB.text());setTimeout(function(){d.toggleClass("hidden",!!e)},210);b.slideUp(function(){b.remove()})}).on("click",
".thank-button",function(b){b.preventDefault();var b=$(this),c=b.closest(".rq-item").data("id");b.hasClass("thanked")||(Va.CV(c),b.addClass("thanked").text("已感谢"))});Iy(r);r=new pu(r.get(0),location.href,j);r.xH=function(b){return b.getAttribute("data-id")};r.If("rq-item");r.w();var r=$("#rq3-sidenav-link"),ne=$(".zg-num",r);this.JB=ne};a.AC=function(){};AC.prototype.w=function(){$("a.js-obfuscate-email").each(function(){var b=$(this),c=b.data("email").split("").reverse().join("");b.attr("href","mailto:"+c).text(c)})};a.BC=function(){};y(BC,T);BC.prototype.w=function(){yl.J(this);this.n(document.body)};BC.prototype.B=function(){BC.m.B.call(this);var b=$("#zh-following-question-item-list").children(".zh-general-list");if(b.length){var c=new Wt;this.J(c);c.Pa("nodeSource");c.n(b.get(0))}};a.CC=function(){T.call(this)};y(CC,T);CC.prototype.B=function(){this.g().c(this.e,"click",this.dp)};CC.prototype.dp=function(b){var c=b.target;c&&"rmdraft"===c.name&&Ci("删除草稿","你确定要删除这个草稿吗？",function(b){b&&(Ei("/answer/draft/delete",k,"POST","qid="+c.id.split("-")[1]),L(this.e))},this)};a.DC=function(){};y(DC,T);DC.prototype.w=function(){var b=H("zh-draft-page-wrap");b&&this.n(b)};
DC.prototype.B=function(){N(H("zh-clear-all-draft"),"click",function(){Ci("删除所有草稿","你确定要删除所有草稿吗？删除后将无法恢复",function(b){b&&(window.location.href="/draft/clear")});return n});this.yo()};DC.prototype.yo=function(){var b=H("zh-draft-item-list");if(b){var c=new Wt;c.Pa("locationSource",{kt:j}).Pa("childConstructor",{Tg:CC});c.n(b)}};a.EC=function(b){return $.post("/node/ExploreAnswerListV2",{method:"get_feeds",params:{offset:b}})};a.FC=function(){this.oh="explore";this.AN="explore_feed"};y(FC,T);FC.prototype.w=function(){yl.J(this);this.n(document.body)};FC.prototype.B=function(){FC.m.B.call(this);var b=H("zh-explore-list"),c=new GC;this.J(c);c.n(b);this.g().c(this,"click!",function(b){"comment"===b.namespace&&b.Dc.fill("category",this.oh).fill("label",this.AN)})};a.GC=function(){Ot.call(this,{source:this.source});this.tT=3E5};y(GC,Wt);
GC.prototype.B=function(){GC.m.B.call(this);this.Pa("childConstructor",{Tg:zx}).Pa("activeSource",{RC:"%d 条新热门内容",source:v(this.NK,this)})};GC.prototype.NK=function(b,c){var d=this,e=setInterval(function(){var e;e=c()[0]||d.Fb()[0];e=$(e).data("offset");EC(-e).done(function(c){c.r||b(c.msg)})},this.tT);return{G:function(){clearInterval(e)}}};GC.prototype.source=function(){return EC($(this.Fb()).last().data("offset")).then(function(b){return!b.r&&{results:b.msg}})};a.HC=function(){T.call(this)};y(HC,T);HC.prototype.w=function(){yl.J(this);this.n(document.body)};HC.prototype.B=function(){HC.m.B.call(this);this.yo()};HC.prototype.yo=function(){var b=H("js-suggest-people");if(b){var c=0,d=new Wt({source:function(){return $.get("",{start:c+20,limit:20}).then(function(b){if(!b.r)return b=b.msg,b.hasmore&&(c+=20),{results:b.htmls,next:Boolean(b.hasmore)}})}});this.J(d);d.n(b)}};a.JC=function(b,c,d){T.call(this,d);this.Lf=c||rj;this.BJ=this.Lf.$B;this.aa=new uj(b);this.aa.Hl=this.Lf.Lu;this.aa.Wg=this.Lf.Ku;this.Fc=this.aa.clone();this.Fc.setDate(1);this.uu="      ".split(" ");this.uu[this.Lf.Qu[0]]=IC()+"-wkend-start";this.uu[this.Lf.Qu[1]]=IC()+"-wkend-end";this.gm={}};y(JC,T);t=JC.prototype;t.AA=j;t.ZU=j;t.yN=j;t.GA=j;t.DI=j;t.Hq=j;t.EA=j;t.FI=n;t.GD=k;t.Er=k;t.mw=k;t.bM=hh.F();
a.IC=function(){return"goog-date-picker"},a.KC=function(b){R(b.pw,b.EA);R(b.ow,b.Hq);R(b.TI,b.EA||b.Hq)};t.EH=function(){this.Fc.add(new os("m",-1));LC(this)};t.LG=function(){this.Fc.add(new os("m",1));LC(this)};t.DT=function(){this.Fc.add(new os("y",-1));LC(this)};t.CR=function(){this.Fc.add(new os("y",1));LC(this)};t.mI=function(){this.setDate(new uj)};t.kI=function(){this.Hq&&this.setDate(k)};t.getDate=function(){return this.aa&&this.aa.clone()};
t.setDate=function(b){var c=b!=this.aa&&!(b&&this.aa&&b.getFullYear()==this.aa.getFullYear()&&b.getMonth()==this.aa.getMonth()&&b.getDate()==this.aa.getDate());this.aa=b&&new uj(b);b&&(this.Fc.set(this.aa),this.Fc.setDate(1));LC(this);this.dispatchEvent(new MC("select",this,this.aa));c&&this.dispatchEvent(new MC("change",this,this.aa))};
a.OC=function(b){if(b.Er){for(var c=b.Er;c.firstChild;)c.removeChild(c.firstChild);var d,e;if(b.FI)d=b.H.createElement("td"),d.colSpan=b.GA?1:2,NC(b,d,"«",b.EH),c.appendChild(d),d=b.H.createElement("td"),d.colSpan=b.GA?6:5,d.className=IC()+"-monthyear",c.appendChild(d),b.nw=d,d=b.H.createElement("td"),NC(b,d,"»",b.LG),c.appendChild(d);else{var g=b.Lf.QB[0].toLowerCase();d=b.H.createElement("td");d.colSpan=5;NC(b,d,"«",b.EH);b.pj=NC(b,d,"",b.XU,IC()+"-month");NC(b,d,"»",b.LG);e=b.H.createElement("td");
e.colSpan=3;NC(b,e,"«",b.DT);b.Xn=NC(b,e,"",b.aV,IC()+"-year");NC(b,e,"»",b.CR);g.indexOf("y")<g.indexOf("m")?(c.appendChild(e),c.appendChild(d)):(c.appendChild(d),c.appendChild(e))}}};
t.$=function(b){JC.m.$.call(this,b);b.className=IC();var c=this.H.createElement("table"),d=this.H.createElement("thead"),e=this.H.createElement("tbody"),g=this.H.createElement("tfoot");Oc(e,"grid");e.tabIndex="0";this.aB=e;this.TI=g;var h=this.H.createElement("tr");h.className=IC()+"-head";this.Er=h;OC(this);d.appendChild(h);var l;this.mf=[];for(var m=0;7>m;m++){h=this.H.createElement("tr");this.mf[m]=[];for(var p=0;8>p;p++){l=this.H.createElement(0==p||0==m?"th":"td");if((0==p||0==m)&&p!=m)l.className=
0==p?IC()+"-week":IC()+"-wday",Oc(l,0==p?"rowheader":"columnheader");h.appendChild(l);this.mf[m][p]=l}e.appendChild(h)}h=this.H.createElement("tr");h.className=IC()+"-foot";l=this.mw=h;kc(l);m=this.H.createElement("td");m.colSpan=2;m.className=IC()+"-today-cont";p=w("Today");this.pw=NC(this,m,p,this.mI);l.appendChild(m);m=this.H.createElement("td");m.colSpan=4;l.appendChild(m);m=this.H.createElement("td");m.colSpan=2;m.className=IC()+"-none-cont";p=w("None");this.ow=NC(this,m,p,this.kI);l.appendChild(m);
KC(this);g.appendChild(h);c.cellSpacing="0";c.cellPadding="0";c.appendChild(d);c.appendChild(e);c.appendChild(g);b.appendChild(c);PC(this);LC(this);b.tabIndex=0};t.o=function(){JC.m.o.call(this);this.$(this.h())};t.B=function(){JC.m.B.call(this);var b=this.g();b.c(this.aB,"click",this.GO);b.c(QC(this,this.h()),"key",this.HO)};t.$a=function(){JC.m.$a.call(this);this.vl();for(var b in this.gm)this.gm[b].G();this.gm={}};t.create=JC.prototype.n;
t.p=function(){JC.m.p.call(this);this.ow=this.pw=this.Xn=this.nw=this.pj=this.mw=this.Er=this.TI=this.aB=this.mf=k};t.GO=function(b){if("TD"==b.target.tagName){var c,d=-2,e=-2;for(c=b.target;c;c=c.previousSibling,d++);for(c=b.target.parentNode;c;c=c.previousSibling,e++);this.setDate(this.Vl[e][d].clone())}};
t.HO=function(b){var c,d;switch(b.keyCode){case 33:b.preventDefault();c=-1;break;case 34:b.preventDefault();c=1;break;case 37:b.preventDefault();d=-1;break;case 39:b.preventDefault();d=1;break;case 38:b.preventDefault();d=-7;break;case 40:b.preventDefault();d=7;break;case 36:b.preventDefault(),this.mI();case 46:b.preventDefault(),this.kI();default:return}this.aa?(b=this.aa.clone(),b.add(new os(0,c,d))):(b=this.Fc.clone(),b.setDate(1));this.setDate(b)};
t.XU=function(b){b.stopPropagation();for(var b=[],c=0;12>c;c++)b.push(this.Lf.kn[c]);RC(this,this.pj,b,this.TO,this.Lf.kn[this.Fc.getMonth()])};t.aV=function(b){b.stopPropagation();for(var b=[],c=this.Fc.getFullYear()-5,d=0;11>d;d++)b.push(String(c+d));RC(this,this.Xn,b,this.zP,String(this.Fc.getFullYear()))};t.TO=function(b){for(var c=-1;b;b=tc(b),c++);this.Fc.setMonth(c);LC(this);this.pj.focus&&this.pj.focus()};
t.zP=function(b){3==b.firstChild.nodeType&&(this.Fc.setFullYear(Number(b.firstChild.nodeValue)),LC(this));this.Xn.focus()};
a.RC=function(b,c,d,e,g){b.vl();var h=b.H.createElement("div");h.className=IC()+"-menu";b.mm=k;for(var l=b.H.createElement("ul"),m=0;m<d.length;m++){var p=b.H.o("li",k,d[m]);d[m]==g&&(b.mm=p);l.appendChild(p)}h.appendChild(l);h.style.left=c.offsetLeft+c.parentNode.offsetLeft+"px";h.style.top=c.offsetTop+"px";h.style.width=c.clientWidth+"px";b.pj.parentNode.appendChild(h);b.la=h;b.mm||(b.mm=l.firstChild);b.mm.className=IC()+"-menu-selected";b.Ty=e;c=b.g();c.c(b.la,"click",b.LE);c.c(QC(b,b.la),"key",
b.ME);c.c(b.H.xa(),"click",b.vl);h.tabIndex=0;h.focus()};t.LE=function(b){b.stopPropagation();this.vl();this.Ty&&this.Ty(b.target)};
t.ME=function(b){b.stopPropagation();var c,d=this.mm;switch(b.keyCode){case 35:b.preventDefault();c=d.parentNode.lastChild;break;case 36:b.preventDefault();c=d.parentNode.firstChild;break;case 38:b.preventDefault();c=d.previousSibling;break;case 40:b.preventDefault();c=d.nextSibling;break;case 13:case 9:case 0:b.preventDefault(),this.vl(),this.Ty(d)}c&&c!=d&&(d.className="",c.className=IC()+"-menu-selected",this.mm=c)};
t.vl=function(){if(this.la){var b=this.g();b.wa(this.la,"click",this.LE);b.wa(QC(this,this.la),"key",this.ME);b.wa(this.H.xa(),"click",this.vl);L(this.la);delete this.la}};
a.NC=function(b,c,d,e,g){var h=[IC()+"-btn"];g&&h.push(g);g=b.H.createElement("button");g.className=h.join(" ");g.appendChild(b.H.createTextNode(d));c.appendChild(g);b.g().c(g,"click",function(b){b.preventDefault();e.call(this,b)});return g},a.LC=function(b){if(b.h()){var c=b.Fc.clone();c.setDate(1);b.nw&&zc(b.nw,w("{$monthName} {$yearNum}",{monthName:b.Lf.kn[c.getMonth()],yearNum:c.getFullYear()}));b.pj&&zc(b.pj,b.Lf.kn[c.getMonth()]);b.Xn&&zc(b.Xn,String(c.getFullYear()));var d=((c.getDay()+6)%
7-c.Wg+7)%7,e=sj(c.getFullYear(),c.getMonth());c.add(new os("m",-1));c.setDate(sj(c.getFullYear(),c.getMonth())-(d-1));b.AA&&(!b.yN&&33>e+d)&&c.add(new os("d",-7));d=new os("d",1);b.Vl=[];for(e=0;6>e;e++){b.Vl[e]=[];for(var g=0;7>g;g++)b.Vl[e][g]=c.clone(),c.add(d)}if(b.h())for(var c=b.Fc.getMonth(),g=new uj,d=g.getFullYear(),e=g.getMonth(),g=g.getDate(),h=0;6>h;h++){if(b.GA){var l=b.mf[h+1][0],m;m=b.Vl[h][0];var p=m.getDate(),p=new Date(m.getFullYear(),m.getMonth(),p),r=m.Wg||0;m=p.valueOf()+864E5*
(((m.Hl||3)-r+7)%7-((p.getDay()+6)%7-r+7)%7);m=Math.floor(Math.round((m-(new Date((new Date(m)).getFullYear(),0,1)).valueOf())/864E5)/7)+1;zc(l,m);D.set(b.mf[h+1][0],IC()+"-week")}else zc(b.mf[h+1][0],""),D.set(b.mf[h+1][0],"");for(l=0;7>l;l++){m=b.Vl[h][l];p=b.mf[h+1][l+1];p.id||(p.id=ih(b.bM));Oc(p,"gridcell");r=[IC()+"-date"];if(b.ZU||m.getMonth()==c){m.getMonth()!=c&&r.push(IC()+"-other-month");var x=(l+b.Fc.Wg+7)%7;b.uu[x]&&r.push(b.uu[x]);m.getDate()==g&&(m.getMonth()==e&&m.getFullYear()==d)&&
r.push(IC()+"-today");b.aa&&(m.getDate()==b.aa.getDate()&&m.getMonth()==b.aa.getMonth()&&m.getFullYear()==b.aa.getFullYear())&&(r.push(IC()+"-selected"),Pc(b.aB,"activedescendant",p.id));b.GD&&(x=b.GD(m))&&r.push(x);zc(p,m.getDate())}else zc(p,"");D.set(p,r.join(" "))}4<=h&&R(b.mf[h+1][0].parentNode,b.Vl[h][0].getMonth()==c||b.AA)}}},a.PC=function(b){if(b.h()){if(b.DI)for(var c=0;7>c;c++)zc(b.mf[0][c+1],b.BJ[((c+b.Fc.Wg+7)%7+1)%7]);R(b.mf[0][0].parentNode,b.DI)}},a.QC=function(b,c){var d=ua(c);d in
b.gm||(b.gm[d]=new im(c));return b.gm[d]},a.MC=function(b,c,d){id.call(this,b,c);this.WM=d};y(MC,id);a.SC=function(b){T.call(this);E.extend(this.D={},this.R,b||{});this.$f=new Gs};y(SC,T);a.TC=void 0;a.UC=document.createElement("input");try{UC.type="datetime",TC="datetime"===UC.type}catch(VC){TC=n}t=SC.prototype;t.R={rR:5,kW:j,mW:n};t.Ve=function(){if(this.mt){var b;(b=wt(this.Sn.value))?(b.setHours(this.ks.value),b.setMinutes(this.Ys.value)):b=k;this.$f=b;WC(this)}this.dispatchEvent("change")};a.WC=function(b){b.e.value=b.$f?Hs(b.$f):"null"};t.rB='<div class="ui-datetime-picker"><input id="date" class="date text" type="text"><select class="hour"></select><span class="colon">:</span><select class="minute"></select></div>';
t.P=function(b,c,d){return O.toArray(O.Cm(b,c,d))};t.qv=function(){this.g().c(this.tl,"change",function(b){if(b=b.WM)this.Sn.value=b.Ik(j),this.Ve(),R(this.tl.h(),n)}).c(this.Sn,"focus",function(){R(this.tl.h(),j)}).c(this.Sn,"blur",function(){var b=this;setTimeout(function(){b.tl.h().contains(document.activeElement)||R(b.tl.h(),n)})}).c(this.ks,"change",function(){this.Ve()}).c(this.Ys,"change",function(){this.Ve()})};t.p=function(){L(this.mt);R(this.e);SC.m.p.call(this)};
t.$=function(b){SC.m.$.call(this,b);if(!this.D.kW||!TC){R(b,n);var c=this.mt=hc(this.rB),d=this.H.di;this.Sn=d("date",c);this.ks=d("hour",c);this.Ys=d("minute",c);c=this.mt;rj=xt;d=this.tl=new JC;d.setDate(this.$f);d.Hq=n;d.ow&&KC(d);d.EA=n;d.pw&&KC(d);d.AA=n;LC(d);d.BJ=d.Lf.TB;PC(d);d.FI=j;OC(d);LC(d);d.Z(c);R(this.tl.h(),n);var e=this.ks;z.forEach(this.P(0,24,i),function(b){b=this.H.o("option",{value:b},String(b));e.appendChild(b)},this);var g=this.Ys;z.forEach(this.P(0,60,this.D.rR),function(b){b=
this.H.o("option",{value:b},bb(b));g.appendChild(b)},this);this.qv();c=b.value;this.$f=oa(c)?wt(c):new Gs(c||za());this.D.mW||this.$f.setSeconds(0);this.$f&&(this.ks.value=this.$f.getHours(),this.Ys.value=this.$f.getMinutes(),c=Hs(this.$f),this.Sn.value=c.slice(0,10));WC(this);this.dispatchEvent("change");lc(this.mt,b)}};$.validator.addMethod("datetime",function(b,c){return this.optional(c)||moment(b,"YYYY-MM-DDTHH:mm:ss").isValid()},"时间格式不正确");$.validator.addMethod("dateGreaterThan",function(b,c,d){return new Date(b)>new Date($(d).val())},"时间范围不正确");a.XC=function(b,c){T.call(this);this.ne=b||{};this.Vy=c||{};this.$m=this.Vy.topics||[];this.ZL=this.Vy.canAdminister;this.JT=this.Vy.questions||[];this.oh="roundtable"};y(XC,T);t=XC.prototype;
t.w=function(){yl.J(this);this.n(document.body);this.Ao();var b=v(function(){var b=z.toArray(arguments),c=b.shift(),d=b.shift(),d=$(d);b.unshift(d);d.length&&c.apply(this,b)},this);b(this.cQ,"#js-rt-pending-questions");b(this.dQ,"#js-roundtable-search-box");b(this.xF,"#js-roundtable-followers > .zh-general-list");b(this.xF,"#js-rt-question-paged > .zh-general-list",this.yF);var c=this;$("#js-personal-answers .zm-item, #js-hot-answers .zm-item").each(function(){var b=new zx;c.J(b);b.n(this);c.vF(this)});
if(b=$("#js-hot-answers-paged > .zh-general-list")[0]){var d=new Wt;this.J(d);d.Pa("nodeSource");d.Pa("childConstructor",{Tg:zx});Pt(d,this.vF,this);d.n(b)}b=$("#js-rt-webshare-links");b.data();var e=this.ne;$("a",b).click(function(){var b=Cu.F();b.yk("分享活动","roundtable",e.url_token,{roundtable_id:e.id});b.show();Du(b,"tb-webshare-"+this.name);Y.V({type:"ga_click_share_roundtable_box",target:this,data:{type:this.name}})});b=$(".rt-comment-box");b.length&&(d=new Qw(this.ne.id,"roundtable"),this.J(d),
this.g().c(this,"click!",function(b){"comment"===b.namespace&&b.Dc.fill("label","roundtable")}),d.n(b[0]));b=$("#js-roundtable-menu-button");if(b.length){var g=this.ne.url_token,d=new ou;d.n(b.next(".goog-menu")[0]);this.g().c(d,"action",function(b){b=$(b.target.h());if("addHotAnswer"===b.data("action"))var b=b.text(),c=Ci(b,'<input class="text" name="url" placeholder="请输入回答地址" style="width:90%">',function(b){if(b){var b=$("input",c.h()).val(),d=b.match(we),e=d[1],h=d[2],l=d[3],d=d[4],G="";e&&(G+=
e+":");l&&(G+="//",h&&(G+=h+"@"),G+=l,d&&(G+=":"+d));if(!G)return n;$.post("/roundtable/"+g,{action:"add_hot_answer",answer_url:b}).done(function(){U("添加成功")})}})});d=new Ou("Settings",d);d.tp=j;Qu(d);d.n(b[0])}this.Mj();var h=this;$("#js-questions-home .roundtable-question-item").each(function(){h.yF(this)})};
t.vF=function(b){var c=this.ne.url_token,d=$(b);if(this.ZL){var e=$(".answer-actions",d),g=$('<span class="zg-bull zu-autohide">•</span><span>\n</span>'),h=$('<a href="javascript:;" class="zu-autohide meta-item">移除</a>');e.append(g).append(h);h.on("click",function(){Ci("移除回答","你确认要从活动中移除这个回答？",function(e){e&&(e=$(".zm-item-answer",b).data("atoken"),$.post("/roundtable/"+c,{action:"remove_hot_answer",url_token:e}),d.fadeOut(function(){d.remove()}))})})}};
t.yF=function(b){var c=this.ne.url_token;$(b).on("click",".remove-button",function(b){Ci("移除问题","你确认要从活动中移除这个问题？",function(e){if(e){var g=$(b.delegateTarget),e=g.data("token");$.post("/roundtable/"+c,{action:"remove_question",url_token:e});g.fadeOut(function(){g.remove()})}})})};
t.Ao=function(){this.g().c(this,"click!",function(b){"comment"===b.namespace&&b.Dc.fill("category",this.oh).fill("label","roundtable_answer")});var b=this.ne&&this.ne.url_token;location.pathname==="/roundtable/"+b&&W(/expand=1/.test(location.search)?"notification":"navigation","visit_roundtable","roundtable_home");$(".roundtable-header .follow-button").on("click",function(){W("roundtable","click_follow_roundtable","roundtable_home")});$(".roundtable-search-box .add-button").on("click",function(){W("roundtable",
"click_apply_question","roundtable_add_quesiton")});$('a[data-follow="m:link"]').on("click",function(){W("roundtable","click_follow_people","roundtable_sidebar_follow")});$('a[data-follow="t:link"]').on("click",function(){W("roundtable","click_follow_topic","roundtable_sidebar_follow")});b&&Fu("roundtable",b,"read")};
t.dQ=function(b){function c(b){return{none:'<i class="plus">+</i>',pending:"已申请",approved:"已添加"}[d(b)]}function d(b){var c=z.find(m,function(c){return c[0]===b});return c?c[1]?"approved":"pending":"none"}var e=this,g=$(".search-input",b).placeholder(),h=g[0],l=this.ne.url_token,m=this.JT,p=this.$m,r=Pk('<span class="title"><%=question.title%></span><span class="count"><%=question.answer_count%> 个回答</span><span class="status"><%= statusLabel(question.url_token) %></span>');(new Xo(h,{source:"/question/autocomplete",
qk:h.offsetParent,dd:function(b,d,e){e.innerHTML=r({question:b.data,statusLabel:c})}})).Ai=function(){var b=this.cb[dm(this,this.Nc)].url_token;"none"===d(b)&&(mt(l,b),m.push([b,n]),$(this.N.Bg[this.N.Gj]).find(".status").text("已申请"),W("roundtable","click_apply_question","roundtable_searchbox"))};g.on("keydown",function(){return e.dispatchEvent("requestLogin")});$(".add-button",b).click(function(){var b=g.val();if(e.dispatchEvent("requestLogin")){var c=qr.F(),d={$m:z.map(p,function(b){return[b.name,
b.url_token,"",b.id]}),ep:function(b){mt(l,b.Xb).always(function(){location.href=b.url})}};c.show(d);tr(c,b)}})};
t.Mj=function(){var b=$("#js-roundtable-form");if(b.length){var c=this,d=this.g();$("input[placeholder]").placeholder();$('input[type="datetime"]',b).each(function(){var b=$(this),c=new SC;c.n(this);d.c(c,"change",function(){b.valid()})});$("input[data-suggest]",b).each(function(){var b=$(this),c=b.data("suggest"),e=b.closest(".controls"),g=e.find('input[type="hidden"]'),e=e.find("ul").get(0),h=b.data("maxTags"),l=new yC(this,{pJ:{topic:"/topic/%s",user:"/people/%s"}[c],source:{topic:"/topic/autocomplete",
user:"/people/autocomplete"}[c],Zq:j,Kb:e});d.c(l,"change",function(){var c=l.lx();h&&b.prop("disabled",c.length>=h);g.val(c.join(","))});c=l.lx();g.val(c.join(","))});var e=$('input[name="logo"]',b),g=$("#js-avatar-container"),h=$("img.avatar",g),g=$(".upload-button",g),l=new ly(4,this.ne&&this.ne.id,"xl");l.n(g[0]);d.c(l,"success",function(b){h.attr("src",b.src);e.val(l.getData())});b.validate({ignore:[],submitHandler:function(){var d=$("#url_token").val(),e=c.ne&&c.ne.url_token;$.post(b.attr("action"),
b.serialize(),function(b){b.success?(U(e?"活动修改成功":"活动创建成功"),setTimeout(function(){location.href="/roundtable/"+d},3E3)):U(b.message)})},rules:{url_token:{pattern:/^[-A-Za-z0-9]+$/},beginTime:"datetime",endTime:{datetime:j,dateGreaterThan:"#beginTime"}},messages:{url_token:{pattern:"仅限数字、字母和短横线"},name:{maxlength:"活动名称不能超过 30 个字"},endTime:{dateGreaterThan:"结束时间必须大于开始时间"}}})}};
t.cQ=function(b){function c(){d().length||($(".ignore-button").remove(),location.reload())}function d(){return $(".roundtable-question-item",b)}var e=d(),g=this.ne.url_token;e.on("click",".approve-button",function(b){var d=$(b.delegateTarget),b=$(b.target),e=d.data("token");$.post("/roundtable/"+g,{action:"approve_question",url_token:e});b.text("添加成功");d.fadeOut(400,function(){d.remove();c()})});b.on("click",".ignore-button",function(){var b=d().map(function(){return $(this).data("token")}).get();
$.post("/roundtable/"+g,{action:"ignore_questions",url_tokens:b.join(",")});e.fadeOut(400,function(){$(this).remove();c()})})};t.xF=function(b,c){var d=new Wt;this.J(d);d.Pa("nodeSource");d.n(b[0]);c&&Pt(d,c,this)};Ca("ZH.entryQuestionLog",function(){(new uC).w()});Ca("ZH.entryQuestionFollowersPage",function(){(new wC).w()});Ca("ZH.entrySQ",function(){(new cC).w()});Ca("ZH.entrySA",function(){(new mC).w()});Ca("ZH.entryL",function(){(new xz).w()});Ca("ZH.entryT",function(){(new tz).w()});Ca("ZH.entryTS",function(){(new tC).w()});Ca("ZH.entryP",function(){(new Jy).w()});Ca("ZH.entryM",function(){(new fz).w()});Ca("ZH.entryPM",function(){(new cu).w()});Ca("ZH.entryPMDetail",function(){(new du).w()});
Ca("ZH.entryHelp",function(){(new Ft).w()});Ca("ZH.entryInvite",function(){(new xC).w()});Ca("ZH.entryQueue",function(){(new cz).w()});Ca("ZH.entryTest",ba());Ca("ZH.entrySettings",function(){(new iz).w()});Ca("ZH.entryTopicFeed",function(){(new oC).w()});Ca("ZH.entryTest",function(){(new et.SY).w()});Ca("ZH.entryRQ3",function(){(new zC).w()});Ca("ZH.entryTerms",function(){(new AC).w()});Ca("ZH.entryHome",function(){(new Oz).w()});Ca("ZH.entryQuestionFollowing",function(){(new BC).w()});
Ca("ZH.entryDraft",function(){(new DC).w()});Ca("ZH.entryExplore",function(){(new FC).w()});Ca("ZH.entryLookup",function(){(new HC).w()});Ca("ZH.entryCC",function(){$(function(){$("#js-apply-button").click(function(){if(S.Ia()){$.post("/classical-chinese");var b=$(this),c=b.data("num");b.text("您已申請使用").addClass("disabled");$(".apply-num").text("已有 "+(c+1)+" 人申請")}else Jk.F().z(j)})})});Ca("ZH.entryRT",function(b,c){(new XC(b,c)).w()});If("app");}})(zhihu);
//@ sourceURL=http://static.zhihu.com/static/compiled/app.js